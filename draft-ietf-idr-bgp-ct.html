<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BGP Classful Transport Planes</title>
<meta content="Kaliraj Vairavakkalai" name="author">
<meta content="Natrajan Venkataraman" name="author">
<meta content='
       This document specifies a mechanism referred to as "Intent Driven
      Service Mapping". The mechanism uses BGP to express intent based
      association of overlay routes with underlay routes having specific
      Traffic Engineering (TE) characteristics satisfying a certain Service
      Level Agreement (SLA). This is achieved by defining new constructs to
      group underlay routes with sufficiently similar TE characteristics into
      identifiable classes (called "Transport Classes"), that overlay routes
      use as an ordered set to resolve reachability (Resolution Schemes)
      towards service endpoints. These constructs can be used, for example, to
      realize the "IETF Network Slice" defined in TEAS Network Slices
      framework. 
       Additionally, this document specifies protocol procedures for BGP
      that enable dissemination of service mapping information in a network
      that may span multiple cooperating administrative domains. These domains
      may be administered either by the same provider or by closely
      coordinating providers. A new BGP address family that leverages RFC 4364
      ("BGP/MPLS IP Virtual Private Networks (VPNs)" procedures and follows
      RFC 8277 ("Using BGP to Bind MPLS Labels to Address Prefixes") NLRI
      encoding is defined to enable each advertised underlay route to be
      identified by its class. This new address family is called "BGP Classful
      Transport", a.k.a., BGP CT. 
    ' name="description">
<meta content="xml2rfc 3.18.2" name="generator">
<meta content="draft-ietf-idr-bgp-ct-34" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.2
    Python 3.9.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.11.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 58.0.4
    six 1.15.0
    wcwidth 0.2.9
-->
<link href="draft-ietf-idr-bgp-ct.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necessary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

:root {
  --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
  --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
  --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
}

@viewport {
  zoom: 1.0;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: var(--font-sans);
  line-height: 1.6;
  scroll-behavior: smooth;
  overflow-wrap: break-word;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
svg[font-family~="serif" i], svg [font-family~="serif" i] {
  font-family: var(--font-serif);
}
svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
  font-family: var(--font-sans);
}
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  display: table;
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef,
.iref + a[href].internal {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre {
  background-color: #f9f9f9;
  font-family: var(--font-mono);
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
blockquote > *:last-child {
  margin-bottom: 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: var(--font-sans);
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  .breakable pre {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The following is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
.sourcecode pre,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .artwork > pre,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background slightly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr {
  break-inside: avoid;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottom margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the compact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div.sourcecode:first-child,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type:only-child {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body class="xml2rfc">
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BGP Classful Transport Planes</td>
<td class="right">January 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Vairavakkalai &amp; Venkataraman</td>
<td class="center">Expires 27 July 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-idr-bgp-ct-34</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-01-23" class="published">23 January 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-07-27">27 July 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Vairavakkalai, <span class="editor">Ed.</span>
</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">N. Venkataraman, <span class="editor">Ed.</span>
</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BGP Classful Transport Planes</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a mechanism referred to as "Intent Driven
      Service Mapping". The mechanism uses BGP to express intent based
      association of overlay routes with underlay routes having specific
      Traffic Engineering (TE) characteristics satisfying a certain Service
      Level Agreement (SLA). This is achieved by defining new constructs to
      group underlay routes with sufficiently similar TE characteristics into
      identifiable classes (called "Transport Classes"), that overlay routes
      use as an ordered set to resolve reachability (Resolution Schemes)
      towards service endpoints. These constructs can be used, for example, to
      realize the "IETF Network Slice" defined in TEAS Network Slices
      framework.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">Additionally, this document specifies protocol procedures for BGP
      that enable dissemination of service mapping information in a network
      that may span multiple cooperating administrative domains. These domains
      may be administered either by the same provider or by closely
      coordinating providers. A new BGP address family that leverages RFC 4364
      ("BGP/MPLS IP Virtual Private Networks (VPNs)" procedures and follows
      RFC 8277 ("Using BGP to Bind MPLS Labels to Address Prefixes") NLRI
      encoding is defined to enable each advertised underlay route to be
      identified by its class. This new address family is called "BGP Classful
      Transport", a.k.a., BGP CT.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-requirements-language">
<a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-note.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <span><a href="#RFC2119" class="internal xref">RFC 2119</a> [<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span><a href="#RFC8174" class="internal xref">RFC
      8174</a> [<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown
      here.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 27 July 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-definitions-and-notations" class="internal xref">Definitions and Notations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-architecture-overview" class="internal xref">Architecture Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-transport-class" class="internal xref">Transport Class</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-classifying-te-tunnels" class="internal xref">Classifying TE tunnels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-transport-route-database" class="internal xref">Transport Route Database</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-transport-class-route-targe" class="internal xref">"Transport Class" Route Target Extended Community</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-resolution-scheme" class="internal xref">Resolution Scheme</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-mapping-community" class="internal xref">Mapping Community</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-bgp-classful-transport-fami" class="internal xref">BGP Classful Transport Family</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-nlri-encoding" class="internal xref">NLRI Encoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-next-hop-encoding" class="internal xref">Next Hop Encoding</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-carrying-multiple-encapsula" class="internal xref">Carrying multiple Encapsulation Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-comparison-with-other-famil" class="internal xref">Comparison with Other Families using RFC-8277 Encoding</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-protocol-procedures" class="internal xref">Protocol Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-preparing-the-network-to-de" class="internal xref">Preparing the network to deploy Classful Transport planes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-originating-classful-transp" class="internal xref">Originating Classful Transport Routes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-processing-classful-transpo" class="internal xref">Processing Classful Transport Routes by Ingress Nodes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-readvertising-classful-tran" class="internal xref">Readvertising Classful Transport Route by Border Nodes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-border-nodes-receiving-clas" class="internal xref">Border Nodes Receiving Classful Transport Routes on EBGP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-avoiding-path-hiding-throug" class="internal xref">Avoiding Path Hiding Through Route Reflectors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-avoiding-loops-between-rout" class="internal xref">Avoiding Loops Between Route Reflectors in Forwarding Path</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-ingress-nodes-receiving-ser" class="internal xref">Ingress Nodes Receiving Service Routes with a Mapping Community</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-best-effort-transport-class" class="internal xref">Best Effort Transport Class</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-interaction-with-bgp-attrib" class="internal xref">Interaction with BGP Attributes Specifying Next Hop Address and Color</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.11">
                <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="auto internal xref">7.11</a>. <a href="#name-applicability-to-flowspec-r" class="internal xref">Applicability to Flowspec Redirect to IP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.12">
                <p id="section-toc.1-1.7.2.12.1"><a href="#section-7.12" class="auto internal xref">7.12</a>. <a href="#name-applicability-to-ipv6" class="internal xref">Applicability to IPv6</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.13">
                <p id="section-toc.1-1.7.2.13.1"><a href="#section-7.13" class="auto internal xref">7.13</a>. <a href="#name-srv6-support" class="internal xref">SRv6 Support</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.14">
                <p id="section-toc.1-1.7.2.14.1"><a href="#section-7.14" class="auto internal xref">7.14</a>. <a href="#name-error-handling-consideratio" class="internal xref">Error Handling Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-illustration-of-bgp-ct-proc" class="internal xref">Illustration of BGP CT Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-reference-topology" class="internal xref">Reference Topology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-service-layer-route-exchang" class="internal xref">Service Layer Route Exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-transport-layer-route-propa" class="internal xref">Transport Layer Route Propagation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-data-plane-view" class="internal xref">Data Plane View</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-steady-state" class="internal xref">Steady State</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-local-repair-of-primary-pat" class="internal xref">Local Repair of Primary Path</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-absorbing-failure-of-primar" class="internal xref">Absorbing Failure of Primary Path: Fallback to Best Effort Tunnels</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-scaling-considerations" class="internal xref">Scaling Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-avoiding-unintended-spread-" class="internal xref">Avoiding Unintended Spread of BGP CT Routes Across Domains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-constrained-distribution-of" class="internal xref">Constrained Distribution of PNHs to SNs (On-Demand Next Hop)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="auto internal xref">9.3</a>.  <a href="#name-limiting-the-visibility-sco" class="internal xref">Limiting The Visibility Scope of PE Loopback as PNHs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-operations-and-manageabilit" class="internal xref">Operations and Manageability Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-mpls-oam" class="internal xref">MPLS OAM</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-usage-of-route-distinguishe" class="internal xref">Usage of Route Distinguisher and Label Allocation Modes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-managing-transport-route-vi" class="internal xref">Managing Transport Route Visibility</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-deployment-considerations" class="internal xref">Deployment Considerations.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-coordination-between-domain" class="internal xref">Coordination Between Domains Using Different Community Namespaces</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-managing-intent-at-service-" class="internal xref">Managing Intent at Service and Transport layers.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
                    <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-11.2.1" class="auto internal xref">11.2.1</a>.  <a href="#name-service-layer-color-managem" class="internal xref">Service Layer Color Management</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
                    <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#section-11.2.2" class="auto internal xref">11.2.2</a>.  <a href="#name-non-agreeing-color-transpor" class="internal xref">Non-Agreeing Color Transport Domains</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.3">
                    <p id="section-toc.1-1.11.2.2.2.3.1"><a href="#section-11.2.3" class="auto internal xref">11.2.3</a>.  <a href="#name-heterogeneous-agreeing-colo" class="internal xref">Heterogeneous Agreeing Color Transport Domains</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-migration-scenarios" class="internal xref">Migration Scenarios.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="auto internal xref">11.3.1</a>.  <a href="#name-bgp-ct-islands-connected-vi" class="internal xref">BGP CT Islands Connected via BGP LU Domain</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.2">
                    <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#section-11.3.2" class="auto internal xref">11.3.2</a>.  <a href="#name-bgp-ct-interoperability-bet" class="internal xref">BGP CT - Interoperability between MPLS and Other Forwarding Technologies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-mtu-considerations" class="internal xref">MTU Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
                <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-use-of-dscp" class="internal xref">Use of DSCP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-applicability-to-network-sl" class="internal xref">Applicability to Network Slicing</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-new-bgp-safi" class="internal xref">New BGP SAFI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-new-format-for-bgp-extended" class="internal xref">New Format for BGP Extended Community</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-13.2.1" class="auto internal xref">13.2.1</a>.  <a href="#name-existing-registries" class="internal xref">Existing Registries</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.2">
                    <p id="section-toc.1-1.13.2.2.2.2.1"><a href="#section-13.2.2" class="auto internal xref">13.2.2</a>.  <a href="#name-new-registries" class="internal xref">New Registries</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="auto internal xref">13.3</a>.  <a href="#name-mpls-oam-code-points" class="internal xref">MPLS OAM Code Points</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="auto internal xref">13.4</a>.  <a href="#name-transport-class-id" class="internal xref">Transport Class ID</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="auto internal xref">14</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="auto internal xref">15</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="auto internal xref">15.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="auto internal xref">15.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-extensibility-consideration" class="internal xref">Extensibility considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-signaling-intent-over-pe-ce" class="internal xref">Signaling Intent over PE-CE Attachment Circuit</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-bgp-ct-egress-te" class="internal xref">BGP CT Egress TE</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-applicability-to-intra-as-a" class="internal xref">Applicability to Intra-AS and different Inter-AS deployments.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-intra-as-usecase" class="internal xref">Intra-AS usecase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.1">
                    <p id="section-toc.1-1.17.2.1.2.1.1"><a href="#appendix-B.1.1" class="auto internal xref">B.1.1</a>.  <a href="#name-topology" class="internal xref">Topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.2">
                    <p id="section-toc.1-1.17.2.1.2.2.1"><a href="#appendix-B.1.2" class="auto internal xref">B.1.2</a>.  <a href="#name-transport-layer" class="internal xref">Transport Layer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1.2.3">
                    <p id="section-toc.1-1.17.2.1.2.3.1"><a href="#appendix-B.1.3" class="auto internal xref">B.1.3</a>.  <a href="#name-service-layer-route-exchange" class="internal xref">Service Layer route exchange</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-inter-as-option-a-usecase" class="internal xref">Inter-AS option A usecase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.1">
                    <p id="section-toc.1-1.17.2.2.2.1.1"><a href="#appendix-B.2.1" class="auto internal xref">B.2.1</a>.  <a href="#name-topology-2" class="internal xref">Topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.2">
                    <p id="section-toc.1-1.17.2.2.2.2.1"><a href="#appendix-B.2.2" class="auto internal xref">B.2.2</a>.  <a href="#name-transport-layer-2" class="internal xref">Transport Layer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2.2.3">
                    <p id="section-toc.1-1.17.2.2.2.3.1"><a href="#appendix-B.2.3" class="auto internal xref">B.2.3</a>.  <a href="#name-service-layer-route-exchange-2" class="internal xref">Service Layer route exchange</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-inter-as-option-b-usecase" class="internal xref">Inter-AS option B usecase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.1">
                    <p id="section-toc.1-1.17.2.3.2.1.1"><a href="#appendix-B.3.1" class="auto internal xref">B.3.1</a>.  <a href="#name-topology-3" class="internal xref">Topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.2">
                    <p id="section-toc.1-1.17.2.3.2.2.1"><a href="#appendix-B.3.2" class="auto internal xref">B.3.2</a>.  <a href="#name-transport-layer-3" class="internal xref">Transport Layer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.3.2.3">
                    <p id="section-toc.1-1.17.2.3.2.3.1"><a href="#appendix-B.3.3" class="auto internal xref">B.3.3</a>.  <a href="#name-service-layer-route-exchange-3" class="internal xref">Service Layer route exchange</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-why-reuse-rfc-8277-and-rfc-" class="internal xref">Why reuse RFC 8277 and RFC 4364?</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-update-packing-consideratio" class="internal xref">Update packing considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-scaling-using-bgp-mpls-name" class="internal xref">Scaling using BGP MPLS Namespaces</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#appendix-E.1" class="auto internal xref"></a><a href="#name-co-authors" class="internal xref">Co-Authors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#appendix-E.2" class="auto internal xref"></a><a href="#name-other-contributors" class="internal xref">Other Contributors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Provider networks typically span across multiple domains where each
      domain can either represent an Autonomous System (AS) or an Interior
      Gateway Protocol (IGP) region within an AS. In these networks, several
      services are provisioned between different pairs of service endpoints
      (e.g., Provider Edge (PE) nodes), that can either be in the same domain
      or across different domains.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document realizes "Intent" as defined in <span>[<a href="#RFC9315" class="cite xref">RFC9315</a>]</span> and prescribes constructs and procedures that enable provider
      networks to be able to forward service traffic based on service specific
      intent, end-to-end across service endpoints.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The mechanisms described in this document achieve "Intent Driven
      Service Mapping" between any pair of service endpoints by:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1-4.1">
          <p id="section-1-4.1.1">Provisioning end-to-end "intent-aware" paths using BGP. For
          example, low latency path, best effort path.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="section-1-4.2">
          <p id="section-1-4.2.1">Expressing a desired intent. For example, use low latency path
          with fallback to the best effort path.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="section-1-4.3">
          <p id="section-1-4.3.1">Forwarding service traffic "only" using end-to-end "intent-aware"
          paths honoring that desired intent.<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-5">The constructs and procedures defined in this document apply equally
      to intra-AS as well as inter-AS (a.k.a. multi-AS) Option A, Option B and
      Option C (Section 10, <span>[<a href="#RFC4364" class="cite xref">RFC4364</a>]</span>) style deployments in
      provider networks.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Provider networks that are deployed using such styles provision
      intra-domain transport tunnels between a pair of endpoints, typically a
      service node or a border node, that service traffic use to traverse that
      domain. These tunnels are signaled using various tunneling protocols
      depending on the forwarding architecture used in the domain, which can
      be Multiprotocol Label Switching (MPLS), Internet Protocol version 4
      (IPv4), or Internet Protocol version 6 (IPv6).<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">The mechanisms defined in this document allow different tunneling
      technologies to become Transport Class aware. These can be applied
      homogeneously to intra-domain tunneling technologies used in existing
      brownfield networks as well as new greenfield networks. For clarity,
      only some tunneling technologies are detailed in this document. In some
      examples only MPLS Traffic Engineering (TE) examples are described.
      Other tunneling technologies have been described in detail in other
      documents and only an overview has been included in this document. For
      example, the details for Segment Routing (SRv6) are provided in <span>[<a href="#BGP-CT-SRv6" class="cite xref">BGP-CT-SRv6</a>]</span>, and an overview is provided in <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Customers need to be able to signal desired Intent to the network,
      and the network needs to have constructs able to enact the customer's
      intent. The network constructs defined in this document are used to
      classify and group these intra-domain tunnels based on various
      characteristics, like TE characteristics (e.g., low latency), into
      identifiable classes that can pass "intent-aware" traffic. These
      constructs enable services to express their intent to use one or more
      identifiable classes, and mechanisms to selectively map traffic onto
      "intent-aware" tunnels for these classes.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">This document introduces a new BGP address family called "BGP
      Classful Transport", that extends/stitches intent-aware intra-domain
      tunnels belonging to the same class across domain boundaries, to
      establish end-to-end intent-aware paths between service endpoints.<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10"><span>[<a href="#Intent-Routing-Color" class="cite xref">Intent-Routing-Color</a>]</span> describes various use cases and
      applications of the procedures described in this document.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11"><a href="#Appendix_C" class="auto internal xref">Appendix C</a> provides an outline of the design
      philosophy behind this specification. In particular, readers who are
      already familiar with one or more BGP VPN technologies may want to
      review this appendix before reading the main body of the
      specification.<a href="#section-1-11" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">ABR: Area Border Router (Readvertises BGP CT or BGP LU routes with
      next hop self)<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">AFI: Address Family Identifier<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">AS: Autonomous System<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">ASBR: Autonomous System Border Router<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">ASN: Autonomous System Number<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">BGP VPN: VPNs built using RD, RT; architecture described in
      RFC4364<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">BGP LU: BGP Labeled Unicast family (AFI/SAFIs 1/4, 2/4)<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">BGP CT: BGP Classful Transport family (AFI/SAFIs 1/76, 2/76)<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">BN: Border Node<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">CBF: Class Based Forwarding<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">CsC: Carrier serving Carrier VPN<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">DSCP: Differentiated Services Code Point<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">EP: Endpoint of a tunnel, e.g. a loopback address in the network<a href="#section-2-13" class="pilcrow">¶</a></p>
<p id="section-2-14">EPE: Egress Peer Engineering<a href="#section-2-14" class="pilcrow">¶</a></p>
<p id="section-2-15">eSN: Egress Service Node<a href="#section-2-15" class="pilcrow">¶</a></p>
<p id="section-2-16">FEC: Forwarding Equivalence Class<a href="#section-2-16" class="pilcrow">¶</a></p>
<p id="section-2-17">FRR: Fast ReRoute (Pre-programmed next hop leg in forwarding)<a href="#section-2-17" class="pilcrow">¶</a></p>
<p id="section-2-18">iSN: Ingress Service Node<a href="#section-2-18" class="pilcrow">¶</a></p>
<p id="section-2-19">LPM: Longest Prefix Match<a href="#section-2-19" class="pilcrow">¶</a></p>
<p id="section-2-20">L-ISIS: Labeled ISIS (RFC 8667)<a href="#section-2-20" class="pilcrow">¶</a></p>
<p id="section-2-21">LSP: Label Switched Path<a href="#section-2-21" class="pilcrow">¶</a></p>
<p id="section-2-22">MNH: BGP MultiNexthop attribute<a href="#section-2-22" class="pilcrow">¶</a></p>
<p id="section-2-23">MPLS: Multi Protocol Label Switching<a href="#section-2-23" class="pilcrow">¶</a></p>
<p id="section-2-24">NLRI: Network Layer Reachability Information<a href="#section-2-24" class="pilcrow">¶</a></p>
<p id="section-2-25">PE: Provider Edge<a href="#section-2-25" class="pilcrow">¶</a></p>
<p id="section-2-26">PHP: Penultimate Hop Pop<a href="#section-2-26" class="pilcrow">¶</a></p>
<p id="section-2-27">PIC: Prefix scale Independent Convergence<a href="#section-2-27" class="pilcrow">¶</a></p>
<p id="section-2-28">PNH: Protocol Next Hop address carried in a BGP Update message<a href="#section-2-28" class="pilcrow">¶</a></p>
<p id="section-2-29">RD: Route Distinguisher<a href="#section-2-29" class="pilcrow">¶</a></p>
<p id="section-2-30">RD:EP : BGP CT Prefix consisting of Route Distinguisher and
      Endpoint<a href="#section-2-30" class="pilcrow">¶</a></p>
<p id="section-2-31">RSVP-TE: Resource Reservation Protocol - Traffic Engineering<a href="#section-2-31" class="pilcrow">¶</a></p>
<p id="section-2-32">RT: Route Target extended community<a href="#section-2-32" class="pilcrow">¶</a></p>
<p id="section-2-33">RTC: Route Target Constrain (RFC 4684)<a href="#section-2-33" class="pilcrow">¶</a></p>
<p id="section-2-34">SAFI: Subsequent Address Family Identifier<a href="#section-2-34" class="pilcrow">¶</a></p>
<p id="section-2-35">SID: Segment Identifier<a href="#section-2-35" class="pilcrow">¶</a></p>
<p id="section-2-36">SLA: Service Level Agreement<a href="#section-2-36" class="pilcrow">¶</a></p>
<p id="section-2-37">SN: Service Node<a href="#section-2-37" class="pilcrow">¶</a></p>
<p id="section-2-38">SR: Segment Routing<a href="#section-2-38" class="pilcrow">¶</a></p>
<p id="section-2-39">SRTE: Segment Routing Traffic Engineering<a href="#section-2-39" class="pilcrow">¶</a></p>
<p id="section-2-40">TC: Transport Class<a href="#section-2-40" class="pilcrow">¶</a></p>
<p id="section-2-41">TC ID: Transport Class Identifier<a href="#section-2-41" class="pilcrow">¶</a></p>
<p id="section-2-42">TC-BE: Best Effort Transport Class<a href="#section-2-42" class="pilcrow">¶</a></p>
<p id="section-2-43">TE: Traffic Engineering<a href="#section-2-43" class="pilcrow">¶</a></p>
<p id="section-2-44">TEA: Tunnel Encapsulation Attribute, attribute type code 23<a href="#section-2-44" class="pilcrow">¶</a></p>
<p id="section-2-45">TRDB: Transport Route Database<a href="#section-2-45" class="pilcrow">¶</a></p>
<p id="section-2-46">UHP: Ultimate Hop Pop<a href="#section-2-46" class="pilcrow">¶</a></p>
<p id="section-2-47">VRF: Virtual Routing and Forwarding table<a href="#section-2-47" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-definitions-and-notations">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-definitions-and-notations" class="section-name selfRef">Definitions and Notations</a>
        </h3>
<p id="section-2.1-1">BGP Community Carrying Attribute (CCA) : A BGP attribute that
        carries community. Examples of BGP CCA are: COMMUNITIES (attribute
        code 8), EXTENDED COMMUNITIES (attribute code 16), IPv6 Address
        Specific Extended Community (attribute code 25), LARGE_COMMUNITY
        (attribute code 32).<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">color:0:100 : This notation denotes a Color extended community as
        defined in RFC 9012 with the Flags field set to 0 and the color field
        set to 100.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">End to End Tunnel: A tunnel spanning several adjacent tunnel
        domains created by "stitching" them together using MPLS labels or an
        equivalent identifier based on the forwarding architecture.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Import processing: Receive side processing of an overlay route,
        including things like import policy application, resolution scheme
        selection and next hop resolution.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Intent: As defined in Section 2 of <span>[<a href="#RFC9315" class="cite xref">RFC9315</a>]</span>, "A set
        of operational goals (that a network should meet) and outcomes (that a
        network is supposed to deliver) defined in a declarative manner
        without specifying how to achieve or implement them." .<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Mapping Community: Any BGP CCA (e.g., Community, Extended
        Community) on an overlay route that maps to a Resolution Scheme. For
        example, color:0:100, transport-target:0:100.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">Provider Namespace: Internal Infrastructure address space in
        Provider network managed by the Operator.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">Resolution Scheme: A construct comprising of an ordered set of
        TRDBs to resolve next hop reachability, for realizing a desired
        intent.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">Service Family: A BGP address family used for advertising routes
        for destinations in "data traffic". For example, AFI/SAFIs 1/1 or
        1/128.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1-10">Transport Family: A BGP address family used for advertising
        tunnels, which are in turn used by service routes for resolution. For
        example, AFI/SAFIs 1/4 or 1/76.<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">Transport Tunnel : A tunnel over which a service may place traffic.
        Such a tunnel can be provisioned or signaled using a variety of means.
        For example, Generic Routing Encapsulation (GRE), UDP, LDP, RSVP-TE,
        IGP FLEX-ALGO or SRTE.<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<p id="section-2.1-12">Transport, Transport Layer: A layer in the network that contains
        Transport Tunnels and Transport Families.<a href="#section-2.1-12" class="pilcrow">¶</a></p>
<p id="section-2.1-13">Tunnel Route: A Route to Tunnel Destination/Endpoint that is
        installed at the headend (ingress) of the tunnel.<a href="#section-2.1-13" class="pilcrow">¶</a></p>
<p id="section-2.1-14">Tunnel Domain: A domain of the network containing Service Nodes
        (SNs) and Border Nodes (BNs) under a single administrative control
        that has tunnels between them.<a href="#section-2.1-14" class="pilcrow">¶</a></p>
<p id="section-2.1-15">Brownfield network: An existing network that is already in service,
        deploying a chosen set of technologies and hardware. Enhancements and
        upgrades to such network deployments protect return on investment, and
        should consider continuity of service.<a href="#section-2.1-15" class="pilcrow">¶</a></p>
<p id="section-2.1-16">Greenfield network: A new network deployment which can make choice
        of new technology or hardware as needed, with fewer constraints than
        brownfield network.<a href="#section-2.1-16" class="pilcrow">¶</a></p>
<p id="section-2.1-17">Transport Class: A construct to group transport tunnels offering
        similar SLA (Ref: Sec 4.1).<a href="#section-2.1-17" class="pilcrow">¶</a></p>
<p id="section-2.1-18">Transport Class RT: A Route Target Extended Community used to
        identify a specific Transport Class.<a href="#section-2.1-18" class="pilcrow">¶</a></p>
<p id="section-2.1-19">transport-target:0:100 : This notation denotes a Transport Class RT
        extended community as defined in this document with the "Transport
        Class ID" field set to 100.<a href="#section-2.1-19" class="pilcrow">¶</a></p>
<p id="section-2.1-20">Transport Route Database: At the SN and BN, a Transport Class has
        an associated Transport Route Database that collects its Tunnel
        Routes.<a href="#section-2.1-20" class="pilcrow">¶</a></p>
<p id="section-2.1-21">Transport Plane: An end-to-end plane consisting of transport
        tunnels belonging to the same Transport Class.<a href="#section-2.1-21" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-3">
      <h2 id="name-architecture-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-architecture-overview" class="section-name selfRef">Architecture Overview</a>
      </h2>
<p id="section-3-1">This section describes the BGP CT architecture with a brief
      illustration.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-overview-with-exampl"></span><div id="ArchOv">
<figure id="figure-1">
        <div id="section-3-2.1">
          <div class="alignLeft art-svg artwork" id="section-3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="512" width="568" viewBox="0 0 568 512" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 32,240 L 32,320" fill="none" stroke="black"></path>
              <path d="M 248,64 L 248,96" fill="none" stroke="black"></path>
              <path d="M 248,160 L 248,176" fill="none" stroke="black"></path>
              <path d="M 256,240 L 256,304" fill="none" stroke="black"></path>
              <path d="M 416,48 L 416,80" fill="none" stroke="black"></path>
              <path d="M 480,240 L 480,320" fill="none" stroke="black"></path>
              <path d="M 240,32 L 344,32" fill="none" stroke="black"></path>
              <path d="M 360,32 L 384,32" fill="none" stroke="black"></path>
              <path d="M 112,64 L 184,64" fill="none" stroke="black"></path>
              <path d="M 328,64 L 376,64" fill="none" stroke="black"></path>
              <path d="M 88,112 L 112,112" fill="none" stroke="black"></path>
              <path d="M 168,112 L 184,112" fill="none" stroke="black"></path>
              <path d="M 240,110 L 256,110" fill="none" stroke="black"></path>
              <path d="M 240,114 L 256,114" fill="none" stroke="black"></path>
              <path d="M 312,112 L 328,112" fill="none" stroke="black"></path>
              <path d="M 384,112 L 400,112" fill="none" stroke="black"></path>
              <path d="M 48,192 L 184,192" fill="none" stroke="black"></path>
              <path d="M 312,192 L 448,192" fill="none" stroke="black"></path>
              <path d="M 48,224 L 56,224" fill="none" stroke="black"></path>
              <path d="M 144,224 L 160,224" fill="none" stroke="black"></path>
              <path d="M 368,224 L 384,224" fill="none" stroke="black"></path>
              <path d="M 456,224 L 464,224" fill="none" stroke="black"></path>
              <path d="M 56,240 L 72,240" fill="none" stroke="black"></path>
              <path d="M 280,240 L 296,240" fill="none" stroke="black"></path>
              <path d="M 56,288 L 72,288" fill="none" stroke="black"></path>
              <path d="M 280,288 L 296,288" fill="none" stroke="black"></path>
              <path d="M 48,336 L 56,336" fill="none" stroke="black"></path>
              <path d="M 456,336 L 464,336" fill="none" stroke="black"></path>
              <path d="M 72,80 L 88,112" fill="none" stroke="black"></path>
              <path d="M 312,80 L 324,104" fill="none" stroke="black"></path>
              <path d="M 184,64 L 192,48" fill="none" stroke="black"></path>
              <path d="M 376,64 L 384,48" fill="none" stroke="black"></path>
              <path d="M 48,224 C 39.16936,224 32,231.16936 32,240" fill="none" stroke="black"></path>
              <path d="M 464,224 C 472.83064,224 480,231.16936 480,240" fill="none" stroke="black"></path>
              <path d="M 48,336 C 39.16936,336 32,328.83064 32,320" fill="none" stroke="black"></path>
              <path d="M 464,336 C 472.83064,336 480,328.83064 480,320" fill="none" stroke="black"></path>
              <path d="M 132,88 L 156,88" fill="none" stroke="black"></path>
              <path d="M 348,88 L 372,88" fill="none" stroke="black"></path>
              <path d="M 124,136 L 148,136" fill="none" stroke="black"></path>
              <path d="M 340,136 L 364,136" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="392,192 380,186.4 380,197.6" fill="black" transform="rotate(0,384,192)"></polygon>
              <polygon class="arrowhead" points="376,224 364,218.4 364,229.6" fill="black" transform="rotate(180,368,224)"></polygon>
              <polygon class="arrowhead" points="368,32 356,26.4 356,37.6" fill="black" transform="rotate(180,360,32)"></polygon>
              <polygon class="arrowhead" points="336,64 324,58.4 324,69.6" fill="black" transform="rotate(180,328,64)"></polygon>
              <polygon class="arrowhead" points="288,288 276,282.4 276,293.6" fill="black" transform="rotate(180,280,288)"></polygon>
              <polygon class="arrowhead" points="288,240 276,234.4 276,245.6" fill="black" transform="rotate(180,280,240)"></polygon>
              <polygon class="arrowhead" points="152,224 140,218.4 140,229.6" fill="black" transform="rotate(180,144,224)"></polygon>
              <polygon class="arrowhead" points="120,192 108,186.4 108,197.6" fill="black" transform="rotate(0,112,192)"></polygon>
              <polygon class="arrowhead" points="120,64 108,58.4 108,69.6" fill="black" transform="rotate(180,112,64)"></polygon>
              <polygon class="arrowhead" points="64,288 52,282.4 52,293.6" fill="black" transform="rotate(180,56,288)"></polygon>
              <polygon class="arrowhead" points="64,240 52,234.4 52,245.6" fill="black" transform="rotate(180,56,240)"></polygon>
              <g class="text">
                <text x="132" y="36">INET</text>
                <text x="212" y="36">[RR21]</text>
                <text x="352" y="36">&lt;</text>
                <text x="412" y="36">[RR11]</text>
                <text x="144" y="52">Service</text>
                <text x="444" y="52">IP1,</text>
                <text x="512" y="52">color:0:100</text>
                <text x="68" y="68">[PE21]</text>
                <text x="104" y="68">&lt;</text>
                <text x="284" y="68">[SN11]</text>
                <text x="320" y="68">&lt;</text>
                <text x="444" y="68">IP2,</text>
                <text x="512" y="68">color:0:200</text>
                <text x="444" y="84">IP3,</text>
                <text x="496" y="84">100:200</text>
                <text x="124" y="100">_(</text>
                <text x="160" y="100">)</text>
                <text x="340" y="100">_(</text>
                <text x="376" y="100">)</text>
                <text x="424" y="100">^&lt;&lt;</text>
                <text x="512" y="100">^^^^^^^^^^^</text>
                <text x="160" y="116">_</text>
                <text x="212" y="116">[BN21]</text>
                <text x="284" y="116">[BN11]</text>
                <text x="376" y="116">_</text>
                <text x="428" y="116">[PE11]</text>
                <text x="512" y="116">Mapping</text>
                <text x="120" y="132">(</text>
                <text x="152" y="132">)</text>
                <text x="248" y="132">|</text>
                <text x="336" y="132">(</text>
                <text x="368" y="132">)</text>
                <text x="512" y="132">Community</text>
                <text x="248" y="148">Inter-AS-Link</text>
                <text x="140" y="180">[.......AS2:SR-TE........]</text>
                <text x="356" y="180">[.......AS1:RSVP-TE......]</text>
                <text x="204" y="196">MPLS</text>
                <text x="268" y="196">Forwarding</text>
                <text x="104" y="228">[PE21]--&lt;</text>
                <text x="188" y="228">[BN21]</text>
                <text x="328" y="228">[BN21]--&lt;</text>
                <text x="412" y="228">[BN11]</text>
                <text x="48" y="244">&lt;</text>
                <text x="160" y="244">RD1:PE11(L3),PNH=BN21</text>
                <text x="272" y="244">&lt;</text>
                <text x="384" y="244">RD1:PE11(L1),PNH=BN11</text>
                <text x="148" y="260">transport-target:0:100</text>
                <text x="372" y="260">transport-target:0:100</text>
                <text x="504" y="260">BGP</text>
                <text x="524" y="276">Classful</text>
                <text x="48" y="292">&lt;</text>
                <text x="160" y="292">RD2:PE11(L4),PNH=BN21</text>
                <text x="272" y="292">&lt;</text>
                <text x="384" y="292">RD2:PE11(L2),PNH=BN11</text>
                <text x="528" y="292">Transport</text>
                <text x="148" y="308">transport-target:0:200</text>
                <text x="372" y="308">transport-target:0:200</text>
                <text x="148" y="324">^^^^^^^^^^^^^^^^^^^^^^</text>
                <text x="448" y="324">^^^</text>
                <text x="112" y="340">Route</text>
                <text x="164" y="340">Target</text>
                <text x="200" y="340">&amp;</text>
                <text x="328" y="340">Transport</text>
                <text x="392" y="340">Class</text>
                <text x="428" y="340">ID</text>
                <text x="112" y="356">Mapping</text>
                <text x="184" y="356">Community</text>
                <text x="12" y="388">at</text>
                <text x="44" y="388">SN11</text>
                <text x="80" y="388">and</text>
                <text x="120" y="388">PE21,</text>
                <text x="76" y="420">Scheme1:</text>
                <text x="164" y="420">color:0:100,</text>
                <text x="276" y="420">(TRDB[TC-100],</text>
                <text x="388" y="420">TRDB[TC-BE])</text>
                <text x="76" y="436">Scheme2:</text>
                <text x="164" y="436">color:0:200,</text>
                <text x="276" y="436">(TRDB[TC-200],</text>
                <text x="388" y="436">TRDB[TC-BE])</text>
                <text x="76" y="452">Scheme3:</text>
                <text x="180" y="452">100:200,</text>
                <text x="276" y="452">(TRDB[TC-100],</text>
                <text x="392" y="452">TRDB[TC-200])</text>
                <text x="72" y="468">^^^^^^^</text>
                <text x="244" y="468">^^^^</text>
                <text x="404" y="468">^^^^^^</text>
                <text x="44" y="484">Resolution</text>
                <text x="120" y="484">Schemes</text>
                <text x="208" y="484">Transport</text>
                <text x="272" y="484">Route</text>
                <text x="308" y="484">DB</text>
                <text x="384" y="484">Transport</text>
                <text x="448" y="484">Class</text>
              </g>
            </svg><a href="#section-3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-bgp-ct-overview-with-exampl" class="selfRef">BGP CT Overview with Example Topology</a>
        </figcaption></figure>
</div>
<p id="section-3-3">To achieve end-to-end "Intent Driven Service Mapping", this document
      defines the following constructs and BGP extensions:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3-4.1">
          <p id="section-3-4.1.1">The <span><a href="#tc" class="internal xref">"Transport Class"</a> (<a href="#tc" class="auto internal xref">Section 4</a>)</span> construct to group
          underlay tunnels.<a href="#section-3-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="section-3-4.2">
          <p id="section-3-4.2.1">The <span><a href="#Nexthop_Resoln_Schm" class="internal xref">"Resolution Scheme"</a> (<a href="#Nexthop_Resoln_Schm" class="auto internal xref">Section 5</a>)</span>
          construct for overlay routes with Mapping Community to resolve next
          hop reachability from either one or an ordered set of Transport
          Classes.<a href="#section-3-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="section-3-4.3">
          <p id="section-3-4.3.1">The <span><a href="#ct-family" class="internal xref">"BGP Classful Transport"</a> (<a href="#ct-family" class="auto internal xref">Section 6</a>)</span>
          address family to extend these constructs to adjacent domains.<a href="#section-3-4.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-5"><a href="#ArchOv" class="auto internal xref">Figure 1</a> depicts the intra-AS and inter-AS
      application of these constructs. It uses an example topology of Inter-AS
      option C network with two AS domains. AS1 is a RSVP-TE network, AS2 is a
      SRTE network. BGP CT and BGP LU are transport layer families used
      between the two AS domains. IP1, IP2, IP3 are service prefixes
      (AFI/SAFI: 1/1) behind egress PE11.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">PE21, SN11 and PE11 are the SNs in this network. SN11 is an ingress
      PE with intra domain reachability to PE11. PE21 is an ingress PE with
      inter domain reachability to PE11.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">The tunneling mechanisms are made "Transport Class" aware. They
      publish their underlay tunnels for a Transport Class into an associated
      <span><a href="#trdb" class="internal xref">"Transport Route Database" (TRDB)</a> (<a href="#trdb" class="auto internal xref">Section 4.2</a>)</span>. In <a href="#ArchOv" class="auto internal xref">Figure 1</a>, RSVP-TE publishes its underlay tunnels into TRDBs
      created for Transport Class 100 and 200 at BN11 and SN11 within AS1;
      Similarly, SR-TE publishes its underlay tunnels into TRDBs created for
      Transport Class 100 and 200 at PE21 within AS2.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">The underlay route in a TRDB can be advertised in BGP to extend an
      underlay tunnel to adjacent domains. A new BGP transport layer address
      family called "BGP Classful Transport", also known as BGP CT (AFI/SAFIs
      1/76, 2/76) is defined for this purpose. BGP CT makes it possible to
      advertise multiple tunnels to the same destination address, thus
      avoiding the need for multiple loopbacks on the Egress Service Node
      (eSN).<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">The BGP CT address family carries transport prefixes across tunnel
      domain boundaries. Its design and operation are analogous to BGP LU
      (AFI/SAFIs 1/4 or 2/4). It disseminates "Transport Class" information
      for the transport prefixes across the participating domains while
      avoiding the need of per-transport class loopback. This is not possible
      with BGP LU without using per-color loopback. This makes the end-to-end
      network a "Transport Class" aware tunneled network.<a href="#section-3-9" class="pilcrow">¶</a></p>
<p id="section-3-10">In <a href="#ArchOv" class="auto internal xref">Figure 1</a>, BGP CT routes are originated at BN11 in
      AS1 with next hop "self" towards BN21 in AS2 to extend available RSVP-TE
      tunnels for Transport Class 100 and 200 in AS1. BN21 propagates these
      routes with next hop "self" to PE21, which resolves the BGP CT routes
      over SRTE tunnels belonging to same transport class.<a href="#section-3-10" class="pilcrow">¶</a></p>
<p id="section-3-11">Overlay routes carry an indication of the desired Transport Classes
      using a BGP community which assumes the role of a "Mapping Community". A
      Resolution Scheme is identified by its "Mapping Community", where its
      configuration can either be auto-generated based on TC ID or done
      manually.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">The following text illustrates CT architecture having the property of
      providing tiered fallback options at a per-route granularity. In <a href="#ArchOv" class="auto internal xref">Figure 1</a>, the Resolution Schemes are shown and the following
      next hop resolutions are done by SN11 and PE21 for the service routes of
      prefixes IP1, IP2, IP3:<a href="#section-3-12" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3-13.1">
          <p id="section-3-13.1.1">Resolve IP1 next hop over available tunnels in TRDB for Transport
          Class 100 with fallback to TRDB for best effort.<a href="#section-3-13.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="section-3-13.2">
          <p id="section-3-13.2.1">Resolve IP2 next hop over available tunnels in TRDB for Transport
          Class 200 with fallback to TRDB for best effort.<a href="#section-3-13.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal ulEmpty" id="section-3-13.3">
          <p id="section-3-13.3.1">Resolve IP3 next hop over available tunnels in TRDB for Transport
          Class 100 with fallback to TRDB for Transport Class 200.<a href="#section-3-13.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-3-14">In <a href="#ArchOv" class="auto internal xref">Figure 1</a>, SN11 resolves IP1, IP2 and IP3
      directly over RSVP-TE tunnels in AS1. PE21 resolves IP1, IP2 and IP3
      over extended BGP CT tunnels that resolve over SR-TE tunnels in AS2.<a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">This document describes procedures using MPLS forwarding
      architecture. However, these procedures would work in a similar manner
      for non-MPLS forwarding architectures as well. <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a> describes the application of BGP CT over SRv6
      data plane.<a href="#section-3-15" class="pilcrow">¶</a></p>
</section>
<div id="tc">
<section id="section-4">
      <h2 id="name-transport-class">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-transport-class" class="section-name selfRef">Transport Class</a>
      </h2>
<p id="section-4-1">Transport Class is a construct that groups transport tunnels offering
      similar SLA within the administrative domain of a provider network or
      closely coordinated provider networks.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">A Transport Class is uniquely identified by a 32-bit "Transport Class
      ID", that is assigned by the operator. The operator consistently
      provisions a Transport Class on participating nodes (SNs and BNs) in a
      domain with its unique Transport Class ID.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">A Transport Class is also configured with RD and import/export RT
      attributes. Creation of a Transport Class instantiates its corresponding
      TRDB and Resolution Schemes on that node.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">All nodes within a domain agree on a common Transport Class ID
      namespace. However, two co-operating domains may not always agree on the
      same namespace. Procedures to manage differences in Transport Class ID
      namespaces between co-operating domains are specified in <a href="#non-agreeing" class="auto internal xref">Section 11.2.2</a>.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Transport Class ID conveys the Color of tunnels in a Transport Class.
      The terms 'Transport Class ID' and 'Color' are used interchangeably in
      this document.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="tc-te">
<section id="section-4.1">
        <h3 id="name-classifying-te-tunnels">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-classifying-te-tunnels" class="section-name selfRef">Classifying TE tunnels</a>
        </h3>
<p id="section-4.1-1">TE tunnels can be classified into a Transport Class based on the TE
        attributes they possess and the TE characteristics that the operator
        defines for that Transport Class. Due to the fact that multiple TE
        tunneling protocols exist, their TE attributes and characteristics may
        not be equal but sufficiently similar. Some examples of such
        classifications are as follows:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-2.1">
            <p id="section-4.1-2.1.1">Tunnels (RSVP-TE, IGP FLEX-ALGO, SR-TE) that support latency
            sensitive routing.<a href="#section-4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">RSVP-TE Tunnels that only go over admin-group with Green
            links.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-4.1-2.3">
            <p id="section-4.1-2.3.1">Tunnels (RSVP-TE, SR-TE) that offer Fast Reroute.<a href="#section-4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">Tunnels (RSVP-TE, SR-TE) that share resources in the network
            based on Shared Risk Link Groups defined by TE policy.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-4.1-2.5">
            <p id="section-4.1-2.5.1">Tunnels (RSVP-TE, SR-TE, BGP CT) that avoid certain nodes in
            the network based on RSVP-TE ERO, SR-TE policy or BGP policy.<a href="#section-4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.1-3">An operator may configure a SN/BN to classify a tunnel into an
        appropriate Transport Class. How exactly these tunnels are made
        Transport Class aware is implementation specific and outside the scope
        of this document.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">When a tunnel is made Transport Class aware, it causes the Tunnel
        Route to be installed in the corresponding TRDB of that Transport
        Class. These routes are used to resolve overlay routes, including BGP
        CT. The BGP CT routes may be further readvertised to adjacent domains
        to extend these tunnels. While readvertising BGP CT routes, the
        "Transport Class" identifier is encoded as part of the Transport Class
        RT, which is a new Route Target extended community defined in <a href="#tc-rt" class="auto internal xref">Section 4.3</a>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">A SN/BN receiving the transport routes via BGP with sufficient
        signaling information to identify a Transport Class can associate
        those tunnel routes to the corresponding Transport Class. For example,
        in BGP CT family routes, the Transport Class RT indicates the
        Transport Class. For BGP LU family routes, import processing based on
        Communities or Inter-AS source-peer may be used to place the route in
        the desired Transport Class.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">When the tunnel route is received via <span>[<a href="#SRTE" class="cite xref">SRTE</a>]</span> with
        "Color:Endpoint" as the NLRI that encodes the Transport Class as an
        integer 'Color' in its Policy Color field, the 'Color' is mapped to a
        Transport Class during the import processing. The SRTE tunnel route
        for this 'Endpoint' is installed in the corresponding TRDB. The SRTE
        tunnel will be extended by a BGP CT advertisement with NLRI
        'RD:Endpoint', Transport Class RT and a new label. The MPLS swap route
        thus installed for the new label will pop the label and forward the
        decapsulated traffic into the path determined by the SRTE route for
        further encapsulation.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7"><span>[<a href="#PCEP-SRPOLICY" class="cite xref">PCEP-SRPOLICY</a>]</span> extends Path Computation Element
        Communication Protocol (PCEP) to signal attributes of an SR Policy
        which include Color. This Color is mapped to a Transport Class thus
        associating the SR Policy with the desired Transport Class.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">Similarly, <span>[<a href="#PCEP-RSVP-COLOR" class="cite xref">PCEP-RSVP-COLOR</a>]</span> extends PCEP to carry
        the Color attribute for its use with RSVP-TE LSPs . This Color is
        mapped to a Transport Class thus associating the RSVP-TE LSP with the
        desired Transport Class.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trdb">
<section id="section-4.2">
        <h3 id="name-transport-route-database">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-transport-route-database" class="section-name selfRef">Transport Route Database</a>
        </h3>
<p id="section-4.2-1">A Transport Route Database (TRDB) is a logical collection of
        transport routes pertaining to the same Transport Class. In any node,
        every Transport Class has an associated TRDB. Resolution Schemes
        resolve next hop reachability for EP using the transport routes within
        the scope of the TRDBs.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Tunnel endpoint addresses (EP) in a TRDB belong to the "Provider
        Namespace" representing the core transport region.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">An implementation may realize the TRDB as a "Routing Table"
        referred in <a href="https://www.rfc-editor.org/rfc/rfc4271#section-9.1.2.1">Section
        9.1.2.1 of RFC4271</a> which is used only for resolving next hop
        reachability in control plane. An implementation may choose a
        different datastructure to realize this logical construct while still
        adhering to the procedures defined in this document. The tunnel routes
        in a TRDB require no footprint in the forwarding plane unless they are
        used to resolve a next hop.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">SNs or BNs originate routes for the "Classful Transport" address
        family from the TRDB. These routes have "RD:Endpoint" in the NLRI,
        carry a Transport Class RT, and an MPLS label or equivalent identifier
        in different forwarding architecture. "Classful Transport" family
        routes received with Transport Class RT are installed into their
        respective TRDB.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tc-rt">
<section id="section-4.3">
        <h3 id="name-transport-class-route-targe">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-transport-class-route-targe" class="section-name selfRef">"Transport Class" Route Target Extended Community</a>
        </h3>
<p id="section-4.3-1">This section defines a new type of Route Target, called a
        "Transport Class" Route Target Extended Community; also known as a
        Transport Target. The procedures for use of this extended community
        with BGP CT routes (AFI/SAFI: 1/76 or 2/76) are described below.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The "Transport Class" Route Target Extended Community is a
        transitive extended community <span><a href="#RFC4360" class="internal xref">EXT-COMM</a> [<a href="#RFC4360" class="cite xref">RFC4360</a>]</span>
        of extended type, which has the format as shown in <a href="#TCExtCom" class="auto internal xref">Figure 2</a>.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<span id="name-transport-class-route-target"></span><div id="TCExtCom">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.3-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type= 0xa   | SubType= 0x02 |            Reserved           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Transport Class ID                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

 Type: 1-octet field MUST be set to 0xa to indicate 'Transport Class'.

 SubType: 1-octet field MUST be set to 0x2 to indicate 'Route Target'.

 Reserved: 2-octet reserved bits field.
         This field MUST be set to zero on transmission.
         This field SHOULD be ignored on reception, and
         MUST be left unaltered.

 Transport Class ID: This field is encoded in 4 octets.

    This field contains the "Transport Class" identifier,
    which is an unsigned 32-bit integer.

    This document reserves the Transport class ID value 0 to
    represent "Best Effort Transport Class ID".</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-transport-class-route-target" class="selfRef">"Transport Class" Route Target Extended Community</a>
          </figcaption></figure>
</div>
<p id="section-4.3-4">The VPN route import/export mechanisms specified in <span><a href="#RFC4364" class="internal xref">BGP/MPLS IP VPNs</a> [<a href="#RFC4364" class="cite xref">RFC4364</a>]</span> and the Constrained Route
        Distribution mechanisms specified in <span><a href="#RFC4684" class="internal xref">Route
        Target Constrain</a> [<a href="#RFC4684" class="cite xref">RFC4684</a>]</span> are applied using the Route Target extended
        community. These mechanisms are applied to BGP CT routes (AFI/SAFI:
        1/76 or 2/76) using "Transport Class Route Target Extended
        community".<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">A BGP speaker that implements procedures described in this document
        and <span><a href="#RFC4684" class="internal xref">Route Target Constrain</a> [<a href="#RFC4684" class="cite xref">RFC4684</a>]</span> MUST also
        apply the RTC procedures to the Transport Class Route Target Extended
        communities carried on BGP CT routes (AFI/SAFI: 1/76 or 2/76). An RTC
        route is generated for each Route Target imported by locally
        provisioned Transport Classes.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<p id="section-4.3-6">Further, when processing RT membership NLRIs containing Transport
        Class Route Target Extended community received from external BGP
        peers, it is necessary to consider multiple EBGP paths for a given RTC
        prefix for building the outbound route filter, and not just the best
        path. An implementation MAY provide configuration to control how many
        EBGP RTC paths are considered.<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">The Transport Class Route Target Extended community is carried on
        BGP CT family routes and is used to associate them with appropriate
        TRDBs at receiving BGP speakers. The Transport Target is carried
        unaltered on the BGP CT route across BGP CT negotiated sessions except
        for scenarios described in <a href="#non-agreeing" class="auto internal xref">Section 11.2.2</a>.
        Implementations should provide policy mechanisms to perform match,
        strip, or rewrite operations on a Transport Target just like any other
        BGP community.<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<p id="section-4.3-8">Defining a new type code for the Transport Class Route Target
        Extended community avoids conflicting with any VPN Route Target
        assignments already in use for service families.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
<p id="section-4.3-9">This document also reserves the <span><a href="#tc-rt-nt" class="internal xref">Non-Transitive version of Transport Class extended
        community</a> (<a href="#tc-rt-nt" class="auto internal xref">Section 13.2.1.1.2</a>)</span> for future use. The "Non-Transitive Transport Class"
        Route Target Extended Community is not used. If received, it is
        considered equivalent in functionality to the Transitive Transport
        Class Route Target Extended Community, except for the difference in
        Transitive bit flag.<a href="#section-4.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Nexthop_Resoln_Schm">
<section id="section-5">
      <h2 id="name-resolution-scheme">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-resolution-scheme" class="section-name selfRef">Resolution Scheme</a>
      </h2>
<p id="section-5-1">A Resolution Scheme is a construct that consists of a specific TRDB
      or an ordered set of TRDBs. An overlay route is associated with a
      resolution scheme during import processing, based on the Mapping
      Community in the route.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Resolution Schemes enable a BGP speaker to resolve next hop
      reachability for overlay routes over the appropriate underlay tunnels
      within the scope of the TRDBs. Longest Prefix Match (LPM) of the next
      hop is performed within the identified TRDB.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">An implementation may provide an option for the overlay route to
      resolve over less preferred Transport Classes, should the resolution
      over a primary Transport Class fail.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">To accomplish this, the "Resolution Scheme" is configured with the
      primary Transport Class, and an ordered list of fallback Transport
      Classes. Two Resolution Schemes are considered equivalent in Intent if
      they consist of the same ordered set of TRDBs.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">Operators must ensure that Resolution Schemes for a mapping community
      are provisioned consistently on various nodes participating in a BGP CT
      network, based on desired Intent and transport classes available in that
      domain.<a href="#section-5-5" class="pilcrow">¶</a></p>
<div id="Mapping_Comm">
<section id="section-5.1">
        <h3 id="name-mapping-community">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-mapping-community" class="section-name selfRef">Mapping Community</a>
        </h3>
<p id="section-5.1-1">A "Mapping Community" is used to signal the desired Intent on an
        overlay route. At an ingress node receiving the route, it maps the
        overlay route to a "Resolution Scheme" used to resolve the route's
        next hop.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">A Mapping Community is a "role" and not a new type of community;
        any BGP Community Carrying Attribute (e.g. Community or Extended
        Community) may play this role, besides the other roles it may already
        be playing. For example, the Transport Class Route Target Extended
        Community plays a dual role, being a Route Target as well as a Mapping
        Community.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Operator provisioning ensures that the ingress and egress SNs agree
        on the BGP CCA and community namespace to use for the Mapping
        Community.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">A Mapping Community maps to exactly one Resolution Scheme at
        receiving BGP speaker. An implementation SHOULD allow associating
        multiple Mapping Communities to a Resolution Scheme. This helps with
        renumbering and migration scenarios.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">An example of mapping community is "color:0:100", described in
        <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>, or the "transport-target:0:100" described in
        <a href="#tc-rt" class="auto internal xref">Section 4.3</a> in this document.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">In a properly configured network, the order of communities on an
        overlay route does not affect the determining of Mapping community in
        effect.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">The first community on the overlay route that matches a Mapping
        Community of a locally configured Resolution Scheme is considered the
        effective Mapping Community for the route. The Resolution Scheme thus
        found is used when resolving the route's PNH. If a route contains more
        than one Mapping Community, it indicates that the route considers
        these distinct Mapping Communities as equivalent in Intent.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">If more than one distinct Mapping Communities on an overlay route
        map to distinct Resolution Schemes with dissimilar Intents at a
        receiving node, it is considered a configuration error. Operators
        should avoid such configuration errors when attaching mapping
        communities on overlay routes.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">It should be noted that the Mapping Community role does not require
        applying Route Target Constrain procedures specified in RFC 4684.<a href="#section-5.1-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ct-family">
<section id="section-6">
      <h2 id="name-bgp-classful-transport-fami">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-bgp-classful-transport-fami" class="section-name selfRef">BGP Classful Transport Family</a>
      </h2>
<p id="section-6-1">The BGP Classful Transport (BGP CT) family uses the existing Address
      Family Identifier (AFI) of IPv4 or IPv6 and a new SAFI 76 "Classful
      Transport" that applies to both IPv4 and IPv6 AFIs.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The AFI/SAFI 1/76 MUST be negotiated as per the Multiprotocol
      Extensions capability described in Section 8 of <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span>
      to be able to send and receive BGP CT routes for IPv4 endpoint
      prefixes.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">The AFI/SAFI 2/76 MUST be negotiated as per the Multiprotocol
      Extensions capability described in Section 8 of <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span>
      to be able to send and receive BGP CT routes for IPv6 endpoint
      prefixes.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="ct-nlri">
<section id="section-6.1">
        <h3 id="name-nlri-encoding">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-nlri-encoding" class="section-name selfRef">NLRI Encoding</a>
        </h3>
<p id="section-6.1-1">The "Classful Transport" SAFI NLRI has the same encoding as
        specified in Section 2 of <span>[<a href="#RFC8277" class="cite xref">RFC8277</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">When AFI/SAFI is 1/76, the Classful Transport NLRI Prefix consists
        of an 8-byte RD followed by an IPv4 prefix. When AFI/SAFI is 2/76, the
        Classful Transport NLRI Prefix consists of an 8-byte RD followed by an
        IPv6 prefix.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">The procedures described for AFI/SAFIs 1/4 or 1/128 in Section 2 of
        <span>[<a href="#RFC8277" class="cite xref">RFC8277</a>]</span> apply for AFI/SAFI 1/76 also. The procedures
        described for AFI/SAFIs 2/4 or 2/128 in Section 2 of <span>[<a href="#RFC8277" class="cite xref">RFC8277</a>]</span> apply for AFI/SAFI 2/76 also.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">BGP CT routes MAY carry multiple labels in the NLRI, by negotiating
        the Multiple Labels Capability as described in Section 2.1 of <span>[<a href="#RFC8277" class="cite xref">RFC8277</a>]</span><a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Properties received on a Classful Transport route include the
        Transport Class Route Target extended community, which is used to
        associate the route with the correct TRDBs on SNs and BNs in the
        network, and either an IPv4 or an IPv6 next hop.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ct-nhop">
<section id="section-6.2">
        <h3 id="name-next-hop-encoding">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-next-hop-encoding" class="section-name selfRef">Next Hop Encoding</a>
        </h3>
<p id="section-6.2-1">When the length of the Next hop Address field is 4, the next hop
        address is of type IPv4 address.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">When the length of Next hop Address field is 16 (or 32), the next
        hop address is of type IPv6 address (potentially followed by the
        link-local IPv6 address of the next hop). This follows Section 3 in
        <span>[<a href="#RFC2545" class="cite xref">RFC2545</a>]</span><a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">When the length of Next hop Address field is 24 (or 48), the next
        hop address is of type VPN-IPv6 with an 8-octet RD set to zero
        (potentially followed by the link-local VPN-IPv6 address of the next
        hop with an 8-octet RD set to zero). This follows Section 3.2.1.1 in
        <span>[<a href="#RFC4659" class="cite xref">RFC4659</a>]</span><a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">When the length of the Next hop Address field is 12, the next hop
        address is of type VPN-IPv4 with 8-octet RD set to zero.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">If the length of the Next hop Address field contains any other
        values, it is considered an error and is handled via BGP session reset
        as per <span><a href="https://rfc-editor.org/rfc/rfc7606#section-7.11" class="relref">Section 7.11</a> of [<a href="#RFC7606" class="cite xref">RFC7606</a>]</span>.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CTMultiEncap">
<section id="section-6.3">
        <h3 id="name-carrying-multiple-encapsula">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-carrying-multiple-encapsula" class="section-name selfRef">Carrying multiple Encapsulation Information</a>
        </h3>
<p id="section-6.3-1">To ease interoperability between nodes supporting different
        forwarding technologies, a BGP CT route allows carrying multiple
        encapsulation information.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">An MPLS Label is carried using the encoding in <span>[<a href="#RFC8277" class="cite xref">RFC8277</a>]</span>. A node that does not support MPLS forwarding
        advertises the special label 3 (Implicit NULL) in the RFC 8277 MPLS
        Label field. The Implicit NULL label carried in BGP CT route indicates
        to receiving node that it should not impose any BGP CT label for this
        route.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">The SID information for SR with respect to MPLS Data Plane is
        carried as specified in Prefix SID attribute defined as part of
        Section 3 in <span>[<a href="#RFC8669" class="cite xref">RFC8669</a>]</span>.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">The SID information for SR with respect to SRv6 Data Plane is
        carried as specified in <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a>.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">UDP tunneling information is carried using Tunnel Encapsulation
        Attribute as specified in <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.4">
        <h3 id="name-comparison-with-other-famil">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-comparison-with-other-famil" class="section-name selfRef">Comparison with Other Families using RFC-8277 Encoding</a>
        </h3>
<p id="section-6.4-1">AFI/SAFI 1/128 (MPLS-labeled VPN address) is an RFC8277 encoded
        family that carries service prefixes in the NLRI, where the prefixes
        come from the customer namespaces and are contextualized into separate
        user virtual service RIBs called VRFs as per [RFC4364].<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">AFI/SAFI 1/4 (BGP LU) is an RFC8277 encoded family that carries
        transport prefixes in the NLRI, where the prefixes come from the
        provider namespace.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">AFI/SAFI 1/76 (Classful Transport SAFI) is an RFC8277 encoded
        family that carries transport prefixes in the NLRI, where the prefixes
        come from the provider namespace and are contextualized into separate
        TRDB, following mechanisms similar to RFC 4364 procedures.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">It is worth noting that AFI/SAFI 1/128 has been used to carry
        transport prefixes in "L3VPN Inter-AS Carrier's carrier" scenario as
        defined in Section 10 of <span>[<a href="#RFC4364" class="cite xref">RFC4364</a>]</span>, where BGP LU/LDP
        prefixes in CsC VRF are advertised in AFI/SAFI 1/128 towards the
        remote-end client carrier.<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">In this document, SAFI 76 (BGP CT) is used instead of reusing SAFI
        128 (L3VPN) for AFIs 1 or 2 to carry these transport routes because it
        is operationally advantageous to segregate transport and service
        prefixes into separate address families. For example, such an approach
        allows operators to safely enable "per-prefix" label allocation scheme
        for Classful Transport prefixes, typically with a number of routes in
        the hundreds of thousands or less, without affecting SAFI 128 service
        prefixes which may represent millions of routes, at time of writing.
        The "per prefix" label allocation scheme localizes routing churn
        during topology changes.<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">Service routes continue to be carried in their existing AFI/SAFIs
        without any change. For example, L3VPN (AFI/SAFI: 1/128 and 2/128),
        EVPN (AFI/SAFI: 25/70 ), VPLS (AFI/SAFI: 25/65), Internet (AFI/SAFI:
        1/1 or 2/1). These service routes can resolve over BGP CT (AFI/SAFI:
        1/76 or 2/76) transport routes.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">A new SAFI 76 for AFI 1 and AFI 2 also facilitates having a
        different distribution path of the transport family routes in a
        network than the service route distribution path. Service routes
        (Inet-VPN SAFI 128) are exchanged over an EBGP multihop session
        between ASes with next hop unchanged; whereas Classful Transport
        routes (SAFI 76) are advertised over EBGP single-hop sessions with
        "next hop self" rewrite over inter-AS links.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<p id="section-6.4-8">The BGP CT SAFI 76 for AFI 1 and 2 is conceptually similar to BGP
        LU SAFI 4, in that it carries transport prefixes. The only difference
        is that it also carries in a Route Target an indication of which
        Transport Class the transport prefix belongs to, and uses the RD to
        disambiguate multiple instances of the same transport prefix in a BGP
        Update.<a href="#section-6.4-8" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-7">
      <h2 id="name-protocol-procedures">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-protocol-procedures" class="section-name selfRef">Protocol Procedures</a>
      </h2>
<p id="section-7-1">This section summarizes the procedures followed by various nodes
      speaking Classful Transport family.<a href="#section-7-1" class="pilcrow">¶</a></p>
<section id="section-7.1">
        <h3 id="name-preparing-the-network-to-de">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-preparing-the-network-to-de" class="section-name selfRef">Preparing the network to deploy Classful Transport planes</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.1-1.1">
            <p id="section-7.1-1.1.1">It is responsibility of the operators to decide the Transport
            Classes to enable and use in their network. They are also expected
            to allocate a Transport Class Route Target to identify each
            Transport Class.<a href="#section-7.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.1-1.2">
            <p id="section-7.1-1.2.1">Operators configure the Transport Classes on the SNs and BNs in
            the network with Transport Class Route Targets and appropriate
            Route-Distinguishers.<a href="#section-7.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.1-1.3">
            <p id="section-7.1-1.3.1">Implementations MAY provide automatic generation and assignment
            of RD, RT values. They MAY also provide a way to manually override
            the automatic mechanism in order to deal with any conflicts that
            may arise with existing RD, RT values in different network domains
            participating in the deployment.<a href="#section-7.1-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-7.2">
        <h3 id="name-originating-classful-transp">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-originating-classful-transp" class="section-name selfRef">Originating Classful Transport Routes</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.2-1.1">
            <p id="section-7.2-1.1.1">BGP CT routes are sent only to BGP peers that have negotiated
            the Multiprotocol Extensions capability described in Section 8 of
            [RFC4760] to be able to send and receive BGP CT routes.<a href="#section-7.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.2-1.2">
            <p id="section-7.2-1.2.1">At the ingress node of the tunnel's home domain, the tunneling
            protocols install tunnel routes in the TRDB associated with the
            Transport Class to which the tunnel belongs.<a href="#section-7.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.2-1.3">
            <p id="section-7.2-1.3.1">The egress node of the tunnel, i.e. the tunnel endpoint (EP),
            originates the BGP CT route with RD:EP in the NLRI, Transport
            Class RT and PNH as EP. This BGP CT route will be resolved over
            the tunnel route in TRDB at the ingress node. When the tunnel is
            up, the Classful Transport BGP route will become usable and get
            re-advertised by the ingress node to BGP peers in neighboring
            domains.<a href="#section-7.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.2-1.4">
            <p id="section-7.2-1.4.1">Alternatively, the ingress node of the tunnel, which is also an
            ASBR/ABR in tunnel's home domain, may originate the BGP CT route
            for the tunnel destination with NLRI RD:EP, attaching a Transport
            Class Route Target that identifies the Transport Class. This BGP
            CT route is advertised to EBGP peers and IBGP peers in neighboring
            domains.<a href="#section-7.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.2-1.5">
            <p id="section-7.2-1.5.1">This originated route SHOULD NOT be advertised to the IBGP core
            that contains the tunnel. This may be implemented by mechanisms
            such as policy configuration. The impact of not prohibiting such
            advertisements is outside the scope of this document.<a href="#section-7.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.2-1.6">
            <p id="section-7.2-1.6.1">Unique RD SHOULD be used by the originator of a Classful
            Transport route to disambiguate the multiple BGP advertisements
            for a transport endpoint. An administrator may use duplicate RDs
            based on local choice, understanding the impact on path diversity
            and troubleshooting, as described in <a href="#rd-lbl-usage" class="auto internal xref">Section 10.2</a>.<a href="#section-7.2-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<div id="CTingress">
<section id="section-7.3">
        <h3 id="name-processing-classful-transpo">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-processing-classful-transpo" class="section-name selfRef">Processing Classful Transport Routes by Ingress Nodes</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.3-1.1">
            <p id="section-7.3-1.1.1">Upon receipt of a BGP CT route with a PNH EP that is not directly
          connected (e.g. an IBGP-route), a Mapping Community (the Transport
          Class RT) on the route is used to decide to which resolution scheme
          this route is to be mapped.<a href="#section-7.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.3-1.2">
            <p id="section-7.3-1.2.1">The resolution scheme for a Transport Class RT with Transport
          Class ID "C1" contains the TRDB of a Transport Class with same ID.
          The administrator MAY customize the resolution scheme for Transport
          Class "C1" to map to a different ordered list of TRDBs. If the
          resolution scheme for TC ID "C1" is not found, the resolution scheme
          containing the "Best Effort" transport class TRDB is used.<a href="#section-7.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.3-1.3">
            <p id="section-7.3-1.3.1">The routes in the TRDBs associated with selected resolution
          scheme are used to resolve the received PNH EP. The order of TRDBs
          in the resolution scheme is followed when resolving the received
          PNH, such that a route in a backup TRDB is used only when a matching
          route was not found for EP in the primary TRDBs preceding it. This
          achieves the fallback desired by the resolution scheme.<a href="#section-7.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.3-1.4">
            <p id="section-7.3-1.4.1">If the resolution process does not find a matching route for EP
          in any of the associated TRDBs, the received BGP CT route MUST be
          considered unresolvable. (See RFC 4271, Section 9.1.2.1).<a href="#section-7.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.3-1.5">
            <p id="section-7.3-1.5.1">The received BGP CT route MUST be added to the TRDB corresponding
          to the Transport Class "C1", if the transport class is provisioned
          locally. This step applies only if the Transport Class RT is
          received on a BGP CT family route. The RD in the BGP CT NLRI prefix
          RD:EP is ignored when the BGP CT route for EP is added to the TRDB,
          so that overlay routes can resolve over this BGP CT tunnel route by
          performing a lookup for EP. Please note that a TRDB is a logical
          database of tunnel routes belonging to the same Transport Class ID,
          hence it uses only the EP as the lookup key without RD or TC-ID.<a href="#section-7.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.3-1.6">
            <p id="section-7.3-1.6.1">If no Mapping Community was found on a BGP CT route, the best
          effort resolution scheme is used for resolving the route's next hop,
          and the BGP CT route is not added to any TRDB.<a href="#section-7.3-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<section id="section-7.4">
        <h3 id="name-readvertising-classful-tran">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-readvertising-classful-tran" class="section-name selfRef">Readvertising Classful Transport Route by Border Nodes</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.4-1.1">
            <p id="section-7.4-1.1.1">This section describes the MPLS label handling when readvertising
          a BGP CT route with Next Hop set to Self. When readvertising a BGP
          CT route with Next Hop set to Self, a BN allocates an MPLS label to
          advertise upstream in Classful Transport NLRI. The BN also installs
          an MPLS route for that label that swaps the incoming label with the
          label received from the downstream BGP speaker (or pops the incoming
          label if the label received from the downstream BGP speaker was
          Implicit-NULL). The MPLS route then pushes received traffic to the
          transport tunnel or direct interface that the Classful Transport
          route's PNH resolved over.<a href="#section-7.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.4-1.2">
            <p id="section-7.4-1.2.1">The label SHOULD be allocated with "per-prefix" label allocation
          semantics. The IP prefix in the TRDB context (Transport-Class,
          IP-prefix) is used as the key to do per-prefix label allocation.
          This helps in avoiding BGP CT route churn throughout the CT network
          when an instability (e.g., link failure) is experienced in a domain.
          The failure is not propagated further than the BN closest to the
          failure. If a different label allocation mode is used, the impact on
          end to end convergence should be considered.<a href="#section-7.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.4-1.3">
            <p id="section-7.4-1.3.1">The value of the advertised MPLS label is locally significant,
          and is dynamic by default. A BN may provide an option to allocate a
          value from a statically provisioned range. This can be achieved
          using locally configured export policy, or via mechanisms such as
          the ones described in <span><a href="#RFC8669" class="internal xref">BGP
          Prefix-SID</a> [<a href="#RFC8669" class="cite xref">RFC8669</a>]</span>.<a href="#section-7.4-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-7.5">
        <h3 id="name-border-nodes-receiving-clas">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-border-nodes-receiving-clas" class="section-name selfRef">Border Nodes Receiving Classful Transport Routes on EBGP</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.5-1.1">
            <p id="section-7.5-1.1.1">If a route is received with a PNH that is known to be directly
          connected (for example, EBGP single-hop neighbor address), the
          directly connected interface is checked for MPLS forwarding
          capability. No other next hop resolution process is performed since
          the inter-AS link can be used for any Transport Class.<a href="#section-7.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.5-1.2">
            <p id="section-7.5-1.2.1">If the inter-AS links need to honor Transport Class, then the BN
          MUST follow procedures of an Ingress node (<a href="#CTingress" class="auto internal xref">Section 7.3</a>) and perform the next hop resolution process.
          In order to make the link Transport Class aware, the route to
          directly connected PNH is installed in the TRDB belonging to the
          associated Transport Class.<a href="#section-7.5-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-7.6">
        <h3 id="name-avoiding-path-hiding-throug">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-avoiding-path-hiding-throug" class="section-name selfRef">Avoiding Path Hiding Through Route Reflectors</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.6-1.1">
            <p id="section-7.6-1.1.1">When multiple instances of a given RD:EP exist with different
          forwarding characteristics, then <span><a href="#RFC7911" class="internal xref">BGP
          ADD-PATH</a> [<a href="#RFC7911" class="cite xref">RFC7911</a>]</span> is helpful.<a href="#section-7.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.6-1.2">
            <p id="section-7.6-1.2.1">When multiple BNs exist such that they advertise a "RD:EP" prefix
          to Route Reflectors (RRs), the RRs may hide all but one of the BNs,
          unless <span><a href="#RFC7911" class="internal xref">BGP ADD-PATH</a> [<a href="#RFC7911" class="cite xref">RFC7911</a>]</span> is used for the
          Classful Transport family. This is similar to L3VPN Option B
          scenarios.<a href="#section-7.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.6-1.3">
            <p id="section-7.6-1.3.1">Hence, <span><a href="#RFC7911" class="internal xref">BGP ADD-PATH</a> [<a href="#RFC7911" class="cite xref">RFC7911</a>]</span> SHOULD be used
          for Classful Transport family, to avoid path-hiding through RRs so
          that the RR sends multiple CT routes for RD:EP to its clients. This
          improves the convergence time when the path via one of the multiple
          BNs fails.<a href="#section-7.6-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-7.7">
        <h3 id="name-avoiding-loops-between-rout">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-avoiding-loops-between-rout" class="section-name selfRef">Avoiding Loops Between Route Reflectors in Forwarding Path</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.7-1.1">
            <p id="section-7.7-1.1.1">A pair of redundant ABRs, each acting as an RR with next hop
          self, may choose each other as best path instead of the upstream
          ASBR, causing a traffic forwarding loop.<a href="#section-7.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.7-1.2">
            <p id="section-7.7-1.2.1">This problem can happen for routes of any BGP address family,
          including BGP CT and BGP LU.<a href="#section-7.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.7-1.3">
            <p id="section-7.7-1.3.1">Using one or more of the approaches described in <span>[<a href="#BGP-FWD-RR" class="cite xref">BGP-FWD-RR</a>]</span> softens the possibility of such loops in a
          network with redundant ABRs.<a href="#section-7.7-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-7.8">
        <h3 id="name-ingress-nodes-receiving-ser">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-ingress-nodes-receiving-ser" class="section-name selfRef">Ingress Nodes Receiving Service Routes with a Mapping Community</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.8-1.1">
            <p id="section-7.8-1.1.1">Upon receipt of a BGP service route (for example, AFI/SAFI: 1/1,
          2/1) with a PNH as EP that is not directly connected (for example,
          an IBGP-route), a Mapping Community (for example, Color Extended
          Community) on the route is used to decide to which resolution scheme
          this route is to be mapped.<a href="#section-7.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.8-1.2">
            <p id="section-7.8-1.2.1">The resolution scheme for a Color Extended Community with Color
          "C1" contains a TRDB for a Transport Class with same ID, followed by
          the Best Effort TRDB. The administrator MAY customize the resolution
          scheme to map to a different ordered list of TRDBs. If the
          resolution scheme for TC ID "C1" is not found, the resolution scheme
          containing the "Best Effort" transport class TRDB is used.<a href="#section-7.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.8-1.3">
            <p id="section-7.8-1.3.1">If no Mapping Community was found on the overlay route, the "Best
          Effort" resolution scheme is used for resolving the route's next
          hop. This behavior is backward compatible to behavior of an
          implementation that does not follow procedures described in this
          document.<a href="#section-7.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.8-1.4">
            <p id="section-7.8-1.4.1">The routes in the TRDBs associated with selected resolution
          scheme are used to resolve the received PNH EP. The order of TRDBs
          in a resolution scheme is followed when resolving the received PNH,
          such that a route in a backup TRDB is used only when a matching
          route was not found for EP in the primary TRDBs preceding it. This
          achieves the fallback desired by the resolution scheme.<a href="#section-7.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.8-1.5">
            <p id="section-7.8-1.5.1">If the resolution process does not find a Tunnel Route for EP in
          any of the Transport Route Databases, the service route MUST be
          considered unresolvable (See RFC 4271, Section 9.1.2.1).<a href="#section-7.8-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.8-2">Note: For an illustration of above procedures in a MPLS network,
        refer to <a href="#CTProc" class="auto internal xref">Section 8</a>.<a href="#section-7.8-2" class="pilcrow">¶</a></p>
</section>
<section id="section-7.9">
        <h3 id="name-best-effort-transport-class">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-best-effort-transport-class" class="section-name selfRef">Best Effort Transport Class</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.9-1.1">
            <p id="section-7.9-1.1.1">It is possible to represent 'Best effort' SLA also as a Transport
          Class. Today, BGP LU is used to extend the best effort intra domain
          tunnels to other domains.<a href="#section-7.9-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.9-1.2">
            <p id="section-7.9-1.2.1">Alternatively, BGP CT may also be used to carry the best effort
          tunnels. This document reserves the Transport Class ID value 0 to
          represent "Best Effort Transport Class ID". However, implementations
          SHOULD provide configuration to use a different value for this
          purpose. Procedures to manage differences in Transport Class ID
          namespaces between domains are provided in <a href="#non-agreeing" class="auto internal xref">Section 11.2.2</a>.<a href="#section-7.9-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.9-1.3">
            <p id="section-7.9-1.3.1">The "Best Effort Transport Class ID" value is used in the
          "Transport Class ID" field of Transport Route Target Extended
          Community that is attached to the BGP CT route that advertises a
          best effort tunnel endpoint. The RT thus formed is called the "Best
          Effort Transport Class Route Target".<a href="#section-7.9-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.9-1.4">
            <p id="section-7.9-1.4.1">When a BN or SN receives a BGP CT route with Best Effort
          Transport Class Route Target as the mapping community, the Best
          effort resolution scheme is used for resolving the BGP next hop, and
          the resultant route is installed in the best effort transport route
          database. If no best effort tunnel was found to resolve the BGP next
          hop, the BGP CT route MUST be considered unusable, and not be
          propagated further.<a href="#section-7.9-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.9-1.5">
            <p id="section-7.9-1.5.1">When a BGP speaker receives an overlay route without any explicit
          Mapping Community, and absent local policy, the best effort
          resolution scheme is used for resolving the BGP next hop on the
          route. This behavior is backward compatible to behavior of an
          implementation that does not follow procedures described in this
          document.<a href="#section-7.9-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.9-1.6">
            <p id="section-7.9-1.6.1">Implementations MAY provide configuration to selectively install
          BGP CT routes to the Forwarding Information Base (FIB), to provide
          reachability for control plane peering towards endpoints in other
          domains.<a href="#section-7.9-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-7.10">
        <h3 id="name-interaction-with-bgp-attrib">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-interaction-with-bgp-attrib" class="section-name selfRef">Interaction with BGP Attributes Specifying Next Hop Address and Color</a>
        </h3>
<p id="section-7.10-1">The Tunnel Encapsulation Attribute, described in <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span> can be used to request a specific type of tunnel
        encapsulation. This attribute may apply to BGP service routes or
        transport routes, including BGP Classful Transport family routes.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
<p id="section-7.10-2">It should be noted that in such cases "Transport Class ID/Color"
        can exist in multiple places on the same route, and a precedence order
        needs to be established to determine which Transport Class the route's
        next hop should resolve over. This document specifies the following
        order of precedence, more specific scoping of Color preferred to less
        specific scoping:<a href="#section-7.10-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-7.10-3.1">
            <p id="section-7.10-3.1.1">Color SubTLV, in Tunnel Encapsulation Attribute.<a href="#section-7.10-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.10-3.2">
            <p id="section-7.10-3.2.1">Transport Target Extended community, on BGP CT route.<a href="#section-7.10-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-7.10-3.3">
            <p id="section-7.10-3.3.1">Color Extended community, on BGP service route.<a href="#section-7.10-3.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.10-4">Color specified in the Color subTLV in a TEA is a more specific
        indication of "Transport Class ID/Color" than Mapping Community
        (Transport Target) on a BGP CT transport route, which is in turn is
        more specific than a Service route scoped Mapping Community (Color
        Extended community).<a href="#section-7.10-4" class="pilcrow">¶</a></p>
<p id="section-7.10-5">Any BGP attributes or mechanisms defined in future that carry
        Transport Class ID/Color on the route are expected to specify the
        order of precedence relative to the above.<a href="#section-7.10-5" class="pilcrow">¶</a></p>
</section>
<section id="section-7.11">
        <h3 id="name-applicability-to-flowspec-r">
<a href="#section-7.11" class="section-number selfRef">7.11. </a><a href="#name-applicability-to-flowspec-r" class="section-name selfRef">Applicability to Flowspec Redirect to IP</a>
        </h3>
<p id="section-7.11-1">Flowspec routes using Redirect to IP next hop is described in <span>[<a href="#FLOWSPEC-REDIR-IP" class="cite xref">FLOWSPEC-REDIR-IP</a>]</span><a href="#section-7.11-1" class="pilcrow">¶</a></p>
<p id="section-7.11-2">Such Flowspec BGP routes with Redirect to IP next hop MAY be
        attached with a Mapping Community (e.g. Color:0:100), which allows
        redirecting the flow traffic over a tunnel to the IP next hop
        satisfying the desired SLA (e.g. Transport Class color 100).<a href="#section-7.11-2" class="pilcrow">¶</a></p>
<p id="section-7.11-3">Flowspec BGP family acts as just another service that can make use
        of BGP CT architecture to achieve Flow based forwarding with SLAs.<a href="#section-7.11-3" class="pilcrow">¶</a></p>
</section>
<div id="IPv6-Applicability">
<section id="section-7.12">
        <h3 id="name-applicability-to-ipv6">
<a href="#section-7.12" class="section-number selfRef">7.12. </a><a href="#name-applicability-to-ipv6" class="section-name selfRef">Applicability to IPv6</a>
        </h3>
<p id="section-7.12-1">BGP CT procedures apply equally to IPv4 and IPv6 enabled Intra-AS
        or Inter-AS Option A, B, C network. This section describes
        applicability of BGP CT to IPv6 at various layers.<a href="#section-7.12-1" class="pilcrow">¶</a></p>
<p id="section-7.12-2">A BGP CT enabled network supports IPv6 service families (for
        example, AFI/SAFI 2/1 or 2/128) and IPv6 transport signaling protocols
        like SRTEv6, LDPv6, RSVP-TEv6.<a href="#section-7.12-2" class="pilcrow">¶</a></p>
<p id="section-7.12-3">Procedures in this document also apply to a network with Pure IPv6
        core, that uses MPLS forwarding for intra-domain tunnels and inter-AS
        links. BGP CTv6 family (AFI/SAFI: 2/76) is used to carry global IPv6
        address tunnel endpoints in the NLRI. Service family routes (for
        example, AFI/SAFI: 1/1, 2/1, 1/128, 2/128) are also advertised with
        those Global IPv6 addresses as next hop.<a href="#section-7.12-3" class="pilcrow">¶</a></p>
<p id="section-7.12-4">Procedures in this document also apply to a 6PE network with an
        IPv4 core, that uses MPLS forwarding for intra-domain tunnels and
        Inter-AS links. BGP CTv6 family (AFI/SAFI: 2/76) is used to carry IPv4
        Mapped IPv6 address tunnel endpoints in the NLRI. IPv6 Service family
        routes (for example, AFI/SAFI: 2/1, 2/128) are also advertised with
        those IPv4 Mapped IPv6 addresses as next hop.<a href="#section-7.12-4" class="pilcrow">¶</a></p>
<p id="section-7.12-5">The PE-CE attachment circuits may use IPv4 addresses only, IPv6
        addresses only, or both IPv4 and IPv6 addresses.<a href="#section-7.12-5" class="pilcrow">¶</a></p>
<p id="section-7.12-6"></p>
</section>
</div>
<div id="SRv6-Support">
<section id="section-7.13">
        <h3 id="name-srv6-support">
<a href="#section-7.13" class="section-number selfRef">7.13. </a><a href="#name-srv6-support" class="section-name selfRef">SRv6 Support</a>
        </h3>
<p id="section-7.13-1">BGP CT family (AFI/SAFI 2/76) may be used to set up inter-domain
        tunnels of a certain Transport Class, when using Segment Routing over
        IPv6 (SRv6) data plane on the inter-AS links or as an intra-AS
        tunneling mechanism.<a href="#section-7.13-1" class="pilcrow">¶</a></p>
<p id="section-7.13-2">Details of SRv6 Endpoint behaviors used by BGP CT and the
        procedures are specified in a separate document <span>[<a href="#BGP-CT-SRv6" class="cite xref">BGP-CT-SRv6</a>]</span>, along with illustration. As noted in that
        document, BGP CT route update for SRv6 includes a BGP attribute
        containing SRv6 SID information (e.g. Prefix SID [RFC9252]) with
        Transposition scheme disabled.<a href="#section-7.13-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-handling">
<section id="section-7.14">
        <h3 id="name-error-handling-consideratio">
<a href="#section-7.14" class="section-number selfRef">7.14. </a><a href="#name-error-handling-consideratio" class="section-name selfRef">Error Handling Considerations</a>
        </h3>
<p id="section-7.14-1">If a BGP speaker receives both <span><a href="#tc-rt-t" class="internal xref">Transitive</a> (<a href="#tc-rt-t" class="auto internal xref">Section 13.2.1.1.1</a>)</span> and <span><a href="#tc-rt-nt" class="internal xref">Non-Transitive</a> (<a href="#tc-rt-nt" class="auto internal xref">Section 13.2.1.1.2</a>)</span> versions of Transport Class
        extended community on a route, only the Transitive one is used.<a href="#section-7.14-1" class="pilcrow">¶</a></p>
<p id="section-7.14-2">If a BGP speaker considers a received "Transport Class" extended
        community (Transitive or Non-Transitive version), or any other part of
        a BGP CT route invalid for some reason, but is able to successfully
        parse the NLRI and attributes, Treat-as-withdraw approach from <span>[<a href="#RFC7606" class="cite xref">RFC7606</a>]</span> is used. The route is kept as Unusable, with
        appropriate diagnostic information, to aid troubleshooting.<a href="#section-7.14-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="CTProc">
<section id="section-8">
      <h2 id="name-illustration-of-bgp-ct-proc">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-illustration-of-bgp-ct-proc" class="section-name selfRef">Illustration of BGP CT Procedures</a>
      </h2>
<p id="section-8-1">This section illustrates BGP CT procedures in an Inter AS Option C
      MPLS network.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">All Illustrations in this document make use of <span>[<a href="#RFC6890" class="cite xref">RFC6890</a>]</span> IP address ranges. The range 192.0.2.0/24 is used to
      represent transport endpoints like loopback addresses. The range
      203.0.113.0/24 is used to represent service route prefixes advertised in
      AFI/SAFIs: 1/1 or 1/128.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Though this section illustrates using IPv4, as described in <a href="#IPv6-Applicability" class="auto internal xref">Section 7.12</a> these procedures work equally for IPv6
      as-well.<a href="#section-8-3" class="pilcrow">¶</a></p>
<section id="section-8.1">
        <h3 id="name-reference-topology">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-reference-topology" class="section-name selfRef">Reference Topology</a>
        </h3>
<span id="name-multi-domain-bgp-ct-network"></span><div id="CTProcTopo">
<figure id="figure-3">
          <div id="section-8.1-1.1">
            <div class="alignLeft art-svg artwork" id="section-8.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="584" viewBox="0 0 584 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 56,224 L 56,256" fill="none" stroke="black"></path>
                <path d="M 128,48 L 128,96" fill="none" stroke="black"></path>
                <path d="M 144,80 L 144,96" fill="none" stroke="black"></path>
                <path d="M 144,128 L 144,176" fill="none" stroke="black"></path>
                <path d="M 192,224 L 192,256" fill="none" stroke="black"></path>
                <path d="M 240,80 L 240,96" fill="none" stroke="black"></path>
                <path d="M 240,128 L 240,176" fill="none" stroke="black"></path>
                <path d="M 256,48 L 256,96" fill="none" stroke="black"></path>
                <path d="M 272,80 L 272,96" fill="none" stroke="black"></path>
                <path d="M 272,128 L 272,176" fill="none" stroke="black"></path>
                <path d="M 352,224 L 352,256" fill="none" stroke="black"></path>
                <path d="M 448,80 L 448,96" fill="none" stroke="black"></path>
                <path d="M 448,128 L 448,176" fill="none" stroke="black"></path>
                <path d="M 464,48 L 464,96" fill="none" stroke="black"></path>
                <path d="M 480,80 L 480,96" fill="none" stroke="black"></path>
                <path d="M 480,128 L 480,176" fill="none" stroke="black"></path>
                <path d="M 528,224 L 528,256" fill="none" stroke="black"></path>
                <path d="M 568,80 L 568,96" fill="none" stroke="black"></path>
                <path d="M 568,128 L 568,176" fill="none" stroke="black"></path>
                <path d="M 144,80 L 160,80" fill="none" stroke="black"></path>
                <path d="M 224,80 L 240,80" fill="none" stroke="black"></path>
                <path d="M 272,80 L 288,80" fill="none" stroke="black"></path>
                <path d="M 432,80 L 448,80" fill="none" stroke="black"></path>
                <path d="M 480,80 L 496,80" fill="none" stroke="black"></path>
                <path d="M 552,80 L 568,80" fill="none" stroke="black"></path>
                <path d="M 144,176 L 160,176" fill="none" stroke="black"></path>
                <path d="M 224,176 L 240,176" fill="none" stroke="black"></path>
                <path d="M 272,176 L 288,176" fill="none" stroke="black"></path>
                <path d="M 432,176 L 448,176" fill="none" stroke="black"></path>
                <path d="M 480,176 L 496,176" fill="none" stroke="black"></path>
                <path d="M 552,176 L 568,176" fill="none" stroke="black"></path>
                <path d="M 120,288 L 192,288" fill="none" stroke="black"></path>
                <path d="M 352,288 L 448,288" fill="none" stroke="black"></path>
                <path d="M 344,96 L 376,160" fill="none" stroke="black"></path>
                <path d="M 336,160 L 368,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="456,288 444,282.4 444,293.6" fill="black" transform="rotate(0,448,288)"></polygon>
                <g class="text">
                  <text x="132" y="36">[RR26]</text>
                  <text x="260" y="36">[RR27]</text>
                  <text x="468" y="36">[RR16]</text>
                  <text x="192" y="84">[ABR23]</text>
                  <text x="360" y="84">[ASBR21]-[ASBR13]</text>
                  <text x="524" y="84">[PE11]</text>
                  <text x="80" y="116">[CE41]-[PE25]-[P28]</text>
                  <text x="256" y="116">[P29]</text>
                  <text x="464" y="116">[P15]</text>
                  <text x="556" y="116">[CE31]</text>
                  <text x="192" y="180">[ABR24]</text>
                  <text x="360" y="180">[ASBR22]-[ASBR14]</text>
                  <text x="524" y="180">[PE12]</text>
                  <text x="120" y="228">AS2</text>
                  <text x="280" y="228">AS2</text>
                  <text x="32" y="244">AS4</text>
                  <text x="124" y="244">region-1</text>
                  <text x="276" y="244">region-2</text>
                  <text x="424" y="244">AS1</text>
                  <text x="568" y="244">AS3</text>
                  <text x="52" y="292">203.0.113.41</text>
                  <text x="232" y="292">Traffic</text>
                  <text x="304" y="292">Direction</text>
                  <text x="516" y="292">203.0.113.31</text>
                </g>
              </svg><a href="#section-8.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-multi-domain-bgp-ct-network" class="selfRef">Multi-Domain BGP CT Network</a>
          </figcaption></figure>
</div>
<p id="section-8.1-2">This example shows a provider MPLS network that consists of two
        ASes, AS1 and AS2. They are serving customers AS3, AS4 respectively.
        Traffic direction being described is CE41 to CE31. CE31 may request a
        specific SLA (for example, mapped to Gold for this example), when
        traversing these provider networks.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">AS2 is further divided into two regions. There are three tunnel
        domains in provider's space: AS1 uses <span><a href="#RFC9350" class="internal xref">ISIS
        Flex-Algo</a> [<a href="#RFC9350" class="cite xref">RFC9350</a>]</span> intra-domain tunnels. AS2 uses RSVP-TE intra-domain
        tunnels. MPLS forwarding is used within these domains and on
        inter-domain links.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">The network exposes two Transport Classes: "Gold" with Transport
        Class ID 100, "Bronze" with Transport Class ID 200. These Transport
        Classes are provisioned at the PEs and the Border nodes (ABRs, ASBRs)
        in the network.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">The following tunnels exist for Gold Transport Class.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-6.1">
            <p id="section-8.1-6.1.1">PE25_to_ABR23_gold - RSVP-TE tunnel<a href="#section-8.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-6.2">
            <p id="section-8.1-6.2.1">PE25_to_ABR24_gold - RSVP-TE tunnel<a href="#section-8.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-6.3">
            <p id="section-8.1-6.3.1">ABR23_to_ASBR22_gold - RSVP-TE tunnel<a href="#section-8.1-6.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-6.4">
            <p id="section-8.1-6.4.1">ASBR13_to_PE11_gold - SRTE tunnel<a href="#section-8.1-6.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-6.5">
            <p id="section-8.1-6.5.1">ASBR14_to_PE11_gold - SRTE tunnel<a href="#section-8.1-6.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-7">The following tunnels exist for Bronze Transport Class.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-8.1-8.1">
            <p id="section-8.1-8.1.1">PE25_to_ABR23_bronze - RSVP-TE tunnel<a href="#section-8.1-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-8.2">
            <p id="section-8.1-8.2.1">ABR23_to_ASBR21_bronze - RSVP-TE tunnel<a href="#section-8.1-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-8.3">
            <p id="section-8.1-8.3.1">ABR23_to_ASBR22_bronze - RSVP-TE tunnel<a href="#section-8.1-8.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-8.4">
            <p id="section-8.1-8.4.1">ABR24_to_ASBR21_bronze - RSVP-TE tunnel<a href="#section-8.1-8.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-8.5">
            <p id="section-8.1-8.5.1">ASBR13_to_PE12_bronze - ISIS FlexAlgo tunnel<a href="#section-8.1-8.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-8.1-8.6">
            <p id="section-8.1-8.6.1">ASBR14_to_PE11_bronze - ISIS FlexAlgo tunnel<a href="#section-8.1-8.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-9">These tunnels are either provisioned or auto-discovered to belong
        to Transport Classes 100 or 200.<a href="#section-8.1-9" class="pilcrow">¶</a></p>
</section>
<section id="section-8.2">
        <h3 id="name-service-layer-route-exchang">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-service-layer-route-exchang" class="section-name selfRef">Service Layer Route Exchange</a>
        </h3>
<p id="section-8.2-1">Service nodes PE11, PE12 negotiate service families (AFI: 1 and
        SAFIs 1, 128) on the BGP session with RR16. Service helpers RR16 and
        RR26 exchange these service routes with next hop unchanged over a
        multihop EBGP session between the two AS. PE25 negotiates service
        families (AFI: 1 and SAFIs 1, 128) with RR26.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The PEs see each other as next hop in the BGP Update for the
        service family routes. BGP ADD-PATH send and receive is enabled on
        both directions on the EBGP multihop session between RR16 and RR26 for
        AFI:1 and SAFIs 1, 128. BGP ADD-PATH send is negotiated in the RR to
        PE direction in each AS. This is to avoid path hiding of service
        routes at RR; i.e., AFI/SAFI 1/1 routes advertised by both PE11 and
        PE12. Or, AFI/SAFI 1/128 routes originated by both PE11 and PE12 using
        same RD.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Forwarding happens using service routes installed at service nodes
        PE25, PE11, PE12 only. Service routes received from CEs are not
        present in any other nodes' FIB in the network.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">As an example, CE31 advertises a route for prefix 203.0.113.31 with
        next hop as self to PE11, PE12. CE31 can attach a Mapping Community
        Color:0:100 on this route, to indicate its request for Gold SLA. Or,
        PE11 can attach the same using locally configured policies.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">Consider, CE31 is getting VPN service from PE11. The
        RD1:203.0.113.31 route is readvertised in AFI/SAFI 1/128 by PE11 with
        next hop self (192.0.2.11) and label V-L1, to RR16 with the Mapping
        Community Color:0:100 attached. RR16 advertises this route with BGP
        ADD-PATH ID to RR26 which readvertises to PE25 with next hop
        unchanged. Now, PE25 can resolve the PNH 192.0.2.11 using transport
        routes received in BGP CT or BGP LU.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">Using BGP ADD-PATH, service routes advertised by PE11 and PE12 for
        AFI:1 SAFIs 1, 128 reach PE25 via RR16, RR26 with the next hop
        unchanged, as PE11 or PE12.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
<p id="section-8.2-7">The IP FIB at PE25 VRF will have a route for 203.0.113.31 with a
        next hop when resolved, that points to a Gold tunnel in ingress
        domain.<a href="#section-8.2-7" class="pilcrow">¶</a></p>
</section>
<section id="section-8.3">
        <h3 id="name-transport-layer-route-propa">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-transport-layer-route-propa" class="section-name selfRef">Transport Layer Route Propagation</a>
        </h3>
<p id="section-8.3-1">Egress nodes PE11, PE12 negotiate BGP CT family with transport
        ASBRs ASBR13, ASBR14. These egress nodes originate BGP CT routes for
        tunnel endpoint addresses, that are advertised as next hop in BGP
        service routes. In this example, both PEs participate in transport
        classes Gold and Bronze. The protocol procedures are explained using
        the Gold SLA transport plane and the Bronze SLA transport plane is
        used to highlight the path hiding aspects.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">PE11 is provisioned with transport class 100, RD value
        192.0.2.11:100 and a transport-target:0:100 for Gold tunnels. And a
        Transport class 200 with RD value 192.0.2.11:200, and transport route
        target 0:200 for Bronze tunnels. Similarly, PE12 is provisioned with
        transport class 100, RD value 192.0.2.12:100 and a
        transport-target:0:100 for Gold tunnels. And transport class 200, RD
        value 192.0.2.12:200 with transport-target:0:200 for Bronze tunnels.
        Note that in this example, the BGP CT routes carry only the transport
        class route target, and no IP address format route target.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">The RD value originated by an egress node is not modified by any
        BGP speakers when the route is readvertised to the ingress node. Thus,
        the RD can be used to identify the originator (unique RD provisioned)
        or set of originators (RD reused on multiple nodes).<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">Similarly, these transport classes are also configured on ASBRs,
        ABRs and PEs with same Transport Route Target and unique RDs.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">ASBR13 and ASBR14 negotiate BGP CT family with transport ASBRs
        ASBR21, ASBR22 in neighboring AS. ASBR21, ASBR22 negotiate BGP CT
        family with RR27 in region 2, which reflects BGP CT routes to ABR23,
        ABR24. ABR23, ABR24 negotiate BGP CT family with Ingress node PE25 in
        region 1. BGP LU family is also negotiated on these sessions alongside
        BGP CT family. BGP LU carries "best effort" transport class routes,
        BGP CT carries Gold, Bronze transport class routes.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<p id="section-8.3-6">PE11 is provisioned to originate a BGP CT route for endpoint PE11,
        with Gold SLA. This route is sent with NLRI RD prefix
        192.0.2.11:100:192.0.2.11, Label B-L0, next hop 192.0.2.11 and a route
        target extended community transport-target:0:100. Label B-L0 can
        either be Implicit Null (Label 3) or an Ultimate Hop Pop (UHP)
        label.<a href="#section-8.3-6" class="pilcrow">¶</a></p>
<p id="section-8.3-7">This route is received by ASBR13 and it resolves over the tunnel
        ASBR13_to_PE11_gold. The route is then readvertised by ASBR13 in BGP
        CT family to ASBRs ASBR21, ASBR22 according to export policy. This
        route is sent with same NLRI RD prefix 192.0.2.11:100:192.0.2.11,
        Label B-L1, next hop self, and transport-target:0:100. MPLS swap route
        is installed at ASBR13 for B-L1 with a next hop pointing to
        ASBR13_to_PE11_gold tunnel.<a href="#section-8.3-7" class="pilcrow">¶</a></p>
<p id="section-8.3-8">Similarly, ASBR14 also receives a BGP CT route for
        192.0.2.11:100:192.0.2.11 from PE11 and it resolves over the tunnel
        ASBR14_to_PE11_gold. The route is then readvertised by ASBR14 in BGP
        CT family to ASBRs ASBR21, ASBR22 according to export policy. This
        route is sent with the same NLRI RD prefix 192.0.2.11:100:192.0.2.11,
        Label B-L2, next hop self, and transport-target:0:100. MPLS swap route
        is installed at ASBR14 for B-L1 with a next hop pointing to
        ASBR14_to_PE11_gold tunnel.<a href="#section-8.3-8" class="pilcrow">¶</a></p>
<p id="section-8.3-9">In the Bronze plane, BGP CT route with Bronze SLA to endpoint PE11
        is originated by PE11 with a NLRI containing RD prefix
        192.0.2.11:200:192.0.2.11, and appropriate label. The use of distinct
        RDs for Gold and Bronze allows both Gold and Bronze advertisements to
        traverse path selection pinchpoints without any path hiding at RRs or
        ASBRs. And route target extended community transport-target:0:200 lets
        the route resolve over Bronze tunnels in the network, similar to the
        process being described for Gold SLA path.<a href="#section-8.3-9" class="pilcrow">¶</a></p>
<p id="section-8.3-10">Moving back to the Gold plane, ASBR21 receives the Gold SLA BGP CT
        routes for NLRI RD prefix 192.0.2.11:100:192.0.2.11 over the single
        hop EBGP sessions from ASBR13, ASBR14, and can compute ECMP/FRR
        towards them. ASBR21 readvertises BGP CT route for
        192.0.2.11:100:192.0.2.11 with next hop self (loopback address
        192.0.2.21) to RR27, advertising a new label B-L3. An MPLS swap route
        is installed for label B-L3 at ASBR21 to swap to received label B-L1,
        B-L2 and forward to ASBR13, ASBR14 respectively, this is an ECMP
        route. RR27 readvertises this BGP CT route to ABR23, ABR24 with label
        and next hop unchanged.<a href="#section-8.3-10" class="pilcrow">¶</a></p>
<p id="section-8.3-11">Similarly, ASBR22 receives BGP CT route 192.0.2.11:100:192.0.2.11
        over the single hop EBGP sessions from ASBR13, ASBR14, and
        readvertises with next hop self (loopback address 192.0.2.22) to RR27,
        advertising a new label B-L4. An MPLS swap route is installed for
        label B-L4 at ASBR22 to swap to received label B-L1, B-L2 and forward
        to ASBR13, ASBR14 respectively. RR27 readvertises this BGP CT route
        also to ABR23, ABR24 with label and next hop unchanged.<a href="#section-8.3-11" class="pilcrow">¶</a></p>
<p id="section-8.3-12">BGP ADD-PATH is enabled for BGP CT family on the sessions between
        RR27 and ASBRs, ABRs such that routes for 192.0.2.11:100:192.0.2.11
        with the next hops ASBR21 and ASBR22 are reflected to ABR23, ABR24
        without any path hiding. Thus, ABR23 is given visibility of both
        available next hops for Gold SLA.<a href="#section-8.3-12" class="pilcrow">¶</a></p>
<p id="section-8.3-13">ABR23 receives the route with next hop 192.0.2.21, label B-L3 from
        RR27. The route target "transport-target:0:100" on this route acts as
        Mapping Community, and instructs ABR23 to strictly resolve the next
        hop using transport class 100 routes only. ABR23 is unable to find a
        route for 192.0.2.21 with transport class 100. Thus, it considers this
        route unusable and does not propagate it further. This prunes ASBR21
        from Gold SLA tunneled path.<a href="#section-8.3-13" class="pilcrow">¶</a></p>
<p id="section-8.3-14">ABR23 also receives the route with next hop 192.0.2.22, label B-L4
        from RR27. The route target "transport-target:0:100" on this route
        acts as Mapping Community, and instructs ABR23 to strictly resolve the
        next hop using transport class 100 routes only. ABR23 successfully
        resolves the next hop to point to ABR23_to_ASBR22_gold tunnel. ABR23
        readvertises this BGP CT route with next hop self (loopback address
        192.0.2.23) and a new label B-L5 to PE25. Swap route for B-L5 is
        installed by ABR23 to swap to label B-L4, and forward into
        ABR23_to_ASBR22_gold tunnel.<a href="#section-8.3-14" class="pilcrow">¶</a></p>
<p id="section-8.3-15">PE25 receives the BGP CT route for prefix 192.0.2.11:100:192.0.2.11
        with label B-L5, next hop 192.0.2.23 and transport-target:0:100 from
        RR26. And it similarly resolves the next hop 192.0.2.23 over transport
        class 100, pushing labels associated with PE25_to_ABR23_gold
        tunnel.<a href="#section-8.3-15" class="pilcrow">¶</a></p>
<p id="section-8.3-16">In this manner, the Gold transport LSP "ASBR13_to_PE11_gold" in the
        egress domain is extended by BGP CT until the ingress node PE25 in the
        ingress domain, to create an end-to-end Gold SLA path. MPLS swap
        routes are installed at ASBR13, ASBR22 and ABR23, when propagating the
        PE11 BGP CT Gold transport class route 192.0.2.11:100:192.0.2.11 with
        next hop self towards PE25.<a href="#section-8.3-16" class="pilcrow">¶</a></p>
<p id="section-8.3-17">The BGP CT LSP thus formed, originates in PE25, and terminates in
        ASBR13 (assuming PE11 advertised Implicit Null), traversing over the
        Gold underlay LSPs in each domain. ASBR13 uses UHP to stitch the BGP
        CT LSP into the "ASBR13_to_PE11_gold" LSP to traverse the last domain,
        thus satisfying Gold SLA end-to-end.<a href="#section-8.3-17" class="pilcrow">¶</a></p>
<p id="section-8.3-18">When PE25 receives service routes from RR26 with next hop
        192.0.2.11 and mapping community Color:0:100, it resolves over this
        BGP CT route 192.0.2.11:100:192.0.2.11. Thus, pushing label B-L5, and
        pushing as top label the labels associated with PE25_to_ABR23_gold
        tunnel.<a href="#section-8.3-18" class="pilcrow">¶</a></p>
</section>
<section id="section-8.4">
        <h3 id="name-data-plane-view">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-data-plane-view" class="section-name selfRef">Data Plane View</a>
        </h3>
<section id="section-8.4.1">
          <h4 id="name-steady-state">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-steady-state" class="section-name selfRef">Steady State</a>
          </h4>
<p id="section-8.4.1-1">This section describes how the data plane looks in steady
          state.<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<p id="section-8.4.1-2">CE41 transmits an IP packet with destination as 203.0.113.31. On
          receiving this packet, PE25 performs a lookup in the IP FIB
          associated with the CE41 interface. This lookup yields the service
          route that pushes the VPN service label V-L1, BGP CT label B-L5, and
          labels for PE25_to_ABR23_gold tunnel. Thus, PE25 encapsulates the IP
          packet in an MPLS packet with label V-L1 (innermost), B-L5, and top
          label as PE25_to_ABR23_gold tunnel. This MPLS packet is thus
          transmitted to ABR23 using Gold SLA.<a href="#section-8.4.1-2" class="pilcrow">¶</a></p>
<p id="section-8.4.1-3">ABR23 decapsulates the packet received on PE25_to_ABR23_gold
          tunnel as required, and finds the MPLS packet with label B-L5. It
          performs a lookup for label B-L5 in the global MPLS FIB. This yields
          the route that swaps label B-L5 with label B-L4, and pushes the top
          label provided by ABR23_to_ASBR22_gold tunnel. Thus, ABR23 transmits
          the MPLS packet with label B-L4 to ASBR22, on a tunnel that
          satisfies Gold SLA.<a href="#section-8.4.1-3" class="pilcrow">¶</a></p>
<p id="section-8.4.1-4">ASBR22 similarly performs a lookup for label B-L4 in global MPLS
          FIB, finds the route that swaps label B-L4 with label B-L2, and
          forwards to ASBR13 over the directly connected MPLS-enabled
          interface. This interface is a common resource not dedicated to any
          specific transport class, in this example.<a href="#section-8.4.1-4" class="pilcrow">¶</a></p>
<p id="section-8.4.1-5">ASBR13 receives the MPLS packet with label B-L2, and performs a
          lookup in MPLS FIB, finds the route that pops label B-L2, and pushes
          labels associated with ASBR13_to_PE11_gold tunnel. This transmits
          the MPLS packet with VPN label V-L1 to PE11 using a tunnel that
          preserves Gold SLA in AS 1.<a href="#section-8.4.1-5" class="pilcrow">¶</a></p>
<p id="section-8.4.1-6">PE11 receives the MPLS packet with V-L1, and performs VPN
          forwarding. Thus transmitting the original IP payload from CE41 to
          CE31. The payload has traversed path satisfying Gold SLA
          end-to-end.<a href="#section-8.4.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-8.4.2">
          <h4 id="name-local-repair-of-primary-pat">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-local-repair-of-primary-pat" class="section-name selfRef">Local Repair of Primary Path</a>
          </h4>
<p id="section-8.4.2-1">This section describes how the data plane at ASBR22 reacts when
          the link between ASBR22 and ASBR13 experiences a failure, and an
          alternate path exists.<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<p id="section-8.4.2-2">Assuming ASBR22_to_ASBR13 link goes down, such that traffic with
          Gold SLA going to PE11 needs repair. ASBR22 has an alternate BGP CT
          route for 192.0.2.11:100:192.0.2.11 from ASBR14. This has been
          preprogrammed in forwarding by ASBR22 as FRR backup next hop for
          label B-L4. This allows the Gold SLA traffic to be locally repaired
          at ASBR22 without the failure event propagated in the BGP CT
          network. In this case, ingress node PE25 will not know there was a
          failure, and traffic restoration will be independent of prefix scale
          (PIC).<a href="#section-8.4.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-8.4.3">
          <h4 id="name-absorbing-failure-of-primar">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-absorbing-failure-of-primar" class="section-name selfRef">Absorbing Failure of Primary Path: Fallback to Best Effort Tunnels</a>
          </h4>
<p id="section-8.4.3-1">This section describes how the data plane reacts when a Gold path
          experiences a failure, but no alternate path exists.<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<p id="section-8.4.3-2">Assume tunnel ABR23_to_ASBR22_gold goes down, such that now no
          end-to-end Gold path exists in the network. This makes the BGP CT
          route for RD prefix 192.0.2.11:100:192.0.2.11 is unusable at ABR23.
          This makes ABR23 send a BGP withdrawal for 192.0.2.11:100:192.0.2.11
          to PE25.<a href="#section-8.4.3-2" class="pilcrow">¶</a></p>
<p id="section-8.4.3-3">The withdrawal for 192.0.2.11:100:192.0.2.11 allows PE25 to react
          to the loss of the Gold path to 192.0.2.11. Assuming PE25 is
          provisioned to use best effort transport class as the backup path,
          this withdrawal of BGP CT route allows PE25 to adjust the next hop
          of the VPN Service-route to push the labels provided by the BGP LU
          route. That repairs the traffic to go via the best effort path. PE25
          can also be provisioned to use Bronze transport class as the backup
          path. The repair will happen in similar manner in that case
          as-well.<a href="#section-8.4.3-3" class="pilcrow">¶</a></p>
<p id="section-8.4.3-4">Traffic repair to absorb the failure happens at ingress node
          PE25, in a service prefix scale independent manner. This is called
          PIC (Prefix scale Independent Convergence). The repair time will be
          proportional to time taken for withdrawing the BGP CT route.<a href="#section-8.4.3-4" class="pilcrow">¶</a></p>
<p id="section-8.4.3-5">These examples demonstrate the various levels of failsafe
          mechanisms available to protect traffic in a BGP CT network.<a href="#section-8.4.3-5" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<section id="section-9">
      <h2 id="name-scaling-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-scaling-considerations" class="section-name selfRef">Scaling Considerations</a>
      </h2>
<div id="secure-propagate">
<section id="section-9.1">
        <h3 id="name-avoiding-unintended-spread-">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-avoiding-unintended-spread-" class="section-name selfRef">Avoiding Unintended Spread of BGP CT Routes Across Domains</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.1-1.1">
            <p id="section-9.1-1.1.1"><span>[<a href="#RFC8212" class="cite xref">RFC8212</a>]</span> suggests BGP speakers require explicit
          configuration of both BGP Import and Export Policies in order to
          receive or send routes over EBGP sessions.<a href="#section-9.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.1-1.2">
            <p id="section-9.1-1.2.1">It is recommended to follow this for BGP CT routes. It will
          prohibit unintended advertisement of transport routes throughout the
          BGP CT transport domain, which may span across multiple AS domains.
          This will conserve usage of MPLS label and next hop resources in the
          network. An ASBR of a domain can be provisioned to allow routes with
          only the Transport Route Targets that are required by SNs in the
          domain.<a href="#section-9.1-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<section id="section-9.2">
        <h3 id="name-constrained-distribution-of">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-constrained-distribution-of" class="section-name selfRef">Constrained Distribution of PNHs to SNs (On-Demand Next Hop)</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.2-1.1">
            <p id="section-9.2-1.1.1">This section describes how the number of Protocol Next hops
          advertised to a SN or BN can be constrained using BGP Classful
          Transport and <span><a href="#RFC4684" class="internal xref">Route Target Constrain
          (RTC)</a> [<a href="#RFC4684" class="cite xref">RFC4684</a>]</span>.<a href="#section-9.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.2">
            <p id="section-9.2-1.2.1">An egress SN MAY advertise a BGP CT route for RD:eSN with two
          Route Targets: transport-target:0:&lt;TC&gt; and a RT carrying
          &lt;eSN&gt;:&lt;TC&gt;, where TC is the Transport Class identifier,
          and eSN is the IP address used by SN as BGP next hop in its service
          route advertisements.<a href="#section-9.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.3">
            <p id="section-9.2-1.3.1">Note that such use of the IP address specific route target
          &lt;eSN&gt;:&lt;TC&gt; is optional in a BGP CT network. It is
          required only if there is a requirement to prune the propagation of
          the transport route for an egress node eSN to only the set of
          ingress nodes that need it. When only RT of
          transport-target:0:&lt;TC&gt; is used, the pruning happens in
          granularity of Transport Class ID (Color), and not BGP next hop; a
          BGP CT route will only be advertised into a domain with at least one
          PE that imports its transport class.<a href="#section-9.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.4">
            <p id="section-9.2-1.4.1">The transport-target:0:&lt;TC&gt; is the new type of route target
          (Transport Class RT) defined in this document. It is carried in BGP
          extended community attribute (BGP attribute code 16).<a href="#section-9.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.5">
            <p id="section-9.2-1.5.1">The RT carrying &lt;eSN&gt;:&lt;TC&gt; MAY be an IP-address
          specific regular RT (BGP attribute code 16), or IPv6-address
          specific RT (BGP attribute code 25). It should be noted that the
          Local Administrator field of these RTs can only carry two octets of
          information, and thus the &lt;TC&gt; field in this approach is
          limited to a 2 octets value. Future protocol extensions work is
          needed to define a BGP CCA that can accomodate an IPv4/IPv6 address
          along with a 4 octet Local Administrator field.<a href="#section-9.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.6">
            <p id="section-9.2-1.6.1">An ingress SN MAY import BGP CT routes with Route Target carrying
          &lt;eSN&gt;:&lt;TC&gt;. The ingress SN may learn the eSN values
          either by configuration, or it may discover them from the BGP next
          hop field in the BGP VPN service routes received from eSN. A BGP
          ingress SN receiving a BGP service route with next hop of eSN
          generates a RTC route for Route Target prefix &lt;Origin
          ASN&gt;:&lt;eSN&gt;/[80|176] in order to learn BGP CT transport
          routes to reach eSN. This allows constrained distribution of the
          transport routes to the PNHs actually required by iSN.<a href="#section-9.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.7">
            <p id="section-9.2-1.7.1">When RTC is in use as described here, BGP CT routes will be
          constrained to follow the same path of propagation as the RTC
          routes. Therefore, a BN would learn the RTC routes advertised by
          ingress SNs and propagate further. This will allow constraining
          distribution of BGP CT routes for a PNH to only the necessary BNs in
          the network, closer to the egress SN.<a href="#section-9.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.8">
            <p id="section-9.2-1.8.1">When the path of route propagation of BGP CT routes is the same
          as the RTC routes, a BN would learn the RTC routes advertised by
          ingress SNs and propagate further. This will allow constraining
          distribution of BGP CT routes for a PNH to only the necessary BNs in
          the network, closer to the egress SN.<a href="#section-9.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.9">
            <p id="section-9.2-1.9.1">This mechanism provides "On Demand Next hop" of BGP CT routes,
          which help with the scaling of MPLS forwarding state at SN and
          BN.<a href="#section-9.2-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.10">
            <p id="section-9.2-1.10.1">However, the amount of state carried in RTC family may become
          proportional to the number of PNHs in the network. To strike a
          balance, the RTC route advertisements for &lt;Origin
          ASN&gt;:&lt;eSN&gt;/[80|176] MAY be confined to the BNs in the home
          region of an ingress SN, or the BNs of a super core.<a href="#section-9.2-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.2-1.11">
            <p id="section-9.2-1.11.1">Such a BN in the core of the network imports BGP CT routes with
          Transport-Target:0:&lt;TC&gt; and generates an RTC route for
          &lt;Origin ASN&gt;:0:&lt;TC&gt;/96, while not propagating the more
          specific RTC requests for specific PNHs. This lets the BN learn
          transport routes to all eSN nodes but confine their propagation to
          ingress SNs.<a href="#section-9.2-1.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-9.3">
        <h3 id="name-limiting-the-visibility-sco">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-limiting-the-visibility-sco" class="section-name selfRef">Limiting The Visibility Scope of PE Loopback as PNHs</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-9.3-1.1">
            <p id="section-9.3-1.1.1">It may be even more desirable to limit the number of PNHs that
          are globally visible in the network. This is possible using
          mechanism described in <a href="#Appendix_D" class="auto internal xref">Appendix D</a>, such that
          advertisement of PE loopback addresses as next-hop in BGP service
          routes is confined to the region they belong to. An anycast
          IP-address called "Context Protocol Nexthop Address" (CPNH)
          abstracts the SNs in a region from other regions in the network.<a href="#section-9.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.3-1.2">
            <p id="section-9.3-1.2.1">Such that advertisement of PE loopback addresses as next-hop in
          BGP service routes is confined to the region they belong to. An
          anycast IP-address called "Context Protocol Nexthop Address" (CPNH)
          abstracts the SNs in a region from other regions in the network.<a href="#section-9.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-9.3-1.3">
            <p id="section-9.3-1.3.1">This provides much greater advantage in terms of scaling,
          convergence and security. Changes to implement this feature are
          required only on the local region's BNs and RRs, so legacy PE
          devices can also benefit from this approach.<a href="#section-9.3-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</section>
<section id="section-10">
      <h2 id="name-operations-and-manageabilit">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-operations-and-manageabilit" class="section-name selfRef">Operations and Manageability Considerations</a>
      </h2>
<div id="mpls-oam">
<section id="section-10.1">
        <h3 id="name-mpls-oam">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-mpls-oam" class="section-name selfRef">MPLS OAM</a>
        </h3>
<p id="section-10.1-1">MPLS OAM procedures specified in <span>[<a href="#RFC8029" class="cite xref">RFC8029</a>]</span> also
        apply to BGP Classful Transport.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">The 'Target FEC Stack' sub-TLV for IPv4 Classful Transport has a
        Sub-Type of 31744, and a length of 13. The Value field consists of the
        RD advertised with the Classful Transport prefix, the IPv4 prefix
        (with trailing 0 bits to make 32 bits in all) and a prefix length
        encoded as shown in <a href="#FECv4" class="auto internal xref">Figure 4</a>.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<span id="name-classful-transport-ipv4-fec"></span><div id="FECv4">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-10.1-3.1">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Route Distinguisher                      |
      |                          (8 octets)                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv4 prefix                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |                 Must Be Zero                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-classful-transport-ipv4-fec" class="selfRef">Classful Transport IPv4 FEC</a>
          </figcaption></figure>
</div>
<p id="section-10.1-4">The 'Target FEC Stack' sub-TLV for IPv6 Classful Transport has a
        Sub-Type of 31745, and a length of 25. The Value field consists of the
        RD advertised with the Classful Transport prefix, the IPv6 prefix
        (with trailing 0 bits to make 128 bits in all) and a prefix length
        encoded as shown in <a href="#FECv6" class="auto internal xref">Figure 5</a>.<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<span id="name-classful-transport-ipv6-fec"></span><div id="FECv6">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-10.1-5.1">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Route Distinguisher                      |
      |                          (8 octets)                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv6 prefix                           |
      |                                                               |
      |                                                               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |                 Must Be Zero                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-classful-transport-ipv6-fec" class="selfRef">Classful Transport IPv6 FEC</a>
          </figcaption></figure>
</div>
<p id="section-10.1-6">These prefix layouts are inherited from Sections 3.2.5, 3.2.6 in
        <span>[<a href="#RFC8029" class="cite xref">RFC8029</a>]</span><a href="#section-10.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rd-lbl-usage">
<section id="section-10.2">
        <h3 id="name-usage-of-route-distinguishe">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-usage-of-route-distinguishe" class="section-name selfRef">Usage of Route Distinguisher and Label Allocation Modes</a>
        </h3>
<p id="section-10.2-1">RDs aid in troubleshooting provider networks that deploy BGP CT, by
        uniquely identifying the originator of a route across an
        administrative domain that may either span multiple domains within a
        provider network or span closely coordinated provider networks.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">The use of RDs also provides an option for signaling forwarding
        diversity within the same Transport Class. A SN can advertise an EP
        with the same Transport Class in multiple BGP CT routes with unique
        RDs.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">For example, unique "RDx:EP1" prefixes can be advertised by an SN
        for an EP1 to different upstream BNs with unique forwarding specific
        encapsulation (e.g., Label), in order to collect traffic statistics at
        the SN for each BN. In absence of RD, duplicated Transport Class/Color
        values will be needed in the transport network to achieve such use
        cases.<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2-4">The allocation of RDs is done at the point of origin of the BGP CT
        route. This can either be an Egress SN or a BN. The default RD
        allocation mode is to use a unique RD per originating node for an EP.
        This mode allows for the ingress to uniquely identify each originated
        path. Alternatively, the same RD may be provisioned for multiple
        originators of the same EP. This mode can be used when the ingress
        does not require full visibility of all nodes originating an EP.<a href="#section-10.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2-5">A label is allocated for a BGP CT route when it is advertised with
        next hop self by a SN or a BN. An implementation may use different
        label allocation modes with BGP CT. The recommended label allocation
        mode is per-prefix as it provides better traffic convergence
        properties than per-next hop label allocation mode. Furthermore, BGP
        CT offers two flavors for per-prefix label allocation. The first
        flavor assigns a label for each unique "RD, EP". The second flavor
        assigns a label for each unique "Transport Class, EP" while ignoring
        the RD.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2-6">In a BGP CT network, the number of routes at an Ingress PE is a
        function of unique EPs multiplied by BNs in the ingress domain that do
        next hop self. BGP CT provides flexible RD and Label allocation modes
        to address operational requirements in a multi-domain network. The
        impacts on the control plane and forwarding behavior for these modes
        are detailed with an example in <span><a href="#CTRouteVis" class="internal xref">Managing
        Transport Route Visibility</a> (<a href="#CTRouteVis" class="auto internal xref">Section 10.3</a>)</span><a href="#section-10.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CTRouteVis">
<section id="section-10.3">
        <h3 id="name-managing-transport-route-vi">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-managing-transport-route-vi" class="section-name selfRef">Managing Transport Route Visibility</a>
        </h3>
<p id="section-10.3-1">This section details the usage of BGP CT RD and label allocation
        modes to calibrate the level of path visibility and the amount of
        route and label scale in a multi-domain network.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">Consider a multi-domain BGP CT network as illustrated in the
        following <a href="#MultiDomainNetwork" class="auto internal xref">Figure 6</a>:<a href="#section-10.3-2" class="pilcrow">¶</a></p>
<span id="name-managing-transport-route-vis"></span><div id="MultiDomainNetwork">
<figure id="figure-6">
          <div id="section-10.3-3.1">
            <div class="alignLeft art-svg artwork" id="section-10.3-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="400" width="432" viewBox="0 0 432 400" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 80,112 L 80,176" fill="none" stroke="black"></path>
                <path d="M 80,208 L 80,272" fill="none" stroke="black"></path>
                <path d="M 136,80 L 136,96" fill="none" stroke="black"></path>
                <path d="M 136,128 L 136,144" fill="none" stroke="black"></path>
                <path d="M 136,240 L 136,256" fill="none" stroke="black"></path>
                <path d="M 136,288 L 136,304" fill="none" stroke="black"></path>
                <path d="M 288,128 L 288,176" fill="none" stroke="black"></path>
                <path d="M 288,288 L 288,336" fill="none" stroke="black"></path>
                <path d="M 136,80 L 216,80" fill="none" stroke="black"></path>
                <path d="M 312,80 L 328,80" fill="none" stroke="black"></path>
                <path d="M 80,112 L 112,112" fill="none" stroke="black"></path>
                <path d="M 304,112 L 328,112" fill="none" stroke="black"></path>
                <path d="M 136,144 L 216,144" fill="none" stroke="black"></path>
                <path d="M 312,144 L 328,144" fill="none" stroke="black"></path>
                <path d="M 288,176 L 328,176" fill="none" stroke="black"></path>
                <path d="M 136,240 L 216,240" fill="none" stroke="black"></path>
                <path d="M 312,240 L 328,240" fill="none" stroke="black"></path>
                <path d="M 80,272 L 112,272" fill="none" stroke="black"></path>
                <path d="M 304,272 L 328,272" fill="none" stroke="black"></path>
                <path d="M 136,304 L 216,304" fill="none" stroke="black"></path>
                <path d="M 312,304 L 328,304" fill="none" stroke="black"></path>
                <path d="M 288,336 L 328,336" fill="none" stroke="black"></path>
                <path d="M 304,288 L 312,304" fill="none" stroke="black"></path>
                <path d="M 304,128 L 312,144" fill="none" stroke="black"></path>
                <path d="M 304,96 L 312,80" fill="none" stroke="black"></path>
                <path d="M 304,256 L 312,240" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="92" y="36">......................</text>
                  <text x="312" y="36">.............................</text>
                  <text x="8" y="52">:</text>
                  <text x="96" y="52">AS3</text>
                  <text x="176" y="52">:</text>
                  <text x="200" y="52">:</text>
                  <text x="312" y="52">AS1</text>
                  <text x="424" y="52">:</text>
                  <text x="8" y="68">:</text>
                  <text x="176" y="68">:</text>
                  <text x="200" y="68">:</text>
                  <text x="424" y="68">:</text>
                  <text x="8" y="84">:</text>
                  <text x="244" y="84">ASBR11</text>
                  <text x="348" y="84">PE11</text>
                  <text x="392" y="84">(EP1)</text>
                  <text x="424" y="84">:</text>
                  <text x="8" y="100">:</text>
                  <text x="176" y="100">:</text>
                  <text x="200" y="100">:</text>
                  <text x="272" y="100">\</text>
                  <text x="424" y="100">:</text>
                  <text x="8" y="116">:</text>
                  <text x="140" y="116">ASBR31</text>
                  <text x="176" y="116">:</text>
                  <text x="200" y="116">:</text>
                  <text x="288" y="116">[P]</text>
                  <text x="348" y="116">PE12</text>
                  <text x="392" y="116">(EP2)</text>
                  <text x="424" y="116">:</text>
                  <text x="8" y="132">:</text>
                  <text x="176" y="132">:</text>
                  <text x="200" y="132">:</text>
                  <text x="272" y="132">/</text>
                  <text x="424" y="132">:</text>
                  <text x="8" y="148">:</text>
                  <text x="244" y="148">ASBR12</text>
                  <text x="348" y="148">PE13</text>
                  <text x="392" y="148">(EP3)</text>
                  <text x="424" y="148">:</text>
                  <text x="8" y="164">:</text>
                  <text x="176" y="164">:</text>
                  <text x="200" y="164">:</text>
                  <text x="424" y="164">:</text>
                  <text x="8" y="180">:</text>
                  <text x="176" y="180">:</text>
                  <text x="200" y="180">:</text>
                  <text x="348" y="180">PE14</text>
                  <text x="392" y="180">(EP4)</text>
                  <text x="424" y="180">:</text>
                  <text x="8" y="196">:</text>
                  <text x="56" y="196">PE31--[P]</text>
                  <text x="176" y="196">:</text>
                  <text x="200" y="196">:</text>
                  <text x="424" y="196">:</text>
                  <text x="8" y="212">:</text>
                  <text x="176" y="212">:</text>
                  <text x="200" y="212">:</text>
                  <text x="424" y="212">:</text>
                  <text x="8" y="228">:</text>
                  <text x="176" y="228">:</text>
                  <text x="200" y="228">:</text>
                  <text x="424" y="228">:</text>
                  <text x="8" y="244">:</text>
                  <text x="244" y="244">ASBR21</text>
                  <text x="348" y="244">PE21</text>
                  <text x="392" y="244">(EP5)</text>
                  <text x="424" y="244">:</text>
                  <text x="8" y="260">:</text>
                  <text x="176" y="260">:</text>
                  <text x="200" y="260">:</text>
                  <text x="272" y="260">\</text>
                  <text x="424" y="260">:</text>
                  <text x="8" y="276">:</text>
                  <text x="140" y="276">ASBR32</text>
                  <text x="176" y="276">:</text>
                  <text x="200" y="276">:</text>
                  <text x="288" y="276">[P]</text>
                  <text x="348" y="276">PE22</text>
                  <text x="392" y="276">(EP6)</text>
                  <text x="424" y="276">:</text>
                  <text x="8" y="292">:</text>
                  <text x="176" y="292">:</text>
                  <text x="200" y="292">:</text>
                  <text x="272" y="292">/</text>
                  <text x="424" y="292">:</text>
                  <text x="8" y="308">:</text>
                  <text x="244" y="308">ASBR22</text>
                  <text x="348" y="308">PE22</text>
                  <text x="392" y="308">(EP7)</text>
                  <text x="424" y="308">:</text>
                  <text x="8" y="324">:</text>
                  <text x="176" y="324">:</text>
                  <text x="200" y="324">:</text>
                  <text x="424" y="324">:</text>
                  <text x="8" y="340">:</text>
                  <text x="176" y="340">:</text>
                  <text x="200" y="340">:</text>
                  <text x="348" y="340">PE24</text>
                  <text x="392" y="340">(EP8)</text>
                  <text x="424" y="340">:</text>
                  <text x="92" y="356">......................</text>
                  <text x="312" y="356">.............................</text>
                </g>
              </svg><a href="#section-10.3-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-managing-transport-route-vis" class="selfRef">Managing Transport Route Visibility in Multi Domain Network</a>
          </figcaption></figure>
</div>
<p id="section-10.3-4">The following table provides a comparison of the BGP CT route and
        label scale, for varying endpoint path visibility at ingress node PE31
        for each TC. It analyzes scenarios where Unicast or Anycast EPs
        (EP-type) may be originated by different node roles (Origin), using
        different RD allocation modes (RD-Mode), and different Per-Prefix
        Label allocation modes (PP-Mode).<a href="#section-10.3-4" class="pilcrow">¶</a></p>
<span id="name-route-and-path-visibility-a"></span><div id="RDLabelVis">
<figure id="figure-7">
          <div id="section-10.3-5.1">
            <div class="alignLeft art-svg artwork" id="section-10.3-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="432" viewBox="0 0 432 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,32 L 8,288" fill="none" stroke="black"></path>
                <path d="M 80,32 L 80,288" fill="none" stroke="black"></path>
                <path d="M 136,32 L 136,288" fill="none" stroke="black"></path>
                <path d="M 200,32 L 200,288" fill="none" stroke="black"></path>
                <path d="M 264,32 L 264,288" fill="none" stroke="black"></path>
                <path d="M 344,32 L 344,288" fill="none" stroke="black"></path>
                <path d="M 424,32 L 424,288" fill="none" stroke="black"></path>
                <path d="M 8,32 L 424,32" fill="none" stroke="black"></path>
                <path d="M 8,64 L 424,64" fill="none" stroke="black"></path>
                <path d="M 16,144 L 72,144" fill="none" stroke="black"></path>
                <path d="M 88,144 L 128,144" fill="none" stroke="black"></path>
                <path d="M 144,144 L 192,144" fill="none" stroke="black"></path>
                <path d="M 208,144 L 256,144" fill="none" stroke="black"></path>
                <path d="M 272,144 L 336,144" fill="none" stroke="black"></path>
                <path d="M 352,144 L 416,144" fill="none" stroke="black"></path>
                <path d="M 8,288 L 424,288" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="40" y="52">EP-type</text>
                  <text x="108" y="52">Origin</text>
                  <text x="168" y="52">RD-Mode</text>
                  <text x="232" y="52">PP-Mode</text>
                  <text x="276" y="52">CT</text>
                  <text x="316" y="52">Routes</text>
                  <text x="356" y="52">CT</text>
                  <text x="396" y="52">Labels</text>
                  <text x="40" y="84">Unicast</text>
                  <text x="92" y="84">SN</text>
                  <text x="164" y="84">Unique</text>
                  <text x="224" y="84">TC,EP</text>
                  <text x="312" y="84">8</text>
                  <text x="384" y="84">8</text>
                  <text x="40" y="100">Unicast</text>
                  <text x="92" y="100">SN</text>
                  <text x="164" y="100">Unique</text>
                  <text x="224" y="100">RD,EP</text>
                  <text x="312" y="100">8</text>
                  <text x="384" y="100">8</text>
                  <text x="40" y="116">Unicast</text>
                  <text x="92" y="116">BN</text>
                  <text x="164" y="116">Unique</text>
                  <text x="224" y="116">TC,EP</text>
                  <text x="308" y="116">16</text>
                  <text x="384" y="116">8</text>
                  <text x="40" y="132">Unicast</text>
                  <text x="92" y="132">BN</text>
                  <text x="164" y="132">Unique</text>
                  <text x="224" y="132">RD,EP</text>
                  <text x="308" y="132">16</text>
                  <text x="380" y="132">16</text>
                  <text x="40" y="164">Anycast</text>
                  <text x="92" y="164">SN</text>
                  <text x="164" y="164">Unique</text>
                  <text x="224" y="164">TC,EP</text>
                  <text x="312" y="164">8</text>
                  <text x="384" y="164">2</text>
                  <text x="40" y="180">Anycast</text>
                  <text x="92" y="180">SN</text>
                  <text x="164" y="180">Unique</text>
                  <text x="224" y="180">RD,EP</text>
                  <text x="312" y="180">8</text>
                  <text x="384" y="180">8</text>
                  <text x="40" y="196">Anycast</text>
                  <text x="92" y="196">SN</text>
                  <text x="156" y="196">Same</text>
                  <text x="224" y="196">TC,EP</text>
                  <text x="312" y="196">2</text>
                  <text x="384" y="196">2</text>
                  <text x="40" y="212">Anycast</text>
                  <text x="92" y="212">SN</text>
                  <text x="156" y="212">Same</text>
                  <text x="224" y="212">RD,EP</text>
                  <text x="312" y="212">2</text>
                  <text x="384" y="212">2</text>
                  <text x="40" y="228">Anycast</text>
                  <text x="92" y="228">BN</text>
                  <text x="164" y="228">Unique</text>
                  <text x="224" y="228">TC,EP</text>
                  <text x="312" y="228">4</text>
                  <text x="384" y="228">2</text>
                  <text x="40" y="244">Anycast</text>
                  <text x="92" y="244">BN</text>
                  <text x="164" y="244">Unique</text>
                  <text x="224" y="244">RD,EP</text>
                  <text x="312" y="244">4</text>
                  <text x="384" y="244">4</text>
                  <text x="40" y="260">Anycast</text>
                  <text x="92" y="260">BN</text>
                  <text x="156" y="260">Same</text>
                  <text x="224" y="260">TC,EP</text>
                  <text x="312" y="260">2</text>
                  <text x="384" y="260">2</text>
                  <text x="40" y="276">Anycast</text>
                  <text x="92" y="276">BN</text>
                  <text x="156" y="276">Same</text>
                  <text x="224" y="276">RD,EP</text>
                  <text x="312" y="276">2</text>
                  <text x="384" y="276">2</text>
                </g>
              </svg><a href="#section-10.3-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-route-and-path-visibility-a" class="selfRef">Route and Path Visibility at Ingress Node</a>
          </figcaption></figure>
</div>
<p id="section-10.3-6">In the table shown in <a href="#RDLabelVis" class="auto internal xref">Figure 7</a>, route scale at
        ingress node PE31 is proportional to path diversity in ingress domain
        (number of ASBRs) and point of origination of BGP CT route. TE
        granularity at ingress node PE31 is proportional to the number of
        unique CT labels received, which depends on PP-mode and the path
        diversity in ingress domain.<a href="#section-10.3-6" class="pilcrow">¶</a></p>
<p id="section-10.3-7">Deploying unique RDs is strongly RECOMMENDED because it helps in
        troubleshooting by uniquely identifying the originator of a route and
        avoids path-hiding.<a href="#section-10.3-7" class="pilcrow">¶</a></p>
<p id="section-10.3-8">In typical deployments originating BGP CT routes at the egress node
        (SN) is recommended. In this model, using either "RD, EP" or "TC, EP"
        Per-Prefix label allocation mode repairs traffic locally at the
        nearest BN for any failures in the network, because the label value
        does not change.<a href="#section-10.3-8" class="pilcrow">¶</a></p>
<p id="section-10.3-9">Originating at BNs with unique RDs induces more routes than when
        originating at egress SNs. In this model, use of "TC, EP" Per-Prefix
        label allocation mode repairs traffic locally at the nearest BN for
        any failures in the network, because the label value does not
        change.<a href="#section-10.3-9" class="pilcrow">¶</a></p>
<p id="section-10.3-10">The previous table in <a href="#RDLabelVis" class="auto internal xref">Figure 7</a> demonstrates that
        BGP CT allows an operator to control how much path visibility and
        forwarding diversity is desired in the network, for both Unicast and
        Anycast endpoints.<a href="#section-10.3-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="CTdeploy">
<section id="section-11">
      <h2 id="name-deployment-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-deployment-considerations" class="section-name selfRef">Deployment Considerations.</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-coordination-between-domain">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-coordination-between-domain" class="section-name selfRef">Coordination Between Domains Using Different Community Namespaces</a>
        </h3>
<p id="section-11.1-1">Cooperating Inter-AS Option C domains may sometimes not agree on
        RT, RD, Mapping community or Transport Route Target values because of
        differences in community namespaces (e.g. during network mergers or
        renumbering for expansion). Such deployments may deploy mechanisms to
        map and rewrite the Route Target values on domain boundaries, using
        per ASBR import policies. This is no different than any other BGP VPN
        family. Mechanisms used in inter-AS VPN deployments may be leveraged
        with the Classful Transport family also.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">A resolution scheme allows association with multiple Mapping
        Communities. This minimizes service disruption during renumbering,
        network merger or transition scenarios.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">The Transport Class Route Target Extended Community is useful to
        avoid collision with regular Route Target namespace used by service
        routes.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-11.2">
        <h3 id="name-managing-intent-at-service-">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-managing-intent-at-service-" class="section-name selfRef">Managing Intent at Service and Transport layers.</a>
        </h3>
<p id="section-11.2-1"><span><a href="#CTProc" class="internal xref">Illustration of BGP CT Procedures</a> (<a href="#CTProc" class="auto internal xref">Section 8</a>)</span>
        shows multiple domains that agree on a color name space (Agreeing
        Color Domains) and contain tunnels with equivalent set of colors
        (Homogenous Color Domains).<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2-2">However, in the real world, this may not always be guaranteed. Two
        domains may independently manage their color namespaces; these are
        known as Non-Agreeing Color Domains. Two domains may have tunnels with
        unequal sets of colors; these are known as Heterogeneous Color
        Domains.<a href="#section-11.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2-3">This section describes how BGP CT is deployed in such scenarios to
        preserve end-to-end Intent. Examples described in this section use
        Inter-AS Option C domains. Similar mechanisms will work for Inter-AS
        Option A and Inter-AS Option B scenarios as well.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<section id="section-11.2.1">
          <h4 id="name-service-layer-color-managem">
<a href="#section-11.2.1" class="section-number selfRef">11.2.1. </a><a href="#name-service-layer-color-managem" class="section-name selfRef">Service Layer Color Management</a>
          </h4>
<p id="section-11.2.1-1">At the service layer, it is recommended that a global color
          namespace be maintained across multiple co-operating domains. BGP CT
          allows indirection using resolution schemes to be able to maintain a
          global namespace in the service layer. This is possible even if each
          domain independently maintains its own local transport color
          namespace.<a href="#section-11.2.1-1" class="pilcrow">¶</a></p>
<p id="section-11.2.1-2">As explained in <span><a href="#Nexthop_Resoln_Schm" class="internal xref">Next Hop
          Resolution Scheme</a> (<a href="#Nexthop_Resoln_Schm" class="auto internal xref">Section 5</a>)</span> , a mapping community carried on a service
          route maps to a resolution scheme. The mapping community values for
          the service route can be abstract and are not required to match the
          transport color namespace. This abstract mapping community value
          representing a global service layer intent is mapped to a local
          transport layer intent available in each domain.<a href="#section-11.2.1-2" class="pilcrow">¶</a></p>
<p id="section-11.2.1-3">In this manner, it is recommended to keep color namespace
          management at the service layer and the transport layer decoupled
          from each other. In the following sections the service layer agrees
          on a single global namespace.<a href="#section-11.2.1-3" class="pilcrow">¶</a></p>
</section>
<div id="non-agreeing">
<section id="section-11.2.2">
          <h4 id="name-non-agreeing-color-transpor">
<a href="#section-11.2.2" class="section-number selfRef">11.2.2. </a><a href="#name-non-agreeing-color-transpor" class="section-name selfRef">Non-Agreeing Color Transport Domains</a>
          </h4>
<p id="section-11.2.2-1">Non-agreeing color domains require a mapping community rewrite on
          each domain boundary. This rewrite helps to map one domain's color
          namespace to another domain's color namespace.<a href="#section-11.2.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2.2-2">The following example illustrates how traffic is stitched and SLA
          is preserved when domains don't use the same namespace at the
          transport layer. Each domain specifies the same SLA using different
          color values.<a href="#section-11.2.2-2" class="pilcrow">¶</a></p>
<span id="name-transport-layer-with-non-ag"></span><div id="BGPCT_NON_AGREEING_COLOR_DOMAIN">
<figure id="figure-8">
            <div id="section-11.2.2-3.1">
              <div class="alignLeft art-svg artwork" id="section-11.2.2-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="240" width="552" viewBox="0 0 552 240" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 56,32 L 136,32" fill="none" stroke="black"></path>
                  <path d="M 392,32 L 456,32" fill="none" stroke="black"></path>
                  <path d="M 72,96 L 96,96" fill="none" stroke="black"></path>
                  <path d="M 168,96 L 184,96" fill="none" stroke="black"></path>
                  <path d="M 248,96 L 288,96" fill="none" stroke="black"></path>
                  <path d="M 360,96 L 376,96" fill="none" stroke="black"></path>
                  <path d="M 440,96 L 488,96" fill="none" stroke="black"></path>
                  <path d="M 72,208 L 152,208" fill="none" stroke="black"></path>
                  <path d="M 392,208 L 456,208" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="464,208 452,202.4 452,213.6" fill="black" transform="rotate(0,456,208)"></polygon>
                  <polygon class="arrowhead" points="64,32 52,26.4 52,37.6" fill="black" transform="rotate(180,56,32)"></polygon>
                  <g class="text">
                    <text x="176" y="36">Service</text>
                    <text x="236" y="36">Routes</text>
                    <text x="300" y="36">AFI/SAFI</text>
                    <text x="360" y="36">1/128</text>
                    <text x="88" y="52">.....................</text>
                    <text x="272" y="52">.......................</text>
                    <text x="460" y="52">......................</text>
                    <text x="8" y="68">:</text>
                    <text x="96" y="68">Gold(100)</text>
                    <text x="168" y="68">:</text>
                    <text x="184" y="68">:</text>
                    <text x="280" y="68">Gold(300)</text>
                    <text x="360" y="68">:</text>
                    <text x="376" y="68">:</text>
                    <text x="472" y="68">Gold(500)</text>
                    <text x="544" y="68">:</text>
                    <text x="8" y="84">:</text>
                    <text x="168" y="84">:</text>
                    <text x="184" y="84">:</text>
                    <text x="360" y="84">:</text>
                    <text x="376" y="84">:</text>
                    <text x="544" y="84">:</text>
                    <text x="8" y="100">:</text>
                    <text x="44" y="100">[PE11]</text>
                    <text x="132" y="100">[ASBR11]</text>
                    <text x="216" y="100">[ASBR21</text>
                    <text x="324" y="100">[ASBR22]</text>
                    <text x="408" y="100">[ASBR31</text>
                    <text x="520" y="100">[PE31]:</text>
                    <text x="8" y="116">:</text>
                    <text x="168" y="116">:</text>
                    <text x="184" y="116">:</text>
                    <text x="360" y="116">:</text>
                    <text x="376" y="116">:</text>
                    <text x="544" y="116">:</text>
                    <text x="8" y="132">:</text>
                    <text x="88" y="132">AS1</text>
                    <text x="168" y="132">:</text>
                    <text x="184" y="132">:</text>
                    <text x="280" y="132">AS2</text>
                    <text x="360" y="132">:</text>
                    <text x="376" y="132">:</text>
                    <text x="464" y="132">AS3</text>
                    <text x="544" y="132">:</text>
                    <text x="8" y="148">:</text>
                    <text x="168" y="148">:</text>
                    <text x="184" y="148">:</text>
                    <text x="360" y="148">:</text>
                    <text x="376" y="148">:</text>
                    <text x="544" y="148">:</text>
                    <text x="8" y="164">:</text>
                    <text x="104" y="164">Bronze(200)</text>
                    <text x="168" y="164">:</text>
                    <text x="184" y="164">:</text>
                    <text x="272" y="164">Bronze(400)</text>
                    <text x="360" y="164">:</text>
                    <text x="376" y="164">:</text>
                    <text x="464" y="164">Bronze(600)</text>
                    <text x="544" y="164">:</text>
                    <text x="88" y="180">.....................</text>
                    <text x="272" y="180">.......................</text>
                    <text x="460" y="180">......................</text>
                    <text x="188" y="212">Packet</text>
                    <text x="260" y="212">Forwarding</text>
                    <text x="344" y="212">Direction</text>
                  </g>
                </svg><a href="#section-11.2.2-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-transport-layer-with-non-ag" class="selfRef">Transport Layer with Non-agreeing Color Domains</a>
            </figcaption></figure>
</div>
<p id="section-11.2.2-4">In the topology shown in <a href="#BGPCT_NON_AGREEING_COLOR_DOMAIN" class="auto internal xref">Figure 8</a>, we have three Autonomous
          Systems. All the nodes in the topology support BGP CT.<a href="#section-11.2.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2.2-5">In AS1 Gold SLA is represented by color 100 and Bronze by
          200.<a href="#section-11.2.2-5" class="pilcrow">¶</a></p>
<p id="section-11.2.2-6">In AS2 Gold SLA is represented by color 300 and Bronze by
          400.<a href="#section-11.2.2-6" class="pilcrow">¶</a></p>
<p id="section-11.2.2-7">In AS3 Gold SLA is represented by color 500 and Bronze by
          600.<a href="#section-11.2.2-7" class="pilcrow">¶</a></p>
<p id="section-11.2.2-8">Though the color values are different, they map to tunnels with
          sufficiently similar TE characteristics in each domain.<a href="#section-11.2.2-8" class="pilcrow">¶</a></p>
<p id="section-11.2.2-9">The service route carries an abstract mapping community that maps
          to the required SLA. For example, Service routes that need to
          resolve over Gold transport tunnels, carry a mapping community
          color:0:100500. In AS3 it maps to a resolution scheme containing
          TRDB with color 500 whereas in AS2 it maps to a TRDB with color 300
          and in AS1 it maps to a TRDB with color 100. Coordination is needed
          to provision the resolution schemes in each domain as explained
          previously.<a href="#section-11.2.2-9" class="pilcrow">¶</a></p>
<p id="section-11.2.2-10">At the AS boundary, the transport-class route-target is rewritten
          for the BGP CT routes. In the previous topology, at ASBR31, the
          transport-target:0:500 for Gold tunnels is rewritten to
          transport-target:0:300 and then advertised to ASBR22. Similarly, the
          transport-target:0:300 for Gold tunnels are re-written to
          transport-target:0:100 at ASBR21 before advertising to ASBR11. At
          PE11, the transport route received with transport-target:0:100 will
          be added to the color 100 TRDB. The service route received with
          mapping community color:0:100500 at PE1 maps to the Gold TRDB and
          resolves over this transport route.<a href="#section-11.2.2-10" class="pilcrow">¶</a></p>
<p id="section-11.2.2-11">Inter-domain traffic forwarding in the previous topology works as
          explained in <a href="#CTProc" class="auto internal xref">Section 8</a>.<a href="#section-11.2.2-11" class="pilcrow">¶</a></p>
<p id="section-11.2.2-12">Transport-target re-write requires co-ordination of color values
          between domains in the transport layer. This method avoids the need
          to re-write service route mapping communities, keeping the service
          layer homogenous and simple to manage. Coordinating Transport Class
          RT between two adjacent color domains at a time is easier than
          coordinating service layer colors deployed in a global mesh of
          non-adjacent color domains. This basically allows localizing the
          problem to a pair of adjacent color domains and solving it.<a href="#section-11.2.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11.2.3">
          <h4 id="name-heterogeneous-agreeing-colo">
<a href="#section-11.2.3" class="section-number selfRef">11.2.3. </a><a href="#name-heterogeneous-agreeing-colo" class="section-name selfRef">Heterogeneous Agreeing Color Transport Domains</a>
          </h4>
<p id="section-11.2.3-1">In a heterogeneous domains scenario, it might not be possible to
          map a service layer intent to the matching transport color, as the
          color might not be locally available in a domain.<a href="#section-11.2.3-1" class="pilcrow">¶</a></p>
<p id="section-11.2.3-2">The following example illustrates how traffic is stitched, when a
          transit AS contains more shades for an SLA path compared to Ingress
          and Egress domains. This example shows how service routes can
          traverse through finer shades when available and take coarse shades
          otherwise.<a href="#section-11.2.3-2" class="pilcrow">¶</a></p>
<span id="name-transport-layer-with-hetero"></span><div id="BGPCT_HETERO_COLOR_DOMAIN">
<figure id="figure-9">
            <div id="section-11.2.3-3.1">
              <div class="alignLeft art-svg artwork" id="section-11.2.3-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="552" viewBox="0 0 552 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 72,32 L 152,32" fill="none" stroke="black"></path>
                  <path d="M 408,32 L 472,32" fill="none" stroke="black"></path>
                  <path d="M 72,112 L 96,112" fill="none" stroke="black"></path>
                  <path d="M 168,112 L 184,112" fill="none" stroke="black"></path>
                  <path d="M 248,112 L 288,112" fill="none" stroke="black"></path>
                  <path d="M 360,112 L 376,112" fill="none" stroke="black"></path>
                  <path d="M 440,112 L 488,112" fill="none" stroke="black"></path>
                  <path d="M 72,224 L 152,224" fill="none" stroke="black"></path>
                  <path d="M 392,224 L 456,224" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="464,224 452,218.4 452,229.6" fill="black" transform="rotate(0,456,224)"></polygon>
                  <polygon class="arrowhead" points="80,32 68,26.4 68,37.6" fill="black" transform="rotate(180,72,32)"></polygon>
                  <g class="text">
                    <text x="192" y="36">Service</text>
                    <text x="252" y="36">Routes</text>
                    <text x="316" y="36">AFI/SAFI</text>
                    <text x="376" y="36">1/128</text>
                    <text x="88" y="52">.....................</text>
                    <text x="272" y="52">.......................</text>
                    <text x="460" y="52">......................</text>
                    <text x="8" y="68">:</text>
                    <text x="168" y="68">:</text>
                    <text x="184" y="68">:</text>
                    <text x="276" y="68">Gold1(101)</text>
                    <text x="360" y="68">:</text>
                    <text x="376" y="68">:</text>
                    <text x="544" y="68">:</text>
                    <text x="8" y="84">:</text>
                    <text x="96" y="84">Gold(100)</text>
                    <text x="168" y="84">:</text>
                    <text x="184" y="84">:</text>
                    <text x="276" y="84">Gold2(102)</text>
                    <text x="360" y="84">:</text>
                    <text x="376" y="84">:</text>
                    <text x="464" y="84">Gold(100)</text>
                    <text x="544" y="84">:</text>
                    <text x="8" y="100">:</text>
                    <text x="168" y="100">:</text>
                    <text x="184" y="100">:</text>
                    <text x="360" y="100">:</text>
                    <text x="376" y="100">:</text>
                    <text x="544" y="100">:</text>
                    <text x="8" y="116">:</text>
                    <text x="44" y="116">[PE11]</text>
                    <text x="132" y="116">[ASBR11]</text>
                    <text x="216" y="116">[ASBR21</text>
                    <text x="324" y="116">[ASBR22]</text>
                    <text x="408" y="116">[ASBR31</text>
                    <text x="520" y="116">[PE31]:</text>
                    <text x="8" y="132">:</text>
                    <text x="168" y="132">:</text>
                    <text x="184" y="132">:</text>
                    <text x="360" y="132">:</text>
                    <text x="376" y="132">:</text>
                    <text x="544" y="132">:</text>
                    <text x="8" y="148">:</text>
                    <text x="56" y="148">Metro</text>
                    <text x="112" y="148">Ingress</text>
                    <text x="168" y="148">:</text>
                    <text x="184" y="148">:</text>
                    <text x="268" y="148">Core</text>
                    <text x="360" y="148">:</text>
                    <text x="376" y="148">:</text>
                    <text x="432" y="148">Metro</text>
                    <text x="484" y="148">Egress</text>
                    <text x="544" y="148">:</text>
                    <text x="8" y="164">:</text>
                    <text x="168" y="164">:</text>
                    <text x="184" y="164">:</text>
                    <text x="360" y="164">:</text>
                    <text x="376" y="164">:</text>
                    <text x="544" y="164">:</text>
                    <text x="8" y="180">:</text>
                    <text x="88" y="180">AS1</text>
                    <text x="168" y="180">:</text>
                    <text x="184" y="180">:</text>
                    <text x="280" y="180">AS2</text>
                    <text x="360" y="180">:</text>
                    <text x="376" y="180">:</text>
                    <text x="464" y="180">AS3</text>
                    <text x="544" y="180">:</text>
                    <text x="88" y="196">.....................</text>
                    <text x="272" y="196">.......................</text>
                    <text x="460" y="196">......................</text>
                    <text x="188" y="228">Packet</text>
                    <text x="260" y="228">Forwarding</text>
                    <text x="344" y="228">Direction</text>
                  </g>
                </svg><a href="#section-11.2.3-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-transport-layer-with-hetero" class="selfRef">Transport Layer with Heterogenous Color Domains</a>
            </figcaption></figure>
</div>
<p id="section-11.2.3-4">In the preceding topology shown in <a href="#BGPCT_HETERO_COLOR_DOMAIN" class="auto internal xref">Figure 9</a>, we have three Autonomous
          Systems. All the nodes in the topology support BGP CT.<a href="#section-11.2.3-4" class="pilcrow">¶</a></p>
<p id="section-11.2.3-5">In AS1 Gold SLA is represented by color 100.<a href="#section-11.2.3-5" class="pilcrow">¶</a></p>
<p id="section-11.2.3-6">In AS2 Gold has finer shades: Gold1 by color 101 and Gold2 by
          color 102.<a href="#section-11.2.3-6" class="pilcrow">¶</a></p>
<p id="section-11.2.3-7">In AS3 Gold SLA is represented by color 100.<a href="#section-11.2.3-7" class="pilcrow">¶</a></p>
<p id="section-11.2.3-8">This problem can be solved by the two following approaches:<a href="#section-11.2.3-8" class="pilcrow">¶</a></p>
<section id="section-11.2.3.1">
            <h5 id="name-duplicate-tunnels-approach">
<a href="#section-11.2.3.1" class="section-number selfRef">11.2.3.1. </a><a href="#name-duplicate-tunnels-approach" class="section-name selfRef">Duplicate Tunnels Approach</a>
            </h5>
<p id="section-11.2.3.1-1">In this approach, duplicate tunnels that satisfy Gold SLA are
            configured in domains AS1 and AS3, but they are given fine grained
            colors 101 and 102.<a href="#section-11.2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-11.2.3.1-2">These tunnels will be installed in TRDBs corresponding to
            transport classes of color 101 and 102.<a href="#section-11.2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-11.2.3.1-3">Overlay routes received with mapping community (e.g.:
            transport-target or color community) can resolve over these
            tunnels in the TRDB with matching color by using resolution
            schemes.<a href="#section-11.2.3.1-3" class="pilcrow">¶</a></p>
<p id="section-11.2.3.1-4">This approach consumes more resources in the transport and
            forwarding layer, because of the duplicate tunnels.<a href="#section-11.2.3.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-11.2.3.2">
            <h5 id="name-customized-resolution-schem">
<a href="#section-11.2.3.2" class="section-number selfRef">11.2.3.2. </a><a href="#name-customized-resolution-schem" class="section-name selfRef">Customized Resolution Schemes Approach</a>
            </h5>
<p id="section-11.2.3.2-1">In this approach, resolution schemes in domains AS1 and AS3 are
            customized to map the received mapping community (e.g.,
            transport-target or color community) over available Gold SLA
            tunnels. This conserves resource usage with no additional state in
            the transport or forwarding planes.<a href="#section-11.2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-2">Service routes advertised by PE31 that need to resolve over
            Gold1 transport tunnels carry a mapping community color:0:101. In
            AS3 and AS1, where Gold1 is not available, it is mapped to color
            100 TRDB using a customized resolution scheme. In AS2, Gold1 is
            available and it maps to color 101 TRDB.<a href="#section-11.2.3.2-2" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-3">Similarly, service routes advertised by PE31 that need to
            resolve over Gold2 transport tunnels carry a mapping community
            color:0:102. In AS3 and AS1, where Gold2 is not available, it is
            mapped to color 100 TRDB using a customized resolution scheme. In
            AS2, Gold2 is available and it maps to color 102 TRDB.<a href="#section-11.2.3.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-4">To facilitate this, SN/BN in all three AS provision the
            transport classes 100, 101 and 102. SN and BN in AS1 and AS3 are
            provisioned with customized resolution schemes that resolve routes
            with transport-target:0:101 or transport-target:0:102 using color
            100 TRDB.<a href="#section-11.2.3.2-4" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-5">PE31 is provisioned to originate BGP CT route with color 101
            for endpoint PE31. This route is sent with NLRI RD prefix RD1:PE31
            and route target extended community transport-target:0:101.<a href="#section-11.2.3.2-5" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-6">Similarly, PE31 is provisioned to originate BGP CT route with
            color 102 for endpoint PE31. This route is sent with NLRI RD
            prefix RD2:PE31 and route target extended community
            transport-target:0:102.<a href="#section-11.2.3.2-6" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-7">Following description explains the remaining procedures with
            color 101 as example.<a href="#section-11.2.3.2-7" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-8">At ASBR31, the route target "transport-target:0:101" on this
            BGP CT route instructs to add the route to color 101 TRDB. ASBR31
            is provisioned with customized resolution scheme that resolves the
            routes carrying mapping community transport-target:0:101 to
            resolve using color 100 TRDB. This route is then re-advertised
            from color 101 TRDB to ASBR22 with route-target:0:101.<a href="#section-11.2.3.2-8" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-9">At ASBR22, the BGP CT routes received with
            transport-target:0:101 will be added to color 101 TRDB and
            strictly resolve over tunnel routes in the same TRDB. This route
            is re-advertised to ASBR21 with transport-target:0:101.<a href="#section-11.2.3.2-9" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-10">Similarly, at ASBR21, the BGP CT routes received with
            transport-target:0:101 will be added to color 101 TRDB and
            strictly resolve over tunnel routes in the same TRDB. This route
            is re-advertised to ASBR11 with transport-target:0:101.<a href="#section-11.2.3.2-10" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-11">At ASBR11, the route target "transport-target:0:101" on this
            BGP CT route instructs to add the route to color 101 TRDB. ASBR11
            is provisioned with a customized resolution scheme that resolves
            the routes carrying transport-target:0:101 to use color 100 TRDB.
            This route is then re-advertised from color 101 TRDB to PE11 with
            transport-target:0:101.<a href="#section-11.2.3.2-11" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-12">At PE11, the route target "transport-target:0:101" on this BGP
            CT route instructs to add the route to color 101 TRDB. PE11 is
            provisioned with a customized resolution scheme that resolves the
            routes carrying transport-target:0:101 to use color 100 TRDB.<a href="#section-11.2.3.2-12" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-13">When PE11 receives the service route with the mapping community
            color:0:101 it directly resolves over the BGP CT route in color
            101 TRDB, which in turn resolves over tunnel routes in color 100
            TRDB.<a href="#section-11.2.3.2-13" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-14">Similar processing is done for color 102 routes also at ASBR31,
            ASBR22, ASBR21, ASBR11 and PE11.<a href="#section-11.2.3.2-14" class="pilcrow">¶</a></p>
<p id="section-11.2.3.2-15">In doing so, PE11 can forward traffic via tunnels with color
            101, color 102 in the core domain, and color 100 in the metro
            domains.<a href="#section-11.2.3.2-15" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-11.3">
        <h3 id="name-migration-scenarios">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-migration-scenarios" class="section-name selfRef">Migration Scenarios.</a>
        </h3>
<section id="section-11.3.1">
          <h4 id="name-bgp-ct-islands-connected-vi">
<a href="#section-11.3.1" class="section-number selfRef">11.3.1. </a><a href="#name-bgp-ct-islands-connected-vi" class="section-name selfRef">BGP CT Islands Connected via BGP LU Domain</a>
          </h4>
<p id="section-11.3.1-1">This section explains how end-to-end SLA can be achieved while
          transiting a domain that does not support BGP CT. BGP LU is used in
          such domains to connect the BGP CT islands.<a href="#section-11.3.1-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-in-as1-and-as3-conne"></span><div id="BGPCTIsles">
<figure id="figure-10">
            <div id="section-11.3.1-2.1">
              <div class="alignLeft art-svg artwork" id="section-11.3.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="520" viewBox="0 0 520 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 104,32 L 104,64" fill="none" stroke="black"></path>
                  <path d="M 424,32 L 424,64" fill="none" stroke="black"></path>
                  <path d="M 104,32 L 184,32" fill="none" stroke="black"></path>
                  <path d="M 320,32 L 424,32" fill="none" stroke="black"></path>
                  <path d="M 48,80 L 80,80" fill="none" stroke="black"></path>
                  <path d="M 144,80 L 200,80" fill="none" stroke="black"></path>
                  <path d="M 264,80 L 280,80" fill="none" stroke="black"></path>
                  <path d="M 344,80 L 392,80" fill="none" stroke="black"></path>
                  <path d="M 456,80 L 472,80" fill="none" stroke="black"></path>
                  <path d="M 128,112 L 144,112" fill="none" stroke="black"></path>
                  <path d="M 208,112 L 224,112" fill="none" stroke="black"></path>
                  <path d="M 328,112 L 344,112" fill="none" stroke="black"></path>
                  <path d="M 408,112 L 424,112" fill="none" stroke="black"></path>
                  <path d="M 24,128 L 40,128" fill="none" stroke="black"></path>
                  <path d="M 104,128 L 120,128" fill="none" stroke="black"></path>
                  <path d="M 224,128 L 240,128" fill="none" stroke="black"></path>
                  <path d="M 304,128 L 320,128" fill="none" stroke="black"></path>
                  <path d="M 400,128 L 416,128" fill="none" stroke="black"></path>
                  <path d="M 480,128 L 496,128" fill="none" stroke="black"></path>
                  <path d="M 88,160 L 152,160" fill="none" stroke="black"></path>
                  <path d="M 376,160 L 448,160" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="504,128 492,122.4 492,133.6" fill="black" transform="rotate(0,496,128)"></polygon>
                  <polygon class="arrowhead" points="456,160 444,154.4 444,165.6" fill="black" transform="rotate(0,448,160)"></polygon>
                  <polygon class="arrowhead" points="432,112 420,106.4 420,117.6" fill="black" transform="rotate(0,424,112)"></polygon>
                  <polygon class="arrowhead" points="408,128 396,122.4 396,133.6" fill="black" transform="rotate(180,400,128)"></polygon>
                  <polygon class="arrowhead" points="336,112 324,106.4 324,117.6" fill="black" transform="rotate(180,328,112)"></polygon>
                  <polygon class="arrowhead" points="328,128 316,122.4 316,133.6" fill="black" transform="rotate(0,320,128)"></polygon>
                  <polygon class="arrowhead" points="232,128 220,122.4 220,133.6" fill="black" transform="rotate(180,224,128)"></polygon>
                  <polygon class="arrowhead" points="232,112 220,106.4 220,117.6" fill="black" transform="rotate(0,224,112)"></polygon>
                  <polygon class="arrowhead" points="136,112 124,106.4 124,117.6" fill="black" transform="rotate(180,128,112)"></polygon>
                  <polygon class="arrowhead" points="128,128 116,122.4 116,133.6" fill="black" transform="rotate(0,120,128)"></polygon>
                  <polygon class="arrowhead" points="32,128 20,122.4 20,133.6" fill="black" transform="rotate(180,24,128)"></polygon>
                  <g class="text">
                    <text x="204" y="36">EBGP</text>
                    <text x="260" y="36">Multihop</text>
                    <text x="308" y="36">CT</text>
                    <text x="64" y="68">AS3</text>
                    <text x="272" y="68">AS2</text>
                    <text x="464" y="68">AS1</text>
                    <text x="24" y="84">[PE31</text>
                    <text x="112" y="84">ASBR31]</text>
                    <text x="232" y="84">[ASBR22</text>
                    <text x="312" y="84">ASBR21]</text>
                    <text x="424" y="84">[ASBR11</text>
                    <text x="496" y="84">PE11]</text>
                    <text x="164" y="116">EBGP</text>
                    <text x="196" y="116">LU</text>
                    <text x="364" y="116">EBGP</text>
                    <text x="396" y="116">LU</text>
                    <text x="60" y="132">IBGP</text>
                    <text x="92" y="132">CT</text>
                    <text x="260" y="132">IBGP</text>
                    <text x="292" y="132">LU</text>
                    <text x="436" y="132">IBGP</text>
                    <text x="468" y="132">CT</text>
                    <text x="180" y="164">Packet</text>
                    <text x="252" y="164">Forwarding</text>
                    <text x="336" y="164">Direction</text>
                  </g>
                </svg><a href="#section-11.3.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-bgp-ct-in-as1-and-as3-conne" class="selfRef">BGP CT in AS1 and AS3 connected by BGP LU in AS2</a>
            </figcaption></figure>
</div>
<p id="section-11.3.1-3">In the preceding topology shown in <a href="#BGPCTIsles" class="auto internal xref">Figure 10</a>,
          there are three AS domains. AS1 and AS3 support BGP CT, while AS2
          does not support BGP CT.<a href="#section-11.3.1-3" class="pilcrow">¶</a></p>
<p id="section-11.3.1-4">Nodes in AS1, AS2, and AS3 negotiate BGP LU family on IBGP
          sessions within the domain. Nodes in AS1 and AS3 negotiate BGP CT
          family on IBGP sessions within the domain. ASBR11 and ASBR21 as well
          as ASBR22 and ASBR31 negotiate BGP LU family on the EBGP session
          over directly connected inter-domain links. ASBR11 and ASBR31 have
          reachability to each other’s loopbacks through BGP LU. ASBR11
          and ASBR31 negotiate BGP CT family over a multihop EBGP session
          formed using BGP LU reachability.<a href="#section-11.3.1-4" class="pilcrow">¶</a></p>
<p id="section-11.3.1-5">The following tunnels exist for Gold Transport Class<a href="#section-11.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.3.1-6.1">
              <p id="section-11.3.1-6.1.1">PE11_to_ASBR11_gold - RSVP-TE tunnel<a href="#section-11.3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-6.2">
              <p id="section-11.3.1-6.2.1">ASBR11_to_PE11_gold - RSVP-TE tunnel<a href="#section-11.3.1-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-6.3">
              <p id="section-11.3.1-6.3.1">PE31_to_ASBR31_gold - SRTE tunnel<a href="#section-11.3.1-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-6.4">
              <p id="section-11.3.1-6.4.1">ASBR31_to_PE31_gold - SRTE tunnel<a href="#section-11.3.1-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-11.3.1-7">The following tunnels exist for Bronze Transport Class<a href="#section-11.3.1-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.3.1-8.1">
              <p id="section-11.3.1-8.1.1">PE11_to_ASBR11_bronze - RSVP-TE tunnel<a href="#section-11.3.1-8.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-8.2">
              <p id="section-11.3.1-8.2.1">ASBR11_to_PE11_bronze - RSVP-TE tunnel<a href="#section-11.3.1-8.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-8.3">
              <p id="section-11.3.1-8.3.1">PE31_to_ASBR31_bronze - SRTE tunnel<a href="#section-11.3.1-8.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-8.4">
              <p id="section-11.3.1-8.4.1">ASBR31_to_PE31_bronze - SRTE tunnel<a href="#section-11.3.1-8.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-11.3.1-9">These tunnels are provisioned to belong to Transport Classes Gold
          and Bronze, and are advertised between ASBR31 and ASBR11 with Next
          hop self.<a href="#section-11.3.1-9" class="pilcrow">¶</a></p>
<p id="section-11.3.1-10">In AS2, that does not support BGP CT, a separate loopback may be
          used on ASBR22 and ASBR21 to represent Gold and Bronze SLAs, viz.
          ASBR22_lpbk_gold, ASBR22_lpbk_bronze, ASBR21_lpbk_gold and
          ASBR21_lpbk_bronze.<a href="#section-11.3.1-10" class="pilcrow">¶</a></p>
<p id="section-11.3.1-11">Furthermore, the following tunnels exist in AS2 to satisfy the
          different SLAs, using per SLA loopback endpoints:<a href="#section-11.3.1-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.3.1-12.1">
              <p id="section-11.3.1-12.1.1">ASBR21_to_ASBR22_lpbk_gold - RSVP-TE tunnel<a href="#section-11.3.1-12.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-12.2">
              <p id="section-11.3.1-12.2.1">ASBR22_to_ASBR21_lpbk_gold - RSVP-TE tunnel<a href="#section-11.3.1-12.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-12.3">
              <p id="section-11.3.1-12.3.1">ASBR21_to_ASBR22_lpbk_bronze - RSVP-TE tunnel<a href="#section-11.3.1-12.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="section-11.3.1-12.4">
              <p id="section-11.3.1-12.4.1">ASBR22_to_ASBR21_lpbk_bronze - RSVP-TE tunnel<a href="#section-11.3.1-12.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-11.3.1-13">RD:PE11 BGP CT route is originated from PE11 towards ASBR11 with
          transport-target 'gold.' ASBR11 readvertises this route with next
          hop set to ASBR11_lpbk_gold on the EBGP multihop session towards
          ASBR31. ASBR11 originates BGP LU route for endpoint ASBR11_lpbk_gold
          on EBGP session to ASBR21 with a 'gold SLA' community, and BGP LU
          route for ASBR11_lpbk_bronze with a 'bronze SLA' community. The SLA
          community is used by ASBR31 to publish the BGP LU routes in the
          corresponding BGP CT TRDBs.<a href="#section-11.3.1-13" class="pilcrow">¶</a></p>
<p id="section-11.3.1-14">ASBR21 readvertises the BGP LU route for endpoint
          ASBR11_lpbk_gold to ASBR22 with next hop set by local policy config
          to the unique loopback ASBR21_lpbk_gold by matching the 'gold SLA'
          community received as part of BGP LU advertisement from ASBR11.
          ASBR22 receives this route and resolves the next hop over the
          ASBR22_to_ASBR21_lpbk_gold RSVP-TE tunnel. On successful resolution,
          ASBR22 readvertises this BGP LU route to ASBR31 with next hop self
          and a new label.<a href="#section-11.3.1-14" class="pilcrow">¶</a></p>
<p id="section-11.3.1-15">ASBR31 adds the ASBR11_lpbk_gold route received via EBGP LU from
          ASBR22 to 'gold' TRDB based on the received 'gold SLA' community.
          ASBR31 uses this 'gold' TRDB route to resolve the next hop
          ASBR11_lpbk_gold received on BGP CT route with transport-target
          'gold,' for the prefix RD:PE11 received over the EBGP multihop CT
          session, thus preserving the end-to-end SLA. Now ASBR31 readvertises
          the BGP CT route for RD:PE11 with next hop as self thus stitching
          with the BGP LU LSP in AS2. Intra-domain traffic forwarding in AS1
          and AS3 follows the procedures as explained in <span><a href="#CTProc" class="internal xref">Illustration of CT Procedures</a> (<a href="#CTProc" class="auto internal xref">Section 8</a>)</span><a href="#section-11.3.1-15" class="pilcrow">¶</a></p>
<p id="section-11.3.1-16">In cases where an SLA cannot be preserved in AS2 because SLA
          specific tunnels and loopbacks don't exist in AS2, traffic can be
          carried over available SLAs (e.g.: best effort SLA) by rewriting the
          next hop to ASBR21 loopback assigned to the available SLA. This
          eases migration in case of heterogeneous color domains as-well.<a href="#section-11.3.1-16" class="pilcrow">¶</a></p>
</section>
<section id="section-11.3.2">
          <h4 id="name-bgp-ct-interoperability-bet">
<a href="#section-11.3.2" class="section-number selfRef">11.3.2. </a><a href="#name-bgp-ct-interoperability-bet" class="section-name selfRef">BGP CT - Interoperability between MPLS and Other Forwarding Technologies</a>
          </h4>
<p id="section-11.3.2-1">This section describes how nodes supporting dissimilar
          encapsulation technologies can interoperate with each other when
          using BGP CT family.<a href="#section-11.3.2-1" class="pilcrow">¶</a></p>
<section id="section-11.3.2.1">
            <h5 id="name-interop-between-mpls-and-sr">
<a href="#section-11.3.2.1" class="section-number selfRef">11.3.2.1. </a><a href="#name-interop-between-mpls-and-sr" class="section-name selfRef">Interop Between MPLS and SRv6 Nodes.</a>
            </h5>
<p id="section-11.3.2.1-1">BGP speakers may carry MPLS label and SRv6 SID in BGP CT SAFI
            76 for AFIs 1 or 2 routes using protocol encoding as described in
            <span><a href="#CTMultiEncap" class="internal xref">Carrying Multiple Encapsulation
            information</a> (<a href="#CTMultiEncap" class="auto internal xref">Section 6.3</a>)</span><a href="#section-11.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-11.3.2.1-2">MPLS Labels are carried using RFC 8277 encoding, and SRv6 SID
            is carried using Prefix SID attribute as specified in <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a>.<a href="#section-11.3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-interop-between-mpls"></span><div id="BGPCT_MPLS_SRV6">
<figure id="figure-11">
              <div id="section-11.3.2.1-3.1">
                <div class="alignLeft art-svg artwork" id="section-11.3.2.1-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="336" viewBox="0 0 336 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 136,48 L 136,64" fill="none" stroke="black"></path>
                    <path d="M 136,96 L 136,112" fill="none" stroke="black"></path>
                    <path d="M 80,32 L 104,32" fill="none" stroke="black"></path>
                    <path d="M 136,48 L 192,48" fill="none" stroke="black"></path>
                    <path d="M 72,80 L 128,80" fill="none" stroke="black"></path>
                    <path d="M 144,80 L 192,80" fill="none" stroke="black"></path>
                    <path d="M 136,112 L 192,112" fill="none" stroke="black"></path>
                    <path d="M 24,144 L 56,144" fill="none" stroke="black"></path>
                    <path d="M 248,144 L 288,144" fill="none" stroke="black"></path>
                    <path d="M 104,32 L 124,72" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="296,144 284,138.4 284,149.6" fill="black" transform="rotate(0,288,144)"></polygon>
                    <polygon class="arrowhead" points="32,144 20,138.4 20,149.6" fill="black" transform="rotate(180,24,144)"></polygon>
                    <g class="text">
                      <text x="64" y="36">RR1</text>
                      <text x="204" y="52">R2</text>
                      <text x="248" y="52">[MPLS</text>
                      <text x="280" y="52">+</text>
                      <text x="312" y="52">SRv6]</text>
                      <text x="60" y="84">R1</text>
                      <text x="136" y="84">P</text>
                      <text x="204" y="84">R3</text>
                      <text x="248" y="84">[MPLS</text>
                      <text x="296" y="84">only]</text>
                      <text x="24" y="100">[MPLS</text>
                      <text x="56" y="100">+</text>
                      <text x="88" y="100">SRv6]</text>
                      <text x="204" y="116">R4</text>
                      <text x="248" y="116">[SRv6</text>
                      <text x="296" y="116">only]</text>
                      <text x="120" y="148">Bidirectional</text>
                      <text x="208" y="148">Traffic</text>
                    </g>
                  </svg><a href="#section-11.3.2.1-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-bgp-ct-interop-between-mpls" class="selfRef">BGP CT Interop between MPLS and SRv6 nodes</a>
              </figcaption></figure>
</div>
<p id="section-11.3.2.1-4">This example shows a provider network with a mix of devices
            with different forwarding capabilities. R1 and R2 support
            forwarding both MPLS and SRv6 packets. R3 supports forwarding MPLS
            packets only. R4 supports forwarding SRv6 packets only. All these
            nodes have BGP session with Route Reflector RR1 which reflects
            routes between these nodes with next hop unchanged. BGP CT family
            is negotiated on these sessions.<a href="#section-11.3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-11.3.2.1-5">R1 and R2 send and receive both MPLS label and SRv6 SID in the
            BGP CT control plane routes. This allows them to be ingress and
            egress for both MPLS and SRv6 data planes. MPLS label is carried
            using RFC 8277 encoding, and SRv6 SID is carried using Prefix SID
            attribute as specified in <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a>, without
            Transposition Scheme. In this way, either MPLS or SRv6 forwarding
            can be used between R1 and R2.<a href="#section-11.3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-11.3.2.1-6">R1 and R3 send and receive MPLS label in the BGP CT control
            plane routes using RFC 8277 encoding. This allows them to be
            ingress and egress for MPLS data plane. R1 will carry SRv6 SID in
            Prefix-SID attribute, which will not be used by R3. In order to
            interoperate with MPLS only device R3, R1 MUST NOT use SRv6
            Transposition scheme described in <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>. The
            encoding suggested in <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a> is used by R1.
            MPLS forwarding will be used between R1 and R3.<a href="#section-11.3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-11.3.2.1-7">R1 and R4 send and receive SRv6 SID in the BGP CT control plane
            routes using BGP Prefix-SID attribute, without Transposition
            Scheme. This allows them to be ingress and egress for SRv6 data
            plane. R4 will carry the special MPLS Label with value 3
            (Implicit-NULL) in RFC 8277 encoding, which tells R1 not to push
            any MPLS label for this BGP CT route towards R4. The MPLS Label
            advertised by R1 in RFC 8277 NLRI will not be used by R4. SRv6
            forwarding will be used between R1 and R4.<a href="#section-11.3.2.1-7" class="pilcrow">¶</a></p>
<p id="section-11.3.2.1-8">Note in this example that R3 and R4 cannot communicate directly
            with each other, because they don't support a common forwarding
            technology. The BGP CT routes received at R3, R4 from each other
            will remain unusable, due to incompatible forwarding
            technology.<a href="#section-11.3.2.1-8" class="pilcrow">¶</a></p>
</section>
<section id="section-11.3.2.2">
            <h5 id="name-interop-between-nodes-suppo">
<a href="#section-11.3.2.2" class="section-number selfRef">11.3.2.2. </a><a href="#name-interop-between-nodes-suppo" class="section-name selfRef">Interop Between Nodes Supporting MPLS and UDP Tunneling</a>
            </h5>
<p id="section-11.3.2.2-1">This section describes how nodes supporting MPLS forwarding can
            interoperate with other nodes supporting UDP (or IP) tunneling,
            when using BGP CT family.<a href="#section-11.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-11.3.2.2-2">MPLS Labels are carried using RFC 8277 encoding, and UDP (or
            IP) tunneling information is carried using TEA attribute or the
            Encapsulation Extended Community as specified in <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>.<a href="#section-11.3.2.2-2" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-interop-between-mpls-"></span><div id="BGPCT_MPLS_UDP">
<figure id="figure-12">
              <div id="section-11.3.2.2-3.1">
                <div class="alignLeft art-svg artwork" id="section-11.3.2.2-3.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="176" width="328" viewBox="0 0 328 176" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 136,48 L 136,64" fill="none" stroke="black"></path>
                    <path d="M 136,96 L 136,112" fill="none" stroke="black"></path>
                    <path d="M 80,32 L 104,32" fill="none" stroke="black"></path>
                    <path d="M 136,48 L 192,48" fill="none" stroke="black"></path>
                    <path d="M 72,80 L 128,80" fill="none" stroke="black"></path>
                    <path d="M 144,80 L 192,80" fill="none" stroke="black"></path>
                    <path d="M 136,112 L 192,112" fill="none" stroke="black"></path>
                    <path d="M 24,144 L 56,144" fill="none" stroke="black"></path>
                    <path d="M 248,144 L 288,144" fill="none" stroke="black"></path>
                    <path d="M 104,32 L 124,72" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="296,144 284,138.4 284,149.6" fill="black" transform="rotate(0,288,144)"></polygon>
                    <polygon class="arrowhead" points="32,144 20,138.4 20,149.6" fill="black" transform="rotate(180,24,144)"></polygon>
                    <g class="text">
                      <text x="64" y="36">RR1</text>
                      <text x="204" y="52">R2</text>
                      <text x="248" y="52">[MPLS</text>
                      <text x="280" y="52">+</text>
                      <text x="308" y="52">UDP]</text>
                      <text x="60" y="84">R1</text>
                      <text x="136" y="84">P</text>
                      <text x="204" y="84">R3</text>
                      <text x="248" y="84">[MPLS</text>
                      <text x="296" y="84">only]</text>
                      <text x="24" y="100">[MPLS</text>
                      <text x="56" y="100">+</text>
                      <text x="84" y="100">UDP]</text>
                      <text x="204" y="116">R4</text>
                      <text x="244" y="116">[UDP</text>
                      <text x="288" y="116">only]</text>
                      <text x="120" y="148">Bidirectional</text>
                      <text x="208" y="148">Traffic</text>
                    </g>
                  </svg><a href="#section-11.3.2.2-3.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-bgp-ct-interop-between-mpls-" class="selfRef">BGP CT Interop between MPLS and UDP tunneling nodes</a>
              </figcaption></figure>
</div>
<p id="section-11.3.2.2-4">In this example, R1 and R2 support forwarding both MPLS and UDP
            tunneled packets. R3 supports forwarding MPLS packets only. R4
            supports forwarding UDP tunneled packets only. All these nodes
            have BGP session with Route Reflector RR1 which reflects routes
            between these nodes with next hop unchanged. BGP CT family is
            negotiated on these sessions.<a href="#section-11.3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-11.3.2.2-5">R1 and R2 send and receive both MPLS label and UDP tunneling
            info in the BGP CT control plane routes. This allows them to be
            ingress and egress for both MPLS and UDP tunneling data planes.
            MPLS label is carried using RFC 8277 encoding. As specified in
            <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span>, UDP tunneling information is carried
            using TEA attribute (code 23) or the "barebones" Tunnel TLV
            carried in Encapsulation Extended Community. Either MPLS or UDP
            tunneled forwarding can be used between R1 and R2.<a href="#section-11.3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-11.3.2.2-6">R1 and R3 send and receive MPLS label in the BGP CT control
            plane routes using RFC 8277 encoding. This allows them to be
            ingress and egress for MPLS data plane. R1 will carry UDP
            tunneling info in TEA attribute, which will not be used by R3.
            MPLS forwarding will be used between R1 and R3.<a href="#section-11.3.2.2-6" class="pilcrow">¶</a></p>
<p id="section-11.3.2.2-7">R1 and R4 send and receive UDP tunneling info in the BGP CT
            control plane routes using BGP TEA attribute. This allows them to
            be ingress and egress for UDP tunneled data plane. R4 will carry
            special MPLS Label with value 3 (Implicit-NULL) in RFC 8277
            encoding, which tells R1 not to push any MPLS label for this BGP
            CT route towards R4. The MPLS Label advertised by R1 will not be
            used by R4. UDP tunneled forwarding will be used between R1 and
            R4.<a href="#section-11.3.2.2-7" class="pilcrow">¶</a></p>
<p id="section-11.3.2.2-8">Note in this example that R3 and R4 cannot communicate 
            directly with each other, because they don't support a common 
            forwarding technology. The BGP CT routes received at R3, R4 
            from each otherwill remain unusable, due to incompatible 
            forwarding technology.<a href="#section-11.3.2.2-8" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-11.4">
        <h3 id="name-mtu-considerations">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-mtu-considerations" class="section-name selfRef">MTU Considerations</a>
        </h3>
<p id="section-11.4-1">Operators should coordinate the MTU of the intra-domain tunnels
        used to prevent Path MTU discovery problems that could appear in
        deployments. The encapsulation overhead due to the MPLS label stack or
        equivalent tunnel header in different forwarding architecture should
        also be considered when determining the Path MTU of the end-to-end BGP
        CT tunnel.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">The document <span>[<a href="#INTAREA-TUNNELS" class="cite xref">INTAREA-TUNNELS</a>]</span> discusses these
        considerations in more detail.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
</section>
<section id="section-11.5">
        <h3 id="name-use-of-dscp">
<a href="#section-11.5" class="section-number selfRef">11.5. </a><a href="#name-use-of-dscp" class="section-name selfRef">Use of DSCP</a>
        </h3>
<p id="section-11.5-1">BGP CT specifies procedures for Intent Driven Service Mapping in a
        service provider network, and defines 'Transport Class' construct to
        represent an Intent.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
<p id="section-11.5-2">It may be desirable to allow a CE device to indicate in the data
        packet it sends what treatment it desires (the Intent) when the packet
        is forwarded within the provider network.<a href="#section-11.5-2" class="pilcrow">¶</a></p>
<p id="section-11.5-3">Such an indication can be in form of DSCP code point <span>[<a href="#RFC2474" class="cite xref">RFC2474</a>]</span> in the IP header.<a href="#section-11.5-3" class="pilcrow">¶</a></p>
<p id="section-11.5-4">In RFC2474, a Forwarding Class Selector maps to a PHB (Per-hop
        Behavior). The Transport Class construct is a PHB at transport
        layer.<a href="#section-11.5-4" class="pilcrow">¶</a></p>
<span id="name-example-topology-with-dscp-"></span><div id="Intent_PE_CE">
<figure id="figure-13">
          <div id="section-11.5-5.1">
            <div class="alignLeft art-svg artwork" id="section-11.5-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="432" viewBox="0 0 432 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 152,32 L 176,32" fill="none" stroke="black"></path>
                <path d="M 216,32 L 256,32" fill="none" stroke="black"></path>
                <path d="M 96,48 L 128,48" fill="none" stroke="black"></path>
                <path d="M 176,48 L 192,48" fill="none" stroke="black"></path>
                <path d="M 224,48 L 248,48" fill="none" stroke="black"></path>
                <path d="M 296,48 L 328,48" fill="none" stroke="black"></path>
                <path d="M 152,64 L 168,64" fill="none" stroke="black"></path>
                <path d="M 224,64 L 256,64" fill="none" stroke="black"></path>
                <path d="M 96,96 L 128,96" fill="none" stroke="black"></path>
                <path d="M 272,96 L 304,96" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="312,96 300,90.4 300,101.6" fill="black" transform="rotate(0,304,96)"></polygon>
                <polygon class="arrowhead" points="264,64 252,58.4 252,69.6" fill="black" transform="rotate(0,256,64)"></polygon>
                <polygon class="arrowhead" points="264,32 252,26.4 252,37.6" fill="black" transform="rotate(0,256,32)"></polygon>
                <g class="text">
                  <text x="196" y="36">Gold</text>
                  <text x="72" y="52">[CE1]</text>
                  <text x="152" y="52">[PE1]</text>
                  <text x="208" y="52">[P]</text>
                  <text x="272" y="52">[PE2]</text>
                  <text x="352" y="52">[CE2]</text>
                  <text x="196" y="68">Bronze</text>
                  <text x="52" y="84">203.0.113.11</text>
                  <text x="380" y="84">203.0.113.22</text>
                  <text x="160" y="100">Traffic</text>
                  <text x="232" y="100">direction</text>
                </g>
              </svg><a href="#section-11.5-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-topology-with-dscp-" class="selfRef">Example Topology with DSCP on PE-CE Links</a>
          </figcaption></figure>
</div>
<p id="section-11.5-6">Let PE1 be configured to map DSCP1 to Gold Transport class, and
        DSCP2 to Bronze Transport class. Based on the DSCP code point received
        on the IP traffic from CE device, PE1 forwards the IP packet over a
        Gold or Bronze TC tunnel. Thus, the forwarding is not based on just
        the destination IP address, but also the DSCP code point. This is
        known as Class Based Forwarding (CBF).<a href="#section-11.5-6" class="pilcrow">¶</a></p>
<p id="section-11.5-7">CBF is configured at the PE1 device, mapping the DSCP values to
        respective Transport Classes. This mapping (DSCP peering agreement) is
        communicated to CE device by out of band mechanisms. This allows the
        administrator of CE1 to discover what transport classes exist in the
        provider network, and which DSCP codepoint to encode so that traffic
        is forwarded using the desired Transport Class in the provided
        network. When the IP packet exits the provider network to CE2, PE2
        resets the DSCP code point based on DSCP peering agreement with
        CE2.<a href="#section-11.5-7" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-12">
      <h2 id="name-applicability-to-network-sl">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-applicability-to-network-sl" class="section-name selfRef">Applicability to Network Slicing</a>
      </h2>
<p id="section-12-1">In Network Slicing, the Network Slice Controller (IETF NSC) is
      responsible for customizing and setting up the underlying transport
      (e.g. RSVP-TE, SRTE tunnels with desired characteristics) and resources
      (e.g., polices/shapers) in a transport network to create an IETF Network
      Slice.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">The Transport Class construct described in this document can be used
      to realize the "IETF Network Slice" described in Section 4 of <span>[<a href="#RFC9543" class="cite xref">RFC9543</a>]</span><a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">The NSC can use the Transport Class Identifier (Color value) to
      provision a transport tunnel in a specific IETF Network Slice.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">Furthermore, the NSC can use the Mapping Community on the service
      route to map traffic to the desired IETF Network Slice.<a href="#section-12-4" class="pilcrow">¶</a></p>
</section>
<div id="IANA">
<section id="section-13">
      <h2 id="name-iana-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-13-1">This document makes the following requests of IANA.<a href="#section-13-1" class="pilcrow">¶</a></p>
<section id="section-13.1">
        <h3 id="name-new-bgp-safi">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-new-bgp-safi" class="section-name selfRef">New BGP SAFI</a>
        </h3>
<p id="section-13.1-1">IANA has assigned a BGP SAFI code for "Classful Transport". Value
        76. IANA is requested to update the reference to this document.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.1-2">
<pre>
Registry Group: Subsequent Address Family Identifiers (SAFI) Parameters

Registry Name: SAFI Values

       Value              Description
      -------------+--------------------------
        76            Classful Transport SAFI
</pre><a href="#section-13.1-2" class="pilcrow">¶</a>
</div>
<p id="section-13.1-3">This will be used to create new AFI,SAFI pairs for IPv4, IPv6
        Classful Transport families. viz:<a href="#section-13.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.1-4.1">
            <p id="section-13.1-4.1.1">"IPv4, Classful Transport". AFI/SAFI = "1/76" for carrying IPv4
            Classful Transport prefixes.<a href="#section-13.1-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.1-4.2">
            <p id="section-13.1-4.2.1">"IPv6, Classful Transport". AFI/SAFI = "2/76" for carrying IPv6
            Classful Transport prefixes.<a href="#section-13.1-4.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-13.2">
        <h3 id="name-new-format-for-bgp-extended">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-new-format-for-bgp-extended" class="section-name selfRef">New Format for BGP Extended Community</a>
        </h3>
<p id="section-13.2-1">IANA has assigned a Format type (Type high = 0xa) of Extended
        Community <span><a href="#RFC4360" class="internal xref">EXT-COMM</a> [<a href="#RFC4360" class="cite xref">RFC4360</a>]</span> for Transport Class
        from the following registries:<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-13.2-2.1">
            <p id="section-13.2-2.1.1">the "BGP Transitive Extended Community Types" registry, and<a href="#section-13.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal ulEmpty" id="section-13.2-2.2">
            <p id="section-13.2-2.2.1">the "BGP Non-Transitive Extended Community Types" registry.<a href="#section-13.2-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-13.2-3">The same low-order six bits have been assigned for both
        allocations.<a href="#section-13.2-3" class="pilcrow">¶</a></p>
<p id="section-13.2-4">IANA is requested to update the reference to this document.<a href="#section-13.2-4" class="pilcrow">¶</a></p>
<p id="section-13.2-5">This document uses this new Format with subtype 0x2 (route target),
        as a transitive extended community. The Route Target thus formed is
        called "Transport Class" route target extended community.<a href="#section-13.2-5" class="pilcrow">¶</a></p>
<p id="section-13.2-6">The Non-Transitive Transport Class Extended community with subtype
        0x2 (route target) is called the "Non-Transitive Transport Class route
        target extended community".<a href="#section-13.2-6" class="pilcrow">¶</a></p>
<p id="section-13.2-7">Taking reference of <span>[<a href="#RFC7153" class="cite xref">RFC7153</a>]</span> , the following
        assignments have been made:<a href="#section-13.2-7" class="pilcrow">¶</a></p>
<section id="section-13.2.1">
          <h4 id="name-existing-registries">
<a href="#section-13.2.1" class="section-number selfRef">13.2.1. </a><a href="#name-existing-registries" class="section-name selfRef">Existing Registries</a>
          </h4>
<section id="section-13.2.1.1">
            <h5 id="name-registries-for-the-type-fie">
<a href="#section-13.2.1.1" class="section-number selfRef">13.2.1.1. </a><a href="#name-registries-for-the-type-fie" class="section-name selfRef">Registries for the "Type" Field</a>
            </h5>
<div id="tc-rt-t">
<section id="section-13.2.1.1.1">
              <h6 id="name-transitive-types">
<a href="#section-13.2.1.1.1" class="section-number selfRef">13.2.1.1.1. </a><a href="#name-transitive-types" class="section-name selfRef">Transitive Types</a>
              </h6>
<p id="section-13.2.1.1.1-1">This registry contains values of the high-order octet (the
              "Type" field) of a Transitive Extended Community.<a href="#section-13.2.1.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2.1.1.1-2">
<pre>Registry Group: Border Gateway Protocol (BGP) Extended Communities

Registry Name: BGP Transitive Extended Community Types

       Type Value        Name
      --------------+---------------
         0x0a          Transport Class

  (Sub-Types are defined in the
  "Transitive Transport Class Extended Community Sub-Types"
   registry)</pre><a href="#section-13.2.1.1.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="tc-rt-nt">
<section id="section-13.2.1.1.2">
              <h6 id="name-non-transitive-types">
<a href="#section-13.2.1.1.2" class="section-number selfRef">13.2.1.1.2. </a><a href="#name-non-transitive-types" class="section-name selfRef">Non-Transitive Types</a>
              </h6>
<p id="section-13.2.1.1.2-1">This registry contains values of the high-order octet (the
              "Type" field) of a Non-transitive Extended Community.<a href="#section-13.2.1.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2.1.1.2-2">
<pre> Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: BGP Non-Transitive Extended Community Types

      Type Value         Name
     --------------+--------------------------------
         0x4a         Non-Transitive Transport Class

 (Sub-Types are defined in the
  "Non-Transitive Transport Class Extended Community Sub-Types"
   registry)
</pre><a href="#section-13.2.1.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</section>
<section id="section-13.2.2">
          <h4 id="name-new-registries">
<a href="#section-13.2.2" class="section-number selfRef">13.2.2. </a><a href="#name-new-registries" class="section-name selfRef">New Registries</a>
          </h4>
<section id="section-13.2.2.1">
            <h5 id="name-transitive-transport-class-">
<a href="#section-13.2.2.1" class="section-number selfRef">13.2.2.1. </a><a href="#name-transitive-transport-class-" class="section-name selfRef">Transitive Transport Class Extended Community Sub-Types Registry</a>
            </h5>
<p id="section-13.2.2.1-1">IANA is requested to add the following subregistry under the
            “Border Gateway Protocol (BGP) Extended
            Communities”:<a href="#section-13.2.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2.2.1-2">
<pre> Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: Transitive Transport Class Extended Community Sub-Types

 Note:
    This registry contains values of the second octet (the
    "Sub-Type" field) of an extended community when the value of the
     first octet (the "Type" field) is 0x0a.

 Range                 Registration Procedures
 -----------------+----------------------------
 0x00-0xBF           First Come First Served
 0xC0-0xFF           IETF Review

 Sub-Type Value         Name
 -----------------+--------------
   0x02              Route Target
</pre><a href="#section-13.2.2.1-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-13.2.2.2">
            <h5 id="name-non-transitive-transport-cl">
<a href="#section-13.2.2.2" class="section-number selfRef">13.2.2.2. </a><a href="#name-non-transitive-transport-cl" class="section-name selfRef">Non-Transitive Transport Class Extended Community Sub-Types Registry</a>
            </h5>
<p id="section-13.2.2.2-1">IANA is requested to add the following subregistry under the
            “Border Gateway Protocol (BGP) Extended
            Communities”:<a href="#section-13.2.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2.2.2-2">
<pre> Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: Non-Transitive Transport Class Extended Community Sub-Types

 Note:
    This registry contains values of the second octet (the
    "Sub-Type" field) of an extended community when the value of the
     first octet (the "Type" field) is 0x4a.

 Range                 Registration Procedures
 -----------------+----------------------------
 0x00-0xBF           First Come First Served
 0xC0-0xFF           IETF Review

 Sub-Type Value         Name
 -----------------+--------------
   0x02              Route Target

</pre><a href="#section-13.2.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
<section id="section-13.3">
        <h3 id="name-mpls-oam-code-points">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-mpls-oam-code-points" class="section-name selfRef">MPLS OAM Code Points</a>
        </h3>
<p id="section-13.3-1">The following two code points have been assigned for Target FEC
        Stack sub-TLVs:<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3-2.1">
            <p id="section-13.3-2.1.1">IPv4 BGP Classful Transport<a href="#section-13.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-13.3-2.2">
            <p id="section-13.3-2.2.1">IPv6 BGP Classful Transport<a href="#section-13.3-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-13.3-3">
<pre> Registry Group: Multiprotocol Label Switching (MPLS)
                 Label Switched Paths (LSPs) Ping Parameters

 Registry Name: Sub-TLVs for TLV Types 1, 16, and 21

  Sub-Type                Name
 -----------------+------------------------------
   31744              IPv4 BGP Classful Transport
   31745              IPv6 BGP Classful Transport

</pre><a href="#section-13.3-3" class="pilcrow">¶</a>
</div>
<p id="section-13.3-4">IANA is requested to update the reference to this document.<a href="#section-13.3-4" class="pilcrow">¶</a></p>
</section>
<section id="section-13.4">
        <h3 id="name-transport-class-id">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-transport-class-id" class="section-name selfRef">Transport Class ID</a>
        </h3>
<p id="section-13.4-1">This document reserves the Transport class ID value 0 to represent
        "Best Effort Transport Class ID". This is used in the 'Transport Class
        ID' field of Transport Route Target extended community that represents
        best effort transport class.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<p id="section-13.4-2">Since all value ranges in this registry are already assigned or
        Private use, this registry will be maintained by this document. IANA
        does not need to maintain this registry.<a href="#section-13.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.4-3">
<pre> Registry Group: BGP Classful Transport (BGP CT)

 Registry Name: Transport Class ID

  Value                 Name
 -----------------+--------------------------------
   0                Best Effort Transport Class ID
   1-4294967295     Private Use

 Reference: This document.

 Registration Procedure(s)

  Value                 Registration Procedure
 -----------------+--------------------------------
   0                IETF Review
   1-4294967295     Private Use


</pre><a href="#section-13.4-3" class="pilcrow">¶</a>
</div>
<p id="section-13.4-4">As noted in Sec 4 and Sec 7.10, 'Transport Class ID' is
        interchangeable with 'Color'. For purposes of backward compatibility
        with usage of 'Color' field in Color extended community as specified
        in <span>[<a href="#RFC9012" class="cite xref">RFC9012</a>]</span> and <span>[<a href="#RFC9256" class="cite xref">RFC9256</a>]</span>, the range
        1-4294967295 uses 'Private Use' as Registration Procedure.<a href="#section-13.4-4" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Security">
<section id="section-14">
      <h2 id="name-security-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-14-1">This document uses <span>[<a href="#RFC4760" class="cite xref">RFC4760</a>]</span> mechanisms to define new
      BGP address families (AFI/SAFI : 1/76 and 2/76) that carry transport
      layer endpoints. These address families are explicitly configured and
      negotiated between BGP speakers, which confines the propagation scope of
      this reachability information, thus following a 'walled garden'
      approach.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">This mitigates the risk of advertising internal loopback addresses
      outside the administrative control of the provider network. Furthermore,
      procedures defined in <a href="#secure-propagate" class="auto internal xref">Section 9.1</a> mitigate the
      risk of unintended propagation of BGP CT routes across Inter-AS
      boundaries even when BGP CT family is negotiated on the EBGP
      session.<a href="#section-14-2" class="pilcrow">¶</a></p>
<p id="section-14-3">This document does not change the underlying security issues inherent
      in the existing BGP protocol, such as those described in <span>[<a href="#RFC4271" class="cite xref">RFC4271</a>]</span> and <span>[<a href="#RFC4272" class="cite xref">RFC4272</a>]</span>.<a href="#section-14-3" class="pilcrow">¶</a></p>
<p id="section-14-4">Additionally, BGP sessions SHOULD be protected using TCP
      Authentication Option <span>[<a href="#RFC5925" class="cite xref">RFC5925</a>]</span> and the Generalized TTL
      Security Mechanism <span>[<a href="#RFC5082" class="cite xref">RFC5082</a>]</span>.<a href="#section-14-4" class="pilcrow">¶</a></p>
<p id="section-14-5">Using a separate BGP family and new RT (Transport Class RT) minimizes
      the possibility of these routes mixing with service routes.<a href="#section-14-5" class="pilcrow">¶</a></p>
<p id="section-14-6">If redistributing between SAFI 76 and SAFI 4 routes for AFIs 1 or 2,
      there is a possibility of SAFI 4 routes mixing with SAFI 1 service
      routes. To avoid such scenarios, it is RECOMMENDED that implementations
      support keeping SAFI 76 and SAFI 4 transport routes in separate
      transport RIBs, distinct from service RIB that contain SAFI 1 service
      routes.<a href="#section-14-6" class="pilcrow">¶</a></p>
<p id="section-14-7">BGP CT routes distribute label binding using <span>[<a href="#RFC8277" class="cite xref">RFC8277</a>]</span>
      for MPLS dataplane and hence its security considerations apply.<a href="#section-14-7" class="pilcrow">¶</a></p>
<p id="section-14-8">BGP CT routes distribute SRv6 SIDs for SRv6 dataplanes and hence
      security considerations of Section 9.3 of <span>[<a href="#RFC9252" class="cite xref">RFC9252</a>]</span>
      apply. Moreover, SRv6 SID transposition scheme is disabled in BGP CT, as
      described in <a href="#SRv6-Support" class="auto internal xref">Section 7.13</a>, to mitigate the risk of
      misinterpreting transposed SRv6 SID information as an MPLS label.<a href="#section-14-8" class="pilcrow">¶</a></p>
<p id="section-14-9">As <span>[<a href="#RFC4272" class="cite xref">RFC4272</a>]</span> discusses, BGP is vulnerable to
      traffic-diversion attacks. This SAFI routes adds a new means by which an
      attacker could cause the traffic to be diverted from its normal path.
      Potential consequences include "hijacking" of traffic (insertion of an
      undesired node in the path, which allows for inspection or modification
      of traffic, or avoidance of security controls) or denial of service
      (directing traffic to a node that doesn't desire to receive it).<a href="#section-14-9" class="pilcrow">¶</a></p>
<p id="section-14-10">In order to mitigate the risk of the diversion of traffic from its
      intended destination, BGPsec solutions (<span>[<a href="#RFC8205" class="cite xref">RFC8205</a>]</span> and
      Origin Validation <span>[<a href="#RFC8210" class="cite xref">RFC8210</a>]</span><span>[<a href="#RFC6811" class="cite xref">RFC6811</a>]</span>) may
      be extended in future to work for non-Internet SAFIs (SAFIs other than
      1).<a href="#section-14-10" class="pilcrow">¶</a></p>
<p id="section-14-11">The restriction of the applicability of the BGP CT SAFI 76 to its
      intended well-defined scope and utilizing <span>[<a href="#RFC8212" class="cite xref">RFC8212</a>]</span> limits 
      the likelihood of traffic diversions.<a href="#section-14-11" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
        <dd>
<span class="refAuthor">Nichols, K.</span>, <span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2474">https://www.rfc-editor.org/info/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2545">[RFC2545]</dt>
        <dd>
<span class="refAuthor">Marques, P.</span> and <span class="refAuthor">F. Dupont</span>, <span class="refTitle">"Use of BGP-4 Multiprotocol Extensions for IPv6 Inter-Domain Routing"</span>, <span class="seriesInfo">RFC 2545</span>, <span class="seriesInfo">DOI 10.17487/RFC2545</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2545">https://www.rfc-editor.org/info/rfc2545</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4272">[RFC4272]</dt>
        <dd>
<span class="refAuthor">Murphy, S.</span>, <span class="refTitle">"BGP Security Vulnerabilities Analysis"</span>, <span class="seriesInfo">RFC 4272</span>, <span class="seriesInfo">DOI 10.17487/RFC4272</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4272">https://www.rfc-editor.org/info/rfc4272</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4360">[RFC4360]</dt>
        <dd>
<span class="refAuthor">Sangli, S.</span>, <span class="refAuthor">Tappan, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP Extended Communities Attribute"</span>, <span class="seriesInfo">RFC 4360</span>, <span class="seriesInfo">DOI 10.17487/RFC4360</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4360">https://www.rfc-editor.org/info/rfc4360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4364">[RFC4364]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4364</span>, <span class="seriesInfo">DOI 10.17487/RFC4364</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4659">[RFC4659]</dt>
        <dd>
<span class="refAuthor">De Clercq, J.</span>, <span class="refAuthor">Ooms, D.</span>, <span class="refAuthor">Carugi, M.</span>, and <span class="refAuthor">F. Le Faucheur</span>, <span class="refTitle">"BGP-MPLS IP Virtual Private Network (VPN) Extension for IPv6 VPN"</span>, <span class="seriesInfo">RFC 4659</span>, <span class="seriesInfo">DOI 10.17487/RFC4659</span>, <time datetime="2006-09" class="refDate">September 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4659">https://www.rfc-editor.org/info/rfc4659</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4684">[RFC4684]</dt>
        <dd>
<span class="refAuthor">Marques, P.</span>, <span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Fang, L.</span>, <span class="refAuthor">Martini, L.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">J. Guichard</span>, <span class="refTitle">"Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4684</span>, <span class="seriesInfo">DOI 10.17487/RFC4684</span>, <time datetime="2006-11" class="refDate">November 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4684">https://www.rfc-editor.org/info/rfc4684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
        <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chandra, R.</span>, <span class="refAuthor">Katz, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5082">[RFC5082]</dt>
        <dd>
<span class="refAuthor">Gill, V.</span>, <span class="refAuthor">Heasley, J.</span>, <span class="refAuthor">Meyer, D.</span>, <span class="refAuthor">Savola, P., Ed.</span>, and <span class="refAuthor">C. Pignataro</span>, <span class="refTitle">"The Generalized TTL Security Mechanism (GTSM)"</span>, <span class="seriesInfo">RFC 5082</span>, <span class="seriesInfo">DOI 10.17487/RFC5082</span>, <time datetime="2007-10" class="refDate">October 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5082">https://www.rfc-editor.org/info/rfc5082</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5925">[RFC5925]</dt>
        <dd>
<span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Mankin, A.</span>, and <span class="refAuthor">R. Bonica</span>, <span class="refTitle">"The TCP Authentication Option"</span>, <span class="seriesInfo">RFC 5925</span>, <span class="seriesInfo">DOI 10.17487/RFC5925</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5925">https://www.rfc-editor.org/info/rfc5925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6811">[RFC6811]</dt>
        <dd>
<span class="refAuthor">Mohapatra, P.</span>, <span class="refAuthor">Scudder, J.</span>, <span class="refAuthor">Ward, D.</span>, <span class="refAuthor">Bush, R.</span>, and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"BGP Prefix Origin Validation"</span>, <span class="seriesInfo">RFC 6811</span>, <span class="seriesInfo">DOI 10.17487/RFC6811</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6811">https://www.rfc-editor.org/info/rfc6811</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7153">[RFC7153]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"IANA Registries for BGP Extended Communities"</span>, <span class="seriesInfo">RFC 7153</span>, <span class="seriesInfo">DOI 10.17487/RFC7153</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7153">https://www.rfc-editor.org/info/rfc7153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7606">[RFC7606]</dt>
        <dd>
<span class="refAuthor">Chen, E., Ed.</span>, <span class="refAuthor">Scudder, J., Ed.</span>, <span class="refAuthor">Mohapatra, P.</span>, and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"Revised Error Handling for BGP UPDATE Messages"</span>, <span class="seriesInfo">RFC 7606</span>, <span class="seriesInfo">DOI 10.17487/RFC7606</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7606">https://www.rfc-editor.org/info/rfc7606</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7911">[RFC7911]</dt>
        <dd>
<span class="refAuthor">Walton, D.</span>, <span class="refAuthor">Retana, A.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Advertisement of Multiple Paths in BGP"</span>, <span class="seriesInfo">RFC 7911</span>, <span class="seriesInfo">DOI 10.17487/RFC7911</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7911">https://www.rfc-editor.org/info/rfc7911</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8029">[RFC8029]</dt>
        <dd>
<span class="refAuthor">Kompella, K.</span>, <span class="refAuthor">Swallow, G.</span>, <span class="refAuthor">Pignataro, C., Ed.</span>, <span class="refAuthor">Kumar, N.</span>, <span class="refAuthor">Aldrin, S.</span>, and <span class="refAuthor">M. Chen</span>, <span class="refTitle">"Detecting Multiprotocol Label Switched (MPLS) Data-Plane Failures"</span>, <span class="seriesInfo">RFC 8029</span>, <span class="seriesInfo">DOI 10.17487/RFC8029</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8029">https://www.rfc-editor.org/info/rfc8029</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8212">[RFC8212]</dt>
        <dd>
<span class="refAuthor">Mauch, J.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">G. Hankins</span>, <span class="refTitle">"Default External BGP (EBGP) Route Propagation Behavior without Policies"</span>, <span class="seriesInfo">RFC 8212</span>, <span class="seriesInfo">DOI 10.17487/RFC8212</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8212">https://www.rfc-editor.org/info/rfc8212</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8277">[RFC8277]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refTitle">"Using BGP to Bind MPLS Labels to Address Prefixes"</span>, <span class="seriesInfo">RFC 8277</span>, <span class="seriesInfo">DOI 10.17487/RFC8277</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8277">https://www.rfc-editor.org/info/rfc8277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8669">[RFC8669]</dt>
        <dd>
<span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Lindem, A., Ed.</span>, <span class="refAuthor">Sreekantiah, A.</span>, and <span class="refAuthor">H. Gredler</span>, <span class="refTitle">"Segment Routing Prefix Segment Identifier Extensions for BGP"</span>, <span class="seriesInfo">RFC 8669</span>, <span class="seriesInfo">DOI 10.17487/RFC8669</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8669">https://www.rfc-editor.org/info/rfc8669</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9012">[RFC9012]</dt>
        <dd>
<span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Sangli, S.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"The BGP Tunnel Encapsulation Attribute"</span>, <span class="seriesInfo">RFC 9012</span>, <span class="seriesInfo">DOI 10.17487/RFC9012</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9012">https://www.rfc-editor.org/info/rfc9012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9252">[RFC9252]</dt>
        <dd>
<span class="refAuthor">Dawra, G., Ed.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Zhuang, S.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"BGP Overlay Services Based on Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9252</span>, <span class="seriesInfo">DOI 10.17487/RFC9252</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9252">https://www.rfc-editor.org/info/rfc9252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRTE">[SRTE]</dt>
      <dd>
<span class="refAuthor">Talaulikar, Ed.</span> and <span class="refAuthor">S. Previdi</span>, <span class="refTitle">"Advertising Segment Routing Policies in BGP"</span>, <time datetime="2024-11-07" class="refDate">7 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-sr-policy-safi-10">https://datatracker.ietf.org/doc/html/draft-ietf-idr-sr-policy-safi-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BGP-CT-SRv6">[BGP-CT-SRv6]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span> and <span class="refAuthor">Venkataraman, Ed.</span>, <span class="refTitle">"BGP CT - Adaptation to SRv6 dataplane"</span>, <time datetime="2024-04-25" class="refDate">25 April 2024</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-idr-bgp-ct-srv6-05">https://tools.ietf.org/html/draft-ietf-idr-bgp-ct-srv6-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BGP-CT-UPDATE-PACKING-TEST">[BGP-CT-UPDATE-PACKING-TEST]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP CT Update packing Test Results"</span>, <time datetime="2023-06-25" class="refDate">25 June 2023</time>, <span>&lt;<a href="https://raw.githubusercontent.com/ietf-wg-idr/draft-ietf-idr-bgp-ct/1a75d4d10d4df0f1fd7dcc041c2c868704b092c7/update-packing-test-results.txt">https://raw.githubusercontent.com/ietf-wg-idr/draft-ietf-idr-bgp-ct/1a75d4d10d4df0f1fd7dcc041c2c868704b092c7/update-packing-test-results.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BGP-FWD-RR">[BGP-FWD-RR]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span> and <span class="refAuthor">Venkataraman, Ed.</span>, <span class="refTitle">"BGP Route Reflector in Forwarding Path"</span>, <time datetime="2024-03-17" class="refDate">17 March 2024</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-idr-bgp-fwd-rr-02">https://tools.ietf.org/html/draft-ietf-idr-bgp-fwd-rr-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BGP-LU-EPE">[BGP-LU-EPE]</dt>
        <dd>
<span class="refAuthor">Gredler, Ed.</span>, <span class="refTitle">"Egress Peer Engineering using BGP-LU"</span>, <time datetime="2023-06-16" class="refDate">16 June 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-gredler-idr-bgplu-epe-15">https://datatracker.ietf.org/doc/html/draft-gredler-idr-bgplu-epe-15</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLOWSPEC-REDIR-IP">[FLOWSPEC-REDIR-IP]</dt>
        <dd>
<span class="refAuthor">Simpson, Ed.</span>, <span class="refTitle">"BGP Flow-Spec Redirect to IP Action"</span>, <time datetime="2015-02-02" class="refDate">2 February 2015</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip-02">https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="INTAREA-TUNNELS">[INTAREA-TUNNELS]</dt>
        <dd>
<span class="refAuthor">Touch, Ed.</span> and <span class="refAuthor">Townsley, Ed.</span>, <span class="refTitle">"IP Tunnels in the Internet Architecture"</span>, <time datetime="2023-03-26" class="refDate">26 March 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/draft-ietf-intarea-tunnels/13/">https://datatracker.ietf.org/doc/draft-ietf-intarea-tunnels/13/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Intent-Routing-Color">[Intent-Routing-Color]</dt>
        <dd>
<span class="refAuthor">Hegde, Ed.</span>, <span class="refTitle">"Intent-aware Routing using Color"</span>, <time datetime="2023-10-23" class="refDate">23 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-hr-spring-intentaware-routing-using-color-03">https://datatracker.ietf.org/doc/html/draft-hr-spring-intentaware-routing-using-color-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MNH">[MNH]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP MultiNexthop Attribute"</span>, <time datetime="2024-03-17" class="refDate">17 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-multinexthop-attribute-00">https://datatracker.ietf.org/doc/html/draft-ietf-idr-multinexthop-attribute-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MPLS-NS">[MPLS-NS]</dt>
        <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP signalled MPLS namespaces"</span>, <time datetime="2023-10-20" class="refDate">20 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-07">https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PCEP-RSVP-COLOR">[PCEP-RSVP-COLOR]</dt>
        <dd>
<span class="refAuthor">Rajagopalan, Ed.</span> and <span class="refAuthor">Pavan. Beeram, Ed.</span>, <span class="refTitle">"Path Computation Element Protocol(PCEP) Extension for RSVP Color"</span>, <time datetime="2025-01-22" class="refDate">22 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-pce-pcep-color-07">https://datatracker.ietf.org/doc/html/draft-ietf-pce-pcep-color-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PCEP-SRPOLICY">[PCEP-SRPOLICY]</dt>
        <dd>
<span class="refAuthor">Koldychev, Ed.</span>, <span class="refAuthor">Sivabalan, Ed.</span>, and <span class="refAuthor">Barth, Ed.</span>, <span class="refTitle">"PCEP Extensions for SR Policy Candidate Paths"</span>, <time datetime="2024-02-09" class="refDate">9 February 2024</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-pce-segment-routing-policy-cp-14.html">https://www.ietf.org/archive/id/draft-ietf-pce-segment-routing-policy-cp-14.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6890">[RFC6890]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Vegoda, L.</span>, <span class="refAuthor">Bonica, R., Ed.</span>, and <span class="refAuthor">B. Haberman</span>, <span class="refTitle">"Special-Purpose IP Address Registries"</span>, <span class="seriesInfo">BCP 153</span>, <span class="seriesInfo">RFC 6890</span>, <span class="seriesInfo">DOI 10.17487/RFC6890</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6890">https://www.rfc-editor.org/info/rfc6890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8210">[RFC8210]</dt>
        <dd>
<span class="refAuthor">Bush, R.</span> and <span class="refAuthor">R. Austein</span>, <span class="refTitle">"The Resource Public Key Infrastructure (RPKI) to Router Protocol, Version 1"</span>, <span class="seriesInfo">RFC 8210</span>, <span class="seriesInfo">DOI 10.17487/RFC8210</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8210">https://www.rfc-editor.org/info/rfc8210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9256">[RFC9256]</dt>
        <dd>
<span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Bogdanov, A.</span>, and <span class="refAuthor">P. Mattes</span>, <span class="refTitle">"Segment Routing Policy Architecture"</span>, <span class="seriesInfo">RFC 9256</span>, <span class="seriesInfo">DOI 10.17487/RFC9256</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9256">https://www.rfc-editor.org/info/rfc9256</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9315">[RFC9315]</dt>
        <dd>
<span class="refAuthor">Clemm, A.</span>, <span class="refAuthor">Ciavaglia, L.</span>, <span class="refAuthor">Granville, L. Z.</span>, and <span class="refAuthor">J. Tantsura</span>, <span class="refTitle">"Intent-Based Networking - Concepts and Definitions"</span>, <span class="seriesInfo">RFC 9315</span>, <span class="seriesInfo">DOI 10.17487/RFC9315</span>, <time datetime="2022-10" class="refDate">October 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9315">https://www.rfc-editor.org/info/rfc9315</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9350">[RFC9350]</dt>
        <dd>
<span class="refAuthor">Psenak, P., Ed.</span>, <span class="refAuthor">Hegde, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, and <span class="refAuthor">A. Gulko</span>, <span class="refTitle">"IGP Flexible Algorithm"</span>, <span class="seriesInfo">RFC 9350</span>, <span class="seriesInfo">DOI 10.17487/RFC9350</span>, <time datetime="2023-02" class="refDate">February 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9350">https://www.rfc-editor.org/info/rfc9350</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9543">[RFC9543]</dt>
      <dd>
<span class="refAuthor">Farrel, A., Ed.</span>, <span class="refAuthor">Drake, J., Ed.</span>, <span class="refAuthor">Rokui, R.</span>, <span class="refAuthor">Homma, S.</span>, <span class="refAuthor">Makhijani, K.</span>, <span class="refAuthor">Contreras, L.</span>, and <span class="refAuthor">J. Tantsura</span>, <span class="refTitle">"A Framework for Network Slices in Networks Built from IETF Technologies"</span>, <span class="seriesInfo">RFC 9543</span>, <span class="seriesInfo">DOI 10.17487/RFC9543</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9543">https://www.rfc-editor.org/info/rfc9543</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Appendix_A">
<section id="appendix-A">
      <h2 id="name-extensibility-consideration">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-extensibility-consideration" class="section-name selfRef">Extensibility considerations</a>
      </h2>
<section id="appendix-A.1">
        <h3 id="name-signaling-intent-over-pe-ce">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-signaling-intent-over-pe-ce" class="section-name selfRef">Signaling Intent over PE-CE Attachment Circuit</a>
        </h3>
<p id="appendix-A.1-1">It may be desirable to allow a CE device to indicate in the data
        packet it sends what treatment it desires (the Intent) when the packet
        is forwarded within the provider network.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Section A.10 in <span><a href="#MNH" class="internal xref">BGP MultiNexthop
        Attribute</a> [<a href="#MNH" class="cite xref">MNH</a>]</span> describes some mechanisms that enable such
        signaling.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.2">
        <h3 id="name-bgp-ct-egress-te">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-bgp-ct-egress-te" class="section-name selfRef">BGP CT Egress TE</a>
        </h3>
<p id="appendix-A.2-1">Mechanisms described in <span>[<a href="#BGP-LU-EPE" class="cite xref">BGP-LU-EPE</a>]</span> also applies to
        BGP CT family.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The Peer/32 or Peer/128 EPE route MAY be originated in BGP CT
        family with appropriate Mapping Community (e.g.
        transport-target:0:100), thus allowing an EPE path to the peer that
        satisfies the desired SLA.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Appendix_B">
<section id="appendix-B">
      <h2 id="name-applicability-to-intra-as-a">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-applicability-to-intra-as-a" class="section-name selfRef">Applicability to Intra-AS and different Inter-AS deployments.</a>
      </h2>
<p id="appendix-B-1">As described in <span><a href="#RFC4364" class="internal xref">BGP VPN</a> [<a href="#RFC4364" class="cite xref">RFC4364</a>]</span> Section 10, in
      an Option C network, service routes (VPN-IPv4) are neither maintained
      nor distributed by the ASBRs. Transport routes are maintained in the
      ASBRs and propagated in BGP LU or BGP CT.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2"><span><a href="#CTProc" class="internal xref">Illustration of CT Procedures</a> (<a href="#CTProc" class="auto internal xref">Section 8</a>)</span>
      illustrates how constructs of BGP CT work in an inter-AS Option C
      deployment. The BGP CT constructs: AFI/SAFI 1/76, Transport Class and
      Resolution Scheme are used in an inter-AS Option C deployment.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">In Intra-AS and Inter-AS option A, option B scenarios, AFI/SAFI 1/76
      may not be used, but the Transport Class and Resolution Scheme
      mechanisms are used to provide service mapping.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">This section illustrates how BGP CT constructs work in Intra-AS and
      Inter-AS Option A, B deployment scenarios.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<section id="appendix-B.1">
        <h3 id="name-intra-as-usecase">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-intra-as-usecase" class="section-name selfRef">Intra-AS usecase</a>
        </h3>
<section id="appendix-B.1.1">
          <h4 id="name-topology">
<a href="#appendix-B.1.1" class="section-number selfRef">B.1.1. </a><a href="#name-topology" class="section-name selfRef">Topology</a>
          </h4>
<span id="name-bgp-ct-intra-as"></span><div id="BGPCT_INTRA_AS">
<figure id="figure-14">
            <div id="appendix-B.1.1-1.1">
              <div class="alignLeft art-svg artwork" id="appendix-B.1.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="208" width="440" viewBox="0 0 440 208" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 200,48 L 200,64" fill="none" stroke="black"></path>
                  <path d="M 56,80 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 128,80 L 176,80" fill="none" stroke="black"></path>
                  <path d="M 216,80 L 256,80" fill="none" stroke="black"></path>
                  <path d="M 312,80 L 352,80" fill="none" stroke="black"></path>
                  <path d="M 112,176 L 136,176" fill="none" stroke="black"></path>
                  <path d="M 296,176 L 328,176" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="336,176 324,170.4 324,181.6" fill="black" transform="rotate(0,328,176)"></polygon>
                  <g class="text">
                    <text x="204" y="36">[RR11]</text>
                    <text x="28" y="84">[CE21]</text>
                    <text x="100" y="84">[PE11]</text>
                    <text x="196" y="84">[P1]</text>
                    <text x="284" y="84">[PE12]</text>
                    <text x="380" y="84">[CE31]</text>
                    <text x="72" y="116">:</text>
                    <text x="312" y="116">:</text>
                    <text x="32" y="132">AS2</text>
                    <text x="72" y="132">:</text>
                    <text x="200" y="132">...AS1...</text>
                    <text x="312" y="132">:</text>
                    <text x="368" y="132">AS3</text>
                    <text x="72" y="148">:</text>
                    <text x="312" y="148">:</text>
                    <text x="52" y="180">203.0.113.21</text>
                    <text x="176" y="180">Traffic</text>
                    <text x="248" y="180">Direction</text>
                    <text x="388" y="180">203.0.113.31</text>
                  </g>
                </svg><a href="#appendix-B.1.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-bgp-ct-intra-as" class="selfRef">BGP CT Intra-AS</a>
            </figcaption></figure>
</div>
<p id="appendix-B.1.1-2">This example in <a href="#BGPCT_INTRA_AS" class="auto internal xref">Figure 14</a> shows a provider
          network Autonomous system AS1. It serves customers AS2, AS3. Traffic
          direction being described is CE21 to CE31. CE31 may request a
          specific SLA (e.g. Gold for this traffic), when traversing this
          provider network.<a href="#appendix-B.1.1-2" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.1.2">
          <h4 id="name-transport-layer">
<a href="#appendix-B.1.2" class="section-number selfRef">B.1.2. </a><a href="#name-transport-layer" class="section-name selfRef">Transport Layer</a>
          </h4>
<p id="appendix-B.1.2-1">AS1 uses RSVP-TE intra-domain tunnels between PE11 and PE12. And
          LDP tunnels for best effort traffic.<a href="#appendix-B.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1.2-2">The network has two Transport classes: Gold with Transport Class
          ID 100, Bronze with Transport Class ID 200. These transport classes
          are provisioned at the PEs. This creates the Resolution Schemes for
          these transport classes at these PEs.<a href="#appendix-B.1.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1.2-3">Following tunnels exist for Gold transport class.<a href="#appendix-B.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B.1.2-4.1">
              <p id="appendix-B.1.2-4.1.1">PE11_to_PE12_gold - RSVP-TE tunnel<a href="#appendix-B.1.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.1.2-4.2">
              <p id="appendix-B.1.2-4.2.1">PE12_to_PE11_gold - RSVP-TE tunnel<a href="#appendix-B.1.2-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.1.2-5">Following tunnels exist for Bronze transport class.<a href="#appendix-B.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B.1.2-6.1">
              <p id="appendix-B.1.2-6.1.1">PE11_to_PE12_bronze - RSVP-TE tunnel<a href="#appendix-B.1.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.1.2-6.2">
              <p id="appendix-B.1.2-6.2.1">PE11_to_PE12_bronze - RSVP-TE tunnel<a href="#appendix-B.1.2-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.1.2-7">These tunnels are provisioned to belong to transport class 100 or
          200.<a href="#appendix-B.1.2-7" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.1.3">
          <h4 id="name-service-layer-route-exchange">
<a href="#appendix-B.1.3" class="section-number selfRef">B.1.3. </a><a href="#name-service-layer-route-exchange" class="section-name selfRef">Service Layer route exchange</a>
          </h4>
<p id="appendix-B.1.3-1">Service nodes PE11, PE12 negotiate service families (AFI/SAFI
          1/128) on the BGP session with RR11. Service helper RR11 reflects
          service routes between the two PEs with next hop unchanged. There
          are no tunnels for transport-class 100 or 200 from RR11 to the
          PEs.<a href="#appendix-B.1.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1.3-2">Forwarding happens using service routes at service nodes PE11,
          PE12. Routes received from CEs are not present in any other nodes'
          FIB in the provider network.<a href="#appendix-B.1.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1.3-3">CE31 advertises a route for example prefix 203.0.113.31 with next
          hop self to PE12. CE31 can attach a Mapping Community Color:0:100 on
          this route, to indicate its request for Gold SLA. Or, PE12 can
          attach the same using locally configured policies.<a href="#appendix-B.1.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1.3-4">Consider, CE31 is getting VPN service from PE12. The
          RD:203.0.113.31 route is readvertised in AFI/SAFI 1/128 by PE12 with
          next hop self (192.0.2.12) and label V-L1, to RR11 with the Mapping
          Community Color:0:100 attached. This AFI/SAFI 1/128 route reaches
          PE11 via RR11 with the next hop unchanged as PE12 and label V-L1.
          Now PE11 can resolve the PNH 192.0.2.12 using PE11_to_PE12_gold RSVP
          TE LSP.<a href="#appendix-B.1.3-4" class="pilcrow">¶</a></p>
<p id="appendix-B.1.3-5">The IP FIB at PE11 VRF will have a route for 203.0.113.31 with a
          next hop when resolved using Resolution Scheme belonging to the
          mapping community Color:0:100, points to a PE11_to_PE12_gold
          tunnel.<a href="#appendix-B.1.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.1.3-6">BGP CT AFI/SAFI 1/76 is not used in this Intra-AS deployment. But
          the Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.<a href="#appendix-B.1.3-6" class="pilcrow">¶</a></p>
</section>
</section>
<section id="appendix-B.2">
        <h3 id="name-inter-as-option-a-usecase">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-inter-as-option-a-usecase" class="section-name selfRef">Inter-AS option A usecase</a>
        </h3>
<section id="appendix-B.2.1">
          <h4 id="name-topology-2">
<a href="#appendix-B.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-topology-2" class="section-name selfRef">Topology</a>
          </h4>
<span id="name-bgp-ct-inter-as-option-a"></span><div id="BGPCT_INTERAS_A">
<figure id="figure-15">
            <div id="appendix-B.2.1-1.1">
              <div class="alignLeft art-svg artwork" id="appendix-B.2.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="624" viewBox="0 0 624 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 168,48 L 168,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 L 408,64" fill="none" stroke="black"></path>
                  <path d="M 56,80 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 128,80 L 152,80" fill="none" stroke="black"></path>
                  <path d="M 192,80 L 216,80" fill="none" stroke="black"></path>
                  <path d="M 288,80 L 304,80" fill="none" stroke="black"></path>
                  <path d="M 376,80 L 392,80" fill="none" stroke="black"></path>
                  <path d="M 432,80 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 504,80 L 528,80" fill="none" stroke="black"></path>
                  <path d="M 184,176 L 232,176" fill="none" stroke="black"></path>
                  <path d="M 376,176 L 424,176" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="432,176 420,170.4 420,181.6" fill="black" transform="rotate(0,424,176)"></polygon>
                  <g class="text">
                    <text x="172" y="36">[RR11]</text>
                    <text x="412" y="36">[RR21]</text>
                    <text x="28" y="84">[CE31]</text>
                    <text x="100" y="84">[PE11]</text>
                    <text x="172" y="84">[P1]</text>
                    <text x="252" y="84">[ASBR11]</text>
                    <text x="340" y="84">[ASBR21]</text>
                    <text x="412" y="84">[P2]</text>
                    <text x="476" y="84">[PE21]</text>
                    <text x="556" y="84">[CE41]</text>
                    <text x="72" y="116">:</text>
                    <text x="296" y="116">:</text>
                    <text x="512" y="116">:</text>
                    <text x="32" y="132">AS3</text>
                    <text x="72" y="132">:</text>
                    <text x="200" y="132">..AS1..</text>
                    <text x="296" y="132">:</text>
                    <text x="376" y="132">..AS2..</text>
                    <text x="512" y="132">:</text>
                    <text x="560" y="132">AS4</text>
                    <text x="72" y="148">:</text>
                    <text x="296" y="148">:</text>
                    <text x="512" y="148">:</text>
                    <text x="52" y="180">203.0.113.31</text>
                    <text x="264" y="180">Traffic</text>
                    <text x="336" y="180">Direction</text>
                    <text x="572" y="180">203.0.113.41</text>
                  </g>
                </svg><a href="#appendix-B.2.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-bgp-ct-inter-as-option-a" class="selfRef">BGP CT Inter-AS option A</a>
            </figcaption></figure>
</div>
<p id="appendix-B.2.1-2">This example in <a href="#BGPCT_INTERAS_A" class="auto internal xref">Figure 15</a> shows two
          provider network Autonomous systems AS1, AS2. They serve L3VPN
          customers AS3, AS4 respectively. The ASBRs ASBR11 and ASBR21 have IP
          VRFs connected directly. The inter-AS link is IP enabled with no
          MPLS forwarding.<a href="#appendix-B.2.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2.1-3">Traffic direction being described is CE31 to CE41. CE41 may
          request a specific SLA (e.g. Gold for this traffic), when traversing
          these provider core networks.<a href="#appendix-B.2.1-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.2.2">
          <h4 id="name-transport-layer-2">
<a href="#appendix-B.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-transport-layer-2" class="section-name selfRef">Transport Layer</a>
          </h4>
<p id="appendix-B.2.2-1">AS1 uses RSVP-TE intra-domain tunnels between PE11 and ASBR11.
          And LDP tunnels for best effort traffic. AS2 uses SRTE intra-domain
          tunnels between ASBR21 and PE21, and L-ISIS for best effort
          tunnels.<a href="#appendix-B.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.2-2">The networks have two Transport classes: Gold with Transport
          Class ID 100, Bronze with Transport Class ID 200. These transport
          classes are provisioned at the PEs and ASBRs. This creates the
          Resolution Schemes for these transport classes at these PEs and
          ASBRs.<a href="#appendix-B.2.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2.2-3">Following tunnels exist for Gold transport class.<a href="#appendix-B.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B.2.2-4.1">
              <p id="appendix-B.2.2-4.1.1">PE11_to_ASBR11_gold - RSVP-TE tunnel<a href="#appendix-B.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.2.2-4.2">
              <p id="appendix-B.2.2-4.2.1">ASBR11_to_PE11_gold - RSVP-TE tunnel<a href="#appendix-B.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.2.2-4.3">
              <p id="appendix-B.2.2-4.3.1">PE21_to_ASBR21_gold - SRTE tunnel<a href="#appendix-B.2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.2.2-4.4">
              <p id="appendix-B.2.2-4.4.1">ASBR21_to_PE21_gold - SRTE tunnel<a href="#appendix-B.2.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.2.2-5">Following tunnels exist for Bronze transport class.<a href="#appendix-B.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B.2.2-6.1">
              <p id="appendix-B.2.2-6.1.1">PE11_to_ASBR11_bronze - RSVP-TE tunnel<a href="#appendix-B.2.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.2.2-6.2">
              <p id="appendix-B.2.2-6.2.1">ASBR11_to_PE11_bronze - RSVP-TE tunnel<a href="#appendix-B.2.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.2.2-6.3">
              <p id="appendix-B.2.2-6.3.1">PE21_to_ASBR21_bronze - SRTE tunnel<a href="#appendix-B.2.2-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.2.2-6.4">
              <p id="appendix-B.2.2-6.4.1">ASBR21_to_PE21_bronze - SRTE tunnel<a href="#appendix-B.2.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.2.2-7">These tunnels are provisioned to belong to transport class 100 or
          200.<a href="#appendix-B.2.2-7" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.2.3">
          <h4 id="name-service-layer-route-exchange-2">
<a href="#appendix-B.2.3" class="section-number selfRef">B.2.3. </a><a href="#name-service-layer-route-exchange-2" class="section-name selfRef">Service Layer route exchange</a>
          </h4>
<p id="appendix-B.2.3-1">Service nodes PE11, ASBR11 negotiate service family (AFI/SAFI
          1/128) on the BGP session with RR11. Service helper RR11 reflects
          service routes between the PE11 and ASBR11 with next hop
          unchanged.<a href="#appendix-B.2.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-2">Similarly, in AS2 PE21, ASBR21 negotiate service family (AFI/SAFI
          1/128) on the BGP session with RR21, which reflects service routes
          between the PE21 and ASBR21 with next hop unchanged.<a href="#appendix-B.2.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-3">CE41 advertises a route for example prefix 203.0.113.41 with next
          hop self to PE21 VRF. CE41 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE21 can attach the same using locally configured policies.<a href="#appendix-B.2.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-4">Consider, CE41 is getting VPN service from PE21. The
          RD:203.0.113.41 route is readvertised in AFI/SAFI 1/128 by PE21 with
          next hop self (203.0.113.21) and label V-L1 to RR21 with the Mapping
          Community Color:0:100 attached. This AFI/SAFI 1/128 route reaches
          ASBR21 via RR21 with the next hop unchanged as PE21 and label V-L1.
          Now ASBR21 can resolve the PNH 203.0.113.21 using
          ASBR21_to_PE21_gold SRTE LSP.<a href="#appendix-B.2.3-4" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-5">The IP FIB at ASBR21 VRF will have a route for 203.0.113.41 with
          a next hop resolved using Resolution Scheme associated with mapping
          community Color:0:100, pointing to ASBR21_to_PE21_gold tunnel.<a href="#appendix-B.2.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-6">This route is readvertised with next hop self by ASBR21 to ASBR11
          on BGP session in the VRF. The single-hop EBGP session endpoints are
          interface addresses. ASBR21 and ASBR11 act like a CE to each other.
          The previously mentioned process repeats in AS1, until the route
          reaches PE11 and resolves over PE11_to_ASBR11_gold RSVP TE
          tunnel.<a href="#appendix-B.2.3-6" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-7">Traffic traverses as unlabeled IP packet on the following legs:
          CE31-PE11, ASBR11-ASBR21, PE21-CE41. And uses MPLS forwarding inside
          AS1, AS2 core.<a href="#appendix-B.2.3-7" class="pilcrow">¶</a></p>
<p id="appendix-B.2.3-8">BGP CT AFI/SAFI 1/76 is not used in this Inter-AS Option B
          deployment. But the Transport class and Resolution Scheme constructs
          are used to preserve end-to-end SLA.<a href="#appendix-B.2.3-8" class="pilcrow">¶</a></p>
</section>
</section>
<section id="appendix-B.3">
        <h3 id="name-inter-as-option-b-usecase">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-inter-as-option-b-usecase" class="section-name selfRef">Inter-AS option B usecase</a>
        </h3>
<section id="appendix-B.3.1">
          <h4 id="name-topology-3">
<a href="#appendix-B.3.1" class="section-number selfRef">B.3.1. </a><a href="#name-topology-3" class="section-name selfRef">Topology</a>
          </h4>
<span id="name-bgp-ct-inter-as-option-b"></span><div id="BGPCT_INTERAS_B">
<figure id="figure-16">
            <div id="appendix-B.3.1-1.1">
              <div class="alignLeft art-svg artwork" id="appendix-B.3.1-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="192" width="584" viewBox="0 0 584 192" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 168,48 L 168,64" fill="none" stroke="black"></path>
                  <path d="M 408,48 L 408,64" fill="none" stroke="black"></path>
                  <path d="M 56,80 L 72,80" fill="none" stroke="black"></path>
                  <path d="M 128,80 L 152,80" fill="none" stroke="black"></path>
                  <path d="M 192,80 L 216,80" fill="none" stroke="black"></path>
                  <path d="M 288,80 L 304,80" fill="none" stroke="black"></path>
                  <path d="M 376,80 L 392,80" fill="none" stroke="black"></path>
                  <path d="M 432,80 L 448,80" fill="none" stroke="black"></path>
                  <path d="M 504,80 L 528,80" fill="none" stroke="black"></path>
                  <path d="M 184,176 L 208,176" fill="none" stroke="black"></path>
                  <path d="M 368,176 L 400,176" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="408,176 396,170.4 396,181.6" fill="black" transform="rotate(0,400,176)"></polygon>
                  <g class="text">
                    <text x="172" y="36">[RR13]</text>
                    <text x="412" y="36">[RR23]</text>
                    <text x="28" y="84">[CE31]</text>
                    <text x="100" y="84">[PE11]</text>
                    <text x="172" y="84">[P1]</text>
                    <text x="252" y="84">[ASBR12]</text>
                    <text x="340" y="84">[ASBR21]</text>
                    <text x="412" y="84">[P2]</text>
                    <text x="476" y="84">[PE22]</text>
                    <text x="556" y="84">[CE41]</text>
                    <text x="72" y="116">:</text>
                    <text x="296" y="116">:</text>
                    <text x="512" y="116">:</text>
                    <text x="32" y="132">AS3</text>
                    <text x="72" y="132">:</text>
                    <text x="200" y="132">..AS1..</text>
                    <text x="296" y="132">:</text>
                    <text x="376" y="132">..AS2..</text>
                    <text x="512" y="132">:</text>
                    <text x="560" y="132">AS4</text>
                    <text x="72" y="148">:</text>
                    <text x="296" y="148">:</text>
                    <text x="512" y="148">:</text>
                    <text x="52" y="180">203.0.113.31</text>
                    <text x="248" y="180">Traffic</text>
                    <text x="320" y="180">Direction</text>
                    <text x="524" y="180">203.0.113.41</text>
                  </g>
                </svg><a href="#appendix-B.3.1-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-bgp-ct-inter-as-option-b" class="selfRef">BGP CT Inter-AS option B</a>
            </figcaption></figure>
</div>
<p id="appendix-B.3.1-2">This example in <a href="#BGPCT_INTERAS_B" class="auto internal xref">Figure 16</a> shows two
          provider network Autonomous systems AS1 and AS2. They serve L3VPN
          customers AS3 and AS4 respectively. The ASBRs ASBR12 and ASBR21
          don't have any IP VRFs. The inter-AS link is MPLS forwarding
          enabled.<a href="#appendix-B.3.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3.1-3">Traffic direction being described is CE31 to CE41. CE41 may
          request a specific SLA (e.g. Gold for this traffic), when traversing
          these provider core networks.<a href="#appendix-B.3.1-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.3.2">
          <h4 id="name-transport-layer-3">
<a href="#appendix-B.3.2" class="section-number selfRef">B.3.2. </a><a href="#name-transport-layer-3" class="section-name selfRef">Transport Layer</a>
          </h4>
<p id="appendix-B.3.2-1">AS1 uses RSVP-TE intra-domain tunnels between PE11 and ASBR21.
          And LDP tunnels for best effort traffic. AS2 uses SRTE intra-domain
          tunnels between ASBR21 and PE22, and L-ISIS for best effort
          tunnels.<a href="#appendix-B.3.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.2-2">The networks have two Transport classes: Gold with Transport
          Class ID 100, Bronze with Transport Class ID 200. These transport
          classes are provisioned at the PEs and ASBRs. This creates the
          Resolution Schemes for these transport classes at these PEs and
          ASBRs.<a href="#appendix-B.3.2-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3.2-3">Following tunnels exist for Gold transport class.<a href="#appendix-B.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B.3.2-4.1">
              <p id="appendix-B.3.2-4.1.1">PE11_to_ASBR12_gold - RSVP-TE tunnel<a href="#appendix-B.3.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.3.2-4.2">
              <p id="appendix-B.3.2-4.2.1">ASBR12_to_PE11_gold - RSVP-TE tunnel<a href="#appendix-B.3.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.3.2-4.3">
              <p id="appendix-B.3.2-4.3.1">PE22_to_ASBR21_gold - SRTE tunnel<a href="#appendix-B.3.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.3.2-4.4">
              <p id="appendix-B.3.2-4.4.1">ASBR21_to_PE22_gold - SRTE tunnel<a href="#appendix-B.3.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.3.2-5">Following tunnels exist for Bronze transport class.<a href="#appendix-B.3.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-B.3.2-6.1">
              <p id="appendix-B.3.2-6.1.1">PE11_to_ASBR12_bronze - RSVP-TE tunnel<a href="#appendix-B.3.2-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.3.2-6.2">
              <p id="appendix-B.3.2-6.2.1">ASBR12_to_PE11_bronze - RSVP-TE tunnel<a href="#appendix-B.3.2-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.3.2-6.3">
              <p id="appendix-B.3.2-6.3.1">PE22_to_ASBR21_bronze - SRTE tunnel<a href="#appendix-B.3.2-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal ulEmpty" id="appendix-B.3.2-6.4">
              <p id="appendix-B.3.2-6.4.1">ASBR21_to_PE22_bronze - SRTE tunnel<a href="#appendix-B.3.2-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="appendix-B.3.2-7">These tunnels are provisioned to belong to transport class 100 or
          200.<a href="#appendix-B.3.2-7" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B.3.3">
          <h4 id="name-service-layer-route-exchange-3">
<a href="#appendix-B.3.3" class="section-number selfRef">B.3.3. </a><a href="#name-service-layer-route-exchange-3" class="section-name selfRef">Service Layer route exchange</a>
          </h4>
<p id="appendix-B.3.3-1">Service nodes PE11, ASBR12 negotiate service family (AFI/SAFI
          1/128) on the BGP session with RR13. Service helper RR13 reflects
          service routes between the PE11 and ASBR12 with next hop
          unchanged.<a href="#appendix-B.3.3-1" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-2">Similarly, in AS2 PE22, ASBR21 negotiate service family (AFI/SAFI
          1/128) on the BGP session with RR23, which reflects service routes
          between the PE22 and ASBR21 with next hop unchanged.<a href="#appendix-B.3.3-2" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-3">ASBR21 and ASBR12 negotiate AFI/SAFI 1/128 between them, and
          readvertise L3VPN routes with next hop self, allocating new labels.
          The single-hop EBGP session endpoints are interface addresses.<a href="#appendix-B.3.3-3" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-4">CE41 advertises a route for example prefix 203.0.113.41 with next
          hop self to PE22 VRF. CE41 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE22 can attach the same using locally configured policies.<a href="#appendix-B.3.3-4" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-5">Consider, CE41 is getting VPN service from PE22. The
          RD:203.0.113.41 route is readvertised in AFI/SAFI 1/128 by PE22 with
          next hop self (192.0.2.22) and label V-L1 to RR23 with the Mapping
          Community Color:0:100 attached. This AFI/SAFI 1/128 route reaches
          ASBR21 via RR23 with the next hop unchanged as PE22 and label V-L1.
          Now ASBR21 can resolve the PNH 192.0.2.22 using ASBR21_to_PE22_gold
          SRTE LSP.<a href="#appendix-B.3.3-5" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-6">Next, ASBR21 readvertises the RD:203.0.113.41 route with next hop
          self to ASBR12 with a newly allocated MPLS label V-L2. Forwarding
          for this label is installed to Swap V-L1, and Push labels for
          ASBR21_to_PE22_gold tunnel.<a href="#appendix-B.3.3-6" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-7">ASBR12 further readvertises the RD:203.0.113.41 route via RR13 to
          PE11 with next hop self 192.0.2.12. PE11 resolves the next hop
          192.0.2.12 over PE11_to_ASBR12_gold RSVP TE tunnel.<a href="#appendix-B.3.3-7" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-8">Traffic traverses as IP packet on the following legs: CE31-PE11
          and PE21-CE41. And uses MPLS forwarding on ASBR11-ASBR21 link, and
          inside AS1-AS2 core.<a href="#appendix-B.3.3-8" class="pilcrow">¶</a></p>
<p id="appendix-B.3.3-9">BGP CT AFI/SAFI 1/76 is not used in this Inter-AS Option B
          deployment. But the Transport class and Resolution Scheme constructs
          are used to preserve end-to-end SLA.<a href="#appendix-B.3.3-9" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<div id="Appendix_C">
<section id="appendix-C">
      <h2 id="name-why-reuse-rfc-8277-and-rfc-">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-why-reuse-rfc-8277-and-rfc-" class="section-name selfRef">Why reuse RFC 8277 and RFC 4364?</a>
      </h2>
<p id="appendix-C-1">RFC 4364 is one of the key design patterns produced by networking
      industry. It introduced virtualization and allowed sharing of resources
      in service provider space with multiple tenant networks, providing
      isolated and secure Layer3 VPN services. This design pattern has been
      reused since to provide other service layer virtualizations like Layer2
      virtualization (VPLS, L2VPN, EVPN), ISO virtualization, ATM
      virtualization, Flowspec VPN.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">It is to be noted that these services have different NLRI encoding.
      L3VPN Service family that binds MPLS label to an IP prefix use RFC 8277
      encoding, and others define different NLRI encodings.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">BGP CT reuses RFC 4364 procedures to slice a transport network into
      multiple transport planes that different service routes can bind to,
      using color.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">BGP CT reuses RFC 8277 because it precisely fits the purpose. viz. In
      a MPLS network, BGP CT needs to bind MPLS label for transport endpoints
      which are IPv4 or IPv6 endpoints, and disambiguate between multiple
      instances of those endpoints in multiple transport planes. Hence, use of
      RD:IP_Prefix and carrying a Label for it as specified in RFC 8277 works
      well for this purpose.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">Another advantage of using the precise encoding as defined in RFC
      4364 and RFC 8277 is that it allows to interoperate with BGP speakers
      that support SAFI 128 for AFIs 1 or 2. This can be useful during
      transition, until all BGP speakers in the network support BGP CT.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<p id="appendix-C-6">In future, if RFC 8277 evolves into a typed NLRI, that does not carry
      Label in the NLRI, BGP CT will be compatible with that as-well. In
      essence, BGP CT encoding is compatible with existing deployed
      technologies (RFC 4364, RFC 8277) and will adapt to any changes RFC 8277
      mechanisms undergo in future.<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<p id="appendix-C-7">This approach leverages the benefits of time tested design patterns
      proposed in RFC 4364 and RFC 8277. Moreover, this approach greatly
      reduces operational training costs and protocol compatibility
      considerations, as it complements and works well with existing protocol
      machineries. This problem does not need reinventing the wheel with brand
      new NLRI and procedures.<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<p id="appendix-C-8">BGP CT design also avoids overloading RFC 8277 NLRI MPLS Label field
      with information related to non MPLS data plane, because it leads to
      backward compatibility issues.<a href="#appendix-C-8" class="pilcrow">¶</a></p>
<section id="appendix-C.1">
        <h3 id="name-update-packing-consideratio">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-update-packing-consideratio" class="section-name selfRef">Update packing considerations</a>
        </h3>
<p id="appendix-C.1-1">BGP CT carries transport class as an attribute. This means routes
        that don't share the same transport class cannot be packed into same
        Update message. Update packing in BGP CT will be similar to RFC 8277
        family routes carrying attributes like communities or extended
        communities. Service families like AFI/SAFI 1/128 have considerably
        more scale than transport families like AFI/SAFI 1/4 or AFI/SAFI 1/76,
        which carry only loopbacks. Update packing mechanisms that scale for
        AFI/SAFI 1/128 routes will scale similarly for AFI/SAFI 1/76 routes
        also.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">Section 6.3.2.1 of <span>[<a href="#Intent-Routing-Color" class="cite xref">Intent-Routing-Color</a>]</span> suggests
        scaling numbers for transport network where BGP CT can be deployed.
        Experiments were conducted with this scale to find the convergence
        time with BGP CT for those scaling numbers. Scenarios involving BGP CT
        carrying IPv4 and IPv6 endpoints with MPLS label were tested. Tests
        with BGP CT IPv6 endpoints and SRv6 SID are planned.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">Tests were conducted with 1.9 million BGP CT route scale (387K
        endpoints in 5 transport classes). Initial convergence time for all
        cases was less than 2 minutes, which compares favorably with user
        expectation for such a scale. This experiment proves that carrying
        transport class information as an attribute keeps BGP convergence
        within acceptable range. Details of the experiment and test results
        are available in <span><a href="#BGP-CT-UPDATE-PACKING-TEST" class="internal xref">BGP CT
        Update packing Test Results</a> [<a href="#BGP-CT-UPDATE-PACKING-TEST" class="cite xref">BGP-CT-UPDATE-PACKING-TEST</a>]</span>.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
<p id="appendix-C.1-4">Furthermore, even in today's BGP LU deployments each egress node
        originates BGP LU route for it's loopback, with some attributes like
        community identifying the originating node or region, and AIGP
        attribute. These attributes may be unique per egress node, thus do not
        help with update packing in transport layer family routes.<a href="#appendix-C.1-4" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Appendix_D">
<section id="appendix-D">
      <h2 id="name-scaling-using-bgp-mpls-name">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-scaling-using-bgp-mpls-name" class="section-name selfRef">Scaling using BGP MPLS Namespaces</a>
      </h2>
<p id="appendix-D-1">This document considers scaling scenario suggested in Section 6.3.2.1
      of <span>[<a href="#Intent-Routing-Color" class="cite xref">Intent-Routing-Color</a>]</span> where 300K nodes exist in the
      network with 5 transport classes.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">This may result in 1.5M transport layer routes and MPLS transit
      routes in all Border Nodes in the network, which may overwhelm the
      nodes' MPLS forwarding resources.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">Section 6.2 of <span>[<a href="#MPLS-NS" class="cite xref">MPLS-NS</a>]</span> describes how MPLS Namespaces
      mechanism is used to scale such a network. This approach reduces the
      number of PNHs that are globally visible in the network, thus reducing
      forwarding resource usage network wide. Service route state is kept
      confined closer to network edge, and any churn is confined within the
      region containing the point of failure, which improves convergence
      also.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Contributors">
<section id="appendix-E">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<div id="Co-Authors">
<section id="appendix-E.1">
        <h3 id="name-co-authors">
<a href="#name-co-authors" class="section-name selfRef">Co-Authors</a>
        </h3>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Reshma Das</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dreshma@juniper.net" class="email">dreshma@juniper.net</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Israel Means</span></div>
<div dir="auto" class="left"><span class="org">AT&amp;T</span></div>
<div dir="auto" class="left"><span class="street-address">2212 Avenida Mara,</span></div>
<div dir="auto" class="left">
<span class="locality">Chula Vista</span>, <span class="region">California</span> <span class="postal-code">91914</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:israel.means@att.com" class="email">israel.means@att.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Csaba Mate</span></div>
<div dir="auto" class="left"><span class="org">KIFU, Hungarian NREN</span></div>
<div dir="auto" class="left"><span class="locality">Budapest</span></div>
<div dir="auto" class="left"><span class="street-address">35 Vaci street,</span></div>
<div dir="auto" class="left"><span class="postal-code">1134</span></div>
<div dir="auto" class="left"><span class="country-name">Hungary</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@nop.hu" class="email">ietf@nop.hu</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Deepak J Gowda</span></div>
<div dir="auto" class="left"><span class="org">Extreme Networks</span></div>
<div dir="auto" class="left"><span class="street-address">55 Commerce Valley Drive West, Suite 300,</span></div>
<div dir="auto" class="left">
<span class="locality">Thornhill, Toronto,</span> <span class="region">Ontario</span> <span class="postal-code">L3T 7V9</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dgowda@extremenetworks.com" class="email">dgowda@extremenetworks.com</a>
</div>
</address>
</section>
</div>
<div id="Other_Contributors">
<section id="appendix-E.2">
        <h3 id="name-other-contributors">
<a href="#name-other-contributors" class="section-name selfRef">Other Contributors</a>
        </h3>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Balaji Rajagopalan</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Electra, Exora Business Park~Marathahalli - Sarjapur Outer Ring Road,</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560103</span>
</div>
<div dir="auto" class="left"><span class="region">KA</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:balajir@juniper.net" class="email">balajir@juniper.net</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Rajesh M</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Electra, Exora Business Park~Marathahalli - Sarjapur Outer Ring Road,</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560103</span>
</div>
<div dir="auto" class="left"><span class="region">KA</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mrajesh@juniper.net" class="email">mrajesh@juniper.net</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Chaitanya Yadlapalli</span></div>
<div dir="auto" class="left"><span class="org">AT&amp;T</span></div>
<div dir="auto" class="left"><span class="street-address">200 S Laurel Ave,</span></div>
<div dir="auto" class="left">
<span class="locality">Middletown,</span>, <span class="region">NJ</span> <span class="postal-code">07748</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cy098d@att.com" class="email">cy098d@att.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Mazen Khaddam</span></div>
<div dir="auto" class="left"><span class="org">Cox Communications Inc.</span></div>
<div dir="auto" class="left">
<span class="locality">Atlanta</span>, <span class="region">GA</span> </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mazen.khaddam@cox.com" class="email">mazen.khaddam@cox.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Rafal Jan Szarecki</span></div>
<div dir="auto" class="left"><span class="org">Google.</span></div>
<div dir="auto" class="left"><span class="street-address">1160 N Mathilda Ave, Bldg 5,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale,</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:szarecki@google.com" class="email">szarecki@google.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Xiaohu Xu</span></div>
<div dir="auto" class="left"><span class="org">China Mobile</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:xuxiaohu@cmss.chinamobile.com" class="email">xuxiaohu@cmss.chinamobile.com</a>
</div>
</address>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-F">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-F-1">The authors thank Jeff Haas, John Scudder, Susan Hares, Dongjie
      (Jimmy), Moses Nagarajah, Jeffrey (Zhaohui) Zhang, Joel Halpern,
      Jingrong Xie, Mohamed Boucadair, Greg Skinner, Simon Leinen, Navaneetha
      Krishnan, Ravi M R, Chandrasekar Ramachandran, Shradha Hegde, Colby
      Barth, Vishnu Pavan Beeram, Sunil Malali, William J Britto, R Shilpa,
      Ashish Kumar (FE), Sunil Kumar Rawat, Abhishek Chakraborty, Richard
      Roberts, Krzysztof Szarkowicz, John E Drake, Srihari Sangli, Jim Uttaro,
      Luay Jalil, Keyur Patel, Ketan Talaulikar, Dhananjaya Rao, Swadesh
      Agarwal, Robert Raszuk, Ahmed Darwish, Aravind Srinivas Srinivasa
      Prabhakar, Moshiko Nayman, Chris Tripp, Gyan Mishra, Vijay Kestur,
      Santosh Kolenchery for all the valuable discussions, constructive
      criticisms, and review comments.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">The decision to not reuse SAFI 128 and create a new address-family to
      carry these transport-routes was based on suggestion made by Richard
      Roberts and Krzysztof Szarkowicz.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
<p id="appendix-F-3">Thanks to John Scudder for showing us with example how the Figures 
      can be enhanced using SVG format.<a href="#appendix-F-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kaliraj Vairavakkalai (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kaliraj@juniper.net" class="email">kaliraj@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Natrajan Venkataraman (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:natv@juniper.net" class="email">natv@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
