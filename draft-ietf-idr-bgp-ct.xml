<?xml version="1.0" encoding="US-ASCII"?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>
<rfc category="exp" docName="draft-ietf-idr-bgp-ct-10" ipr="trust200902">
  <front>
    <title abbrev="BGP Classful Transport Planes">BGP Classful Transport
    Planes</title>

    <author fullname="Kaliraj Vairavakkalai" initials="K." role="editor"
            surname="Vairavakkalai">
      <organization>Juniper Networks, Inc.</organization>

      <address>
        <postal>
          <street>1133 Innovation Way,</street>

          <city>Sunnyvale</city>

          <region>CA</region>

          <code>94089</code>

          <country>US</country>
        </postal>

        <email>kaliraj@juniper.net</email>
      </address>
    </author>

    <author fullname="Natrajan Venkataraman" initials="N." role="editor"
            surname="Venkataraman">
      <organization>Juniper Networks, Inc.</organization>

      <address>
        <postal>
          <street>1133 Innovation Way,</street>

          <city>Sunnyvale</city>

          <region>CA</region>

          <code>94089</code>

          <country>US</country>
        </postal>

        <email>natv@juniper.net</email>
      </address>
    </author>

    <date day="05" month="07" year="2023" />

    <abstract>
      <t>This document specifies a mechanism, referred to as "Intent Driven
      Service Mapping", that uses BGP to express intent based association of
      overlay routes, with underlay routes having specific Traffic Engineering
      (TE) characteristics, that satisfy a certain Service Level Agreement
      (SLA). The document achieves this by defining new constructs, to group
      underlay routes with sufficienty similar TE characteristics into
      identifiable classes (Transport Class), that overlay routes use as an
      ordered set to resolve reachability (Resolution Scheme) towards service
      endpoints. These constructs can be used to realize the "IETF Network
      Slice" defined in TEAS Network Slices framework.</t>

      <t>This document specifies protocol procedures for BGP that enable
      dissemination of such service mapping information in a network that may
      span multiple cooperating administrative domains. These domains may be
      administered either by the same provider or by closely coordinating
      providers. A new BGP address family that leverages RFC-4364 procedures
      and follows RFC-8277 NLRI encoding, is defined to advertise underlay
      routes with its identified class. This new address family is called "BGP
      Classful Transport", a.k.a., BGP CT.</t>
    </abstract>
  </front>

  <middle>
    <section title="Introduction">
      <t>Provider networks, typically span across multiple domains where, each
      domain can either represent an Autonomous system (AS) or an Interior
      Gateway Protocol (IGP) region within an AS. In these networks, several
      services are provisioned between different pairs of service endpoints
      (e.g., Provider Edge (PE) nodes), that can either be in the same domain
      or across different domains.</t>

      <t>This document realizes "Intent" as defined in <xref target="RFC9315">
      </xref> and prescribes constructs and procedures that enable provider
      networks to be able to forward service traffic based on service specific
      intent, end-to-end across service endpoints.</t>

      <t>The mechanisms described in this document achieve "Intent Driven
      Service Mapping" between any pair of service endpoints by:<list>
          <t>provisioning end-to-end "intent-aware" paths (e.g., low latency
          path, best effort path) using BGP,</t>

          <t>expressing a desired intent (e.g., use low latency path with
          fallback to best effort path), and</t>

          <t>forwarding service traffic "only" using end-to-end "intent-aware"
          paths honoring that desired intent.</t>
        </list></t>

      <t>The constructs and procedures defined in this document apply
      homogenously to Intra-AS as well as Inter-AS Option A, Option B, and
      Option C style deployments <xref target="RFC4364"></xref> in provider
      networks.</t>

      <t>Provider networks that are deployed using such styles, provision
      intra-domain transport tunnels between a pair of endpoints, typically a
      service node or a border node, that service traffic use to traverse that
      domain. These tunnels are signaled using various tunneling protocols
      depending on the forwarding engineering choices of the domain, which can
      be Multi Protocol Label Switching (MPLS), Internet Protocol version 4
      (IPv4), or Internet Protocol version 6 (IPv6).</t>

      <t>The mechanisms defined in this document are agnostic to the tunneling
      mechanisms. These can be applied homogenously to intra-domain tunneling
      technologies used in brownfield networks (e.g., MPLS Traffic Engineering
      (TE)) as well as greenfield networks (e.g., Segment Routing (SR)).</t>

      <t>The constructs defined in this document can be used to classify and
      group these intra-domain tunnels based upon their TE charecteristics
      (e.g., low latency), into identifiable classes, thus making them
      "intent-aware". These constructs enable services to express their
      desired intent using one or more identifiable classes, and to
      selectively map traffic onto "intent-aware" intra-domain tunnels only
      within the scope of these classes.</t>

      <t>This document introduces a new BGP address family known as "BGP
      Classful Transport" that extends/stitches intent-aware intra-domain
      tunnels that belong to the same class across domain boundaries, to
      establish end-to-end intent-aware paths between service endpoints.</t>

      <t><xref target="Intent-Routing-Color"></xref> describes various use
      cases and applications of the procedures described in this document.</t>
    </section>

    <section title="Terminology">
      <section title="Requirements Language">
        <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in BCP
        14 <xref target="RFC2119">RFC 2119</xref> <xref target="RFC8174">RFC
        8174</xref> when, and only when, they appear in all capitals, as shown
        here.</t>
      </section>

      <section title="Acronyms">
        <t>AFI: Address Family Identifier</t>

        <t>LSP: Label Switched Path</t>

        <t>NLRI: Network Layer Reachability Information</t>

        <t>TE: Traffic Engineering</t>

        <t>TC: Transport Class</t>

        <t>SAFI: Subsequent Address Family Identifier</t>

        <t>SN: Service Node</t>

        <t>eSN : Egress Service Node</t>

        <t>iSN: Ingress Service Node</t>

        <t>BN: Border Node</t>

        <t>TN: Transport Node, P-router</t>

        <t>BGP VPN: VPNs built using RFC4364 mechanisms.</t>

        <t>BGP LU: BGP Labeled Unicast family (SAFI 4)</t>

        <t>BGP CT: BGP Classful Transport family (SAFI 76)</t>

        <t>ASN: Autonomous System Number</t>

        <t>RT: Route Target Extended Community</t>

        <t>RD: Route-Distinguisher</t>

        <t>RTC: Route Target Constrain</t>

        <t>VRF: Virtual Router Forwarding Table</t>

        <t>CsC: Carrier serving Carrier VPN</t>

        <t>PNH: Protocol-Nexthop address carried in a BGP Update message</t>

        <t>MNH: BGP MultiNexthop attribute</t>

        <t>FEC: Forwarding Equivalence Class</t>

        <t>RSVP-TE: Resource Reservation Protocol - Traffic Engineering</t>

        <t>SR: Segment Routing</t>

        <t>SRTE: Segment Routing Traffic Engineering</t>

        <t>SID: SR Segment Identifier</t>

        <t>EP: Endpoint, a loopback address in the network</t>

        <t>SEP: Service Endpoint, the PNH of a Service route</t>

        <t>LPM: Longest Prefix Match</t>

        <t>SLA: Service Level Agreement</t>

        <t>EPE: Egress Peer Engineering</t>

        <t>UHP: Ultimate Hop Pop</t>

        <t>PHP: Penultimate Hop Pop</t>
      </section>

      <section title="Definitions">
        <t>The document makes use of the following terms:</t>

        <t><list style="hanging">
            <t hangText="Intent:">A set of operational goals (that a network
            should meet) and outcomes (that a network is supposed to deliver)
            defined in a declarative manner without specifying how to achieve
            or implement them.</t>

            <t hangText="Service Family:">BGP address family used for
            advertising routes for "data traffic" as opposed to tunnels (e.g.,
            SAFI 1 or 128).</t>

            <t hangText="Service Node:">A router that sends or receives BGP
            Service routes (e.g., SAFIs 1, 128) with self as nexthop.</t>

            <t hangText="Ingress Service Node:">A router that receives BGP
            Service routes (e.g., SAFIs 1, 128).</t>

            <t hangText="Egress Service Node:">A router that sends BGP Service
            routes (e.g., SAFIs 1, 128) with self as nexthop.</t>

            <t hangText="BN: Border Node:">A router that sends or receives BGP
            Transport routes (e.g., SAFI 4, 76) with self as nexthop.</t>

            <t hangText="Transport Family:">BGP address family used for
            advertising tunnels, which are in turn used by service routes for
            resolution (e.g., SAFI 4 or 76).</t>

            <t hangText="Transport Tunnel:">A tunnel over which a service may
            place traffic (e.g., GRE, UDP, LDP, RSVP-TE, IGP FLEX-ALGO or
            SRTE).</t>

            <t hangText="Tunnel Ingress Route:">Route to Tunnel
            Destination/Endpoint installed at the headend (ingress) of the
            tunnel by the tunneling protocol.</t>

            <t hangText="Tunnel Domain:">A domain of the network containing
            SNs and BNs under a single administrative control that has tunnels
            between them. An end-to-end tunnel spanning several adjacent
            tunnel domains can be created by "stitching" them together using
            labels.</t>

            <t hangText="Transport Class:">A construct to group transport
            tunnels offering the same SLA.</t>

            <t hangText="Transport Class RT:">A Route-Target extended
            community used to identify a specific Transport Class.</t>

            <t hangText="Transport Route Database (TRDB):">At the SN and BN, a
            Transport Class has an associated Transport Route Database that
            collects its tunnel ingress routes.</t>

            <t hangText="Resolution Scheme: ">A construct comprising of an
            ordered set of TRDBs to resolve next hop reachability, for
            realizing a desired Intent.</t>

            <t hangText="Mapping Community:">Any BGP
            Community/Extended-community on a BGP route that maps to a
            Resolution Scheme. E.g. color:0:100, transport-target:0:100.</t>

            <t hangText="Transport Plane: ">An end to end plane consisting of
            transport tunnels belonging to the same Transport Class. Tunnels
            of the same Transport Class are stitched together by BGP CT route
            readvertisements with nexthop self to enable Label-Swap forwarding
            across domain boundaries.</t>
          </list></t>
      </section>
    </section>

    <section title="Architecture Overview">
      <t>This document defines<xref target="tc">"Transport Class"</xref> and
      <xref target="Nexthop_Resoln_Schm">"Nexthop Resolution Scheme"</xref> as
      constructs to achieve end-to-end "Intent Driven Service Mapping".</t>

      <t>The tunneling protocols are made "Transport Class" aware. They
      publish their underlay routes for a Transport Class into an associated
      <xref target="trdb">"Transport Route Database" (TRDB)</xref>. These
      underlay routes are used to resolve overlay BGP routes. How exactly
      these intra-domain tunneling protocols are made Transport Class aware is
      outside the scope of this document.</t>

      <t>The underlay route in a TRDB can be advertised in BGP to extend an
      underlay tunnel to adjacent domains. A new BGP transport layer address
      family called "BGP Classful Transport", aka BGP CT (SAFI 76) is defined
      for this purpose. BGP CT makes it possible to advertise multiple tunnels
      to the same destination address, thus avoiding need of multiple
      loopbacks on the egress node.</t>

      <t>BGP CT family carries transport prefixes across tunnel domain
      boundaries (e.g. in Inter-AS Option-C networks), which is parallel to
      BGP LU (SAFI 4). It disseminates "Transport class" information for the
      transport prefixes across the participating domains, which is not
      possible with BGP LU. This makes the end-to-end network a "Transport
      Class" aware tunneled network.</t>

      <t>Service overlay routes carry sufficient indication of the desired
      Transport Classes in the form of a BGP community called the "Mapping
      community". The resolution infrastructure and the procedures for <xref
      target="Nexthop_Resoln_Schm">"Nexthop Resolution Scheme"</xref> defined
      in this document enable an ingress nodes to resolve overlay routes over
      the appropriate underlay tunnels only within the scope of the Transport
      Classes identified by the Mapping Community. The ingress node performs a
      Longest Prefix Match (LPM) on the next hop of the overlay route within
      the TRDBs the Reslution Scheme maps to. If the service overlay route is
      carried in BGP, the Protocol Next Hop (PNH) is carried as an attribute
      of the route.</t>

      <t>The PNH of the overlay route is also referred to as "Service
      Endpoint" (SEP). The SEP may either be located in the same domain as the
      service ingress node or be located in a different domain, which is
      either adjacent or non-adjacent. In the former case, reachability to a
      SEP is provided by an intra-domain tunneling protocol and in the latter
      case, reachability to a SEP is via BGP transport families like BGP LU
      (SAFI 4) or BGP CT (SAFI 76).</t>

      <t>This document in essence, describes mechanisms to: <list>
          <t>Model a "Transport Class" as a "TRDB" on a router and to collect
          tunnel ingress routes of a certain class.</t>

          <t>Enable service overlay routes carrying an appropriate "Mapping
          Community" to resolve its reachability for a SEP within the
          resolution scope (TRDB) of an intended Transport Class.</t>

          <t>Advertise tunnel underlay routes present in a Transport Route
          Database in BGP without any path hiding using BGP VPN and Add-path
          procedures, such that service overlay routes in the receiving
          domains can also resolve over tunnels of the associated Transport
          Class.</t>

          <t>Provide a way for cooperating domains to reconcile any
          differences in extended community namespaces and interoperate
          between different intra-domain tunneling technologies in each
          domain.</t>
        </list></t>
    </section>

    <section anchor="tc" title="Transport Class">
      <t>Transport Class is a construct that groups transport tunnels offering
      similar SLA within the administrative domain of a provider network or
      closely coordinated provider networks. A Transport Class is identified
      by a unique 32-bit "Transport Class" identifier, that is assigned by the
      operator. This "Transport Class" identifier is encoded in the Transport
      Class RT, which is a new Route Target extended community.</t>

      <t>A Transport Class is configured at SNs and BNs with RD and RT
      attributes. Creation of a Transport Class instantiates its corresponding
      TRDB on that node.</t>

      <t>An operator may configure an SN/BN to classify a tunnel into an
      appropriate Transport Class. How exactly these tunnels are made
      Transport Class aware is implementation specific and outside the scope
      of this document. When a tunnel is made Transport Class aware, it causes
      the tunnel's ingress route to be installed in the corresponding TRDB of
      that Transport Class. These routes are used to resolve BGP routes
      including BGP CT, which may be further readvertised to adjacent domains
      to extend these tunnels.</t>

      <t>Alternatively, a SN/BN receiving the transport routes via BGP with
      sufficient signaling information to identify a Transport Class can
      associate those ingress routes to the corresponding Transport Class.
      E.g. for Classful Transport family (SAFI 76) routes, the Transport Class
      RT indicates the Transport Class. For BGP LU family (SAFI 4) routes,
      import processing based on Communities or Inter-AS source-peer may be
      used to place the route in the desired Transport Class.</t>

      <t>When the ingress route is received via <xref target="SRTE"></xref>
      with "Color:Endpoint" as the NLRI that encodes the Transport Class as an
      integer 'Color', the 'Color' is mapped to a Transport Class during the
      import processing. The SRTE ingress route for this 'Endpoint' is
      installed in the corresponding TRDB. The SRTE tunnel will be extended by
      a BGP CT advertisement with NLRI 'RD:Endpoint', Transport Class RT and a
      new label. The MPLS swap route thus installed for the new label will pop
      the label and forward the decapsulated traffic into the path determined
      by the SRTE route for further encapsulation.</t>

      <t><xref target="RFC8664"></xref> extends Path Computation Element
      Communication Protocol (PCEP) to carry SRTE Color. This color
      association learnt from PCEP is also mapped to a Transport Class thus
      associating the PCEP driven SRTE LSP with the desired Transport
      Class.</t>

      <t>Similarly, <xref target="PCEP-RSVP-COLOR"></xref> extends PCEP to
      carry RSVP Color. This color association learnt from PCEP is also mapped
      to a Transport Class thus associating the PCEP driven RSVP-TE LSP with
      the desired Transport Class.</t>

      <section anchor="tc-rt"
               title="&quot;Transport Class&quot; Route Target Extended Community">
        <t>This section defines a new type of Route Target, called "Transport
        Class" Route Target Extended Community.</t>

        <t>"Transport Class" Route Target Extended Community is a transitive
        extended community <xref target="RFC4360">EXT-COMM</xref> of extended
        type, which has the format as shown in <xref
        target="TCExtCom"></xref>.</t>

        <t>This new Route Target Format has the following encoding:</t>

        <figure anchor="TCExtCom" suppress-title="false"
                title="&quot;Transport Class&quot; Route Target Extended Community">
          <artwork align="left" xml:space="preserve"><![CDATA[
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type= 0xa   | SubType= 0x02 |            Reserved           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Transport Class ID                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

 Type: This 1-octet field MUST be set to 0xa

 SubType: This 1-octet field MUST be set to 0x2 to indicate 'Route Target'.

 Reserved: A 2-octet reserved bits.
         That MUST be set to zero on transmission.
         This field SHOULD be ignored on reception and left unaltered.

 Transport Class ID: This field is encoded in 4 octets.

    This field contains the "Transport Class" identifier,
    which is an unsigned 32-bit integer.

    This document reserves the Transport class ID value 0 to
    represent "Best Effort Transport Class ID".]]></artwork>
        </figure>

        <t>The VPN route import/export mecahnisms as specified in <xref
        target="RFC4364">BGP VPN</xref> and the Constrained Route Distribution
        mechanisms as specified in <xref target="RFC4684">Route Target
        Constraints</xref> can be applied to BGP CT routes using its Transport
        Class Route Target Extended community.</t>

        <t>A BGP speaker that implements RT Constraint <xref
        target="RFC4684">Route Target Constraints</xref> MUST apply the RT
        Constraint procedures to the Transport Class Route Target Extended
        community as well.</t>

        <t>The Transport Class Route Target Extended community is carried on
        Classful Transport family routes and is used to associate them with
        appropriate TRDBs at receiving BGP speakers.</t>

        <t>Defining a new type code for the Transport Class Route Target
        Extended community avoids conflicts with any VPN Route Target
        assignments already in use for service families.</t>
      </section>

      <section anchor="trdb" title="Transport Route Database">
        <t>A Transport Route Database is a logical collection of transport
        routes pertaining to the same Transport Class. Tunnel endpoint
        addresses in a TRDB belong to the "Provider Namespace" representing
        the core transport region.</t>

        <t>Overlay routes that require the use of a specific Transport Class
        confine the scope of next hop resolution to the set of routes
        contained in the corresponding TRDB.</t>

        <t>The TRDB can be for e.g., realized as a "Routing Table" referred in
        Section 9.1.2.1 of <xref target="RFC4271"></xref> which is a control
        plane only database. However, an implementation may choose a different
        methodology to realize this logical construct while still adhering
        with the procedures defined in this document.</t>

        <t>SNs or BNs originate routes for 'Classful Transport' address family
        from the TRDB. These routes have NLRI "RD:Endpoint", Transport Class
        RT and an MPLS label (or an identifier that represents an equivalent
        of a label in a different forwarding archietecture). 'Classful
        Transport' family routes received with Transport Class RT are imported
        into its corresponding TRDB.</t>
      </section>
    </section>

    <section anchor="Nexthop_Resoln_Schm" title="Resolution Scheme">
      <t>This section defines the Resolution Scheme construct that is used to
      specify how a service route or a BGP CT route can resolve its next hop
      using its associated Mapping Community over a specific TRDB or an
      ordered set of TRDBs.</t>

      <t>An implementation may provide an option for the service route to
      resolve over less preferred Transport Classes, should the resolution
      over a primary Transport Class fail.</t>

      <t>To accomplish this, the set of service routes may be associated with
      a user-configured "Resolution Scheme" that consists of the "Mapping
      Community" and the primary Transport Class, which is used to realize the
      desired intent. The Resolution Scheme may also be configured to include
      an ordered list of fallback Transport Classes.</t>

      <t>Mapping community is a "role" and not a new type of community; any
      BGP community or extended community may play this role. A Mapping
      Community maps to exactly one Resolution Scheme.</t>

      <t>An example of mapping community is "color:0:100", described in <xref
      target="RFC9012"></xref>, or the "transport-target:0:100" described in
      <xref target="tc-rt"></xref> in this document.</t>

      <t>A BGP route is associated with a resolution scheme during import
      processing. The first community on the route that matches a Mapping
      Community of a locally configured Resolution Scheme is considered the
      effective Mapping Community for the route. The Resolution Scheme thus
      found is used when resolving the route's PNH. If a route contains more
      than one Mapping Community, it indicates that the route considers these
      distinct Mapping Communities as equivalent in Intent. So, the first
      community that maps to a Resolution Scheme is chosen as the effective
      Mapping Community.</t>

      <t>A transport route received in BGP Classful Transport family SHOULD
      use a Resolution Scheme that contains only the primary Transport Class
      without any fallback to best effort tunnels. The primary Transport Class
      is identified by the Transport Class RT carried on the route. Thus,
      Transport Class RT serves as the Mapping Community for BGP CT
      routes.</t>

      <t>A service route received in a BGP service family MAY map to any
      user-configured Resolution Scheme that identifies the Mapping Community
      on the route.</t>
    </section>

    <section title="BGP Classful Transport Family">
      <t>The Classful Transport (CT) family will use the existing Address
      Family Identifier (AFI) of IPv4 or IPv6 and a new SAFI 76 "Classful
      Transport" that will applies to both IPv4 and IPv6 AFIs. These AFI/SAFI
      pair of values MUST be negotiated as per the Multiprotocol Extensions
      capability described in Section 8 of <xref target="RFC4760"></xref> to
      be able to send and receive BGP CT routes.</t>

      <t>The "Classful Transport" SAFI NLRI has similar encoding as specified
      in Section 2 of <xref target="RFC8277"></xref>.</t>

      <t>When AFI/SAFI is 1/76, the Classful Transport NLRI Prefix consists of
      an 8-byte RD followed by an IPv4 prefix. When AFI/SAFI is 2/76, the
      Classful Transport NLRI Prefix consists of an 8-byte RD followed by an
      IPv6 prefix.</t>

      <t>The procedures described for SAFIs 4 or 128 in section 2 of <xref
      target="RFC8277"></xref> apply for SAFI 76 as well. BGP CT routes may
      carry multiple labels in the NLRI, by negotiating the Multiple Labels
      Capability as described in section 2.1 of <xref
      target="RFC8277"></xref></t>

      <t>For convenience, <xref target="CT-NLRI"></xref> illustrates a BGP
      Classful Transport family NLRI when a single Label is advertised
      (Multiple Labels Capability is not negotiated):</t>

      <figure anchor="CT-NLRI" suppress-title="false"
              title="SAFI 76 &quot;Classful Transport&quot; NLRI Format">
        <artwork align="left" xml:space="preserve"><![CDATA[

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |                 Label                 |Rsrv |S|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                     Route Distinguisher (8 bytes)             |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     IPv4/IPv6 Prefix                          ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

 Length: 1 octet

    This field specifies the length in bits of the remainder of the NLRI field.

    Note that the length will always be the sum of 20 (number of bits
    in Label field), plus 3 (number of bits in Rsrv field), plus 1
    (number of bits in S field), plus the length in bits of the
    Prefix (RD:IP prefix).

    In an MP_REACH_NLRI attribute whose SAFI is 76, the Prefix
    (RD + IP prefix) will be 96 bits or less if the AFI is 1
    and will be 192 bits or less if the AFI is 2.

    As specified in [RFC4760], the actual length of the NLRI field
    will be the number of bits specified in the Length field, rounded
    up to the nearest integral number of octets.

 Label:

     The Label field is a 20-bit field containing an MPLS label value
     (see [RFC3032]).

 Rsrv:

     This 3-bit field SHOULD be set to zero on transmission and MUST be
     ignored on reception.

 S:
     When single label is advertised, this 1-bit field MUST be set to
     one on transmission and MUST be ignored on reception.


 Route Distinguisher:

     An 8-octet RD as defined in [RFC4364 Sec 4.2].

 IPv4/IPv6 Prefix:

    IPv4 prefix, if AFI/SAFI 1/76.
    IPv6 prefix, if AFI/SAFI 2/76.

]]></artwork>
      </figure>

      <t>Attributes on a Classful Transport route include the Transport Class
      Route Target extended community, which is used to associate the route
      with the correct TRDBs on SNs and BNs in the network and either an IPv4
      or an IPv6 next hop.</t>

      <t>When the length of the Next hop Address field is 4 the next hop
      address is of type IPv4 address.</t>

      <t>When the length of Next hop Address field is 16 (or 32) the next hop
      address is of type IPv6 address (potentially followed by the link-local
      IPv6 address of the next hop).</t>

      <t>When the length of Next hop Address field is 24 (or 48) the next hop
      address is of type VPN-IPv6 with an 8-octet RD set to zero (potentially
      followed by the link-local VPN-IPv6 address of the nexthop with an
      8-octet RD set to zero).</t>

      <t>When the length of the Next hop Address field is 12 the next hop
      address is of type VPN-IPv4 with 8-octet RD set to zero.</t>

      <section anchor="CTMultiEncap"
               title="Carrying multiple Encapsulation Information">
        <t>To ease interoperability between nodes supporting different
        forwarding technologies, a BGP CT route allows carrying multiple
        encapsulation information.</t>

        <t>An MPLS Label is carried using the encoding in <xref
        target="RFC8277"></xref> . A node that does not support MPLS
        forwarding advertises the special label 3 (Implicit Null) in the RFC
        8277 MPLS Label field.</t>

        <t>The SID information for SR with respect to MPLS Data Plane is
        carried as specified in Prefix SID attribute defined as part of
        section 3 in <xref target="RFC8669"></xref>.</t>

        <t>The SRv6 SID is carried using Prefix SID attribute as specified in
        <xref target="RFC9252"></xref>, without Transposition Scheme. The
        Transposition Length is set to 0 and Transposition Offset is set to 0
        to indicate nothing is transposed and that the entire SRv6 SID value
        is encoded in the SID Information Sub-TLV.</t>

        <t>UDP tunneling information is carried using Tunnel Encapsulation
        Attribute as specified in <xref target="RFC9012"></xref>.</t>
      </section>

      <section title="Comparison with Other Families using RFC-8277 Encoding">
        <t>SAFI 128 (MPLS-labeled VPN address) is an RFC8277 encoded family
        that carries service prefixes in the NLRI, where the prefixes come
        from the customer namespaces and are contextualized into separate user
        virtual service RIBs called VRFs as per [RFC4364].</t>

        <t>SAFI 4 (BGP LU) is an RFC8277 encoded family that carries transport
        prefixes in the NLRI, where the prefixes come from the provider
        namespace.</t>

        <t>SAFI 76 (Classful Transport SAFI) is an RFC8277 encoded family that
        carries transport prefixes in the NLRI, where the prefixes come from
        the provider namespace and are contextualized into separate TRDB as
        per RFC4364 procedures.</t>

        <t>It is worth noting that SAFI 128 has been used to carry transport
        prefixes in "L3VPN Inter-AS Carrier's carrier" scenario as defined in
        Section 10 of <xref target="RFC4364"></xref>, where BGP LU/LDP
        prefixes in CsC VRF are advertised in SAFI 128 towards the remote-end
        client carrier.</t>

        <t>In this document, SAFI 76 (BGP CT) is used instead of reusing SAFI
        128 (BGP VPN) to carry these transport routes because it is
        operationally advantageous to segregate transport and service prefixes
        into separate address families. For e.g., such an approach allows
        operators to safely enable "per-prefix" label allocation scheme for
        Classful Transport prefixes, typically with a space complexity of
        O(1K), without affecting SAFI 128 service prefixes, with a space
        complexity of O(1M). The "per prefix" label allocation scheme keeps
        the routing churn local during topology changes.</t>

        <t>A new SAFI also facilitates having a different readvertisement path
        of the transport family routes in a network than the service route
        readvertisement path. Service routes (Inet-VPN) are exchanged over an
        EBGP multihop session between ASes with nexthop unchanged; whereas
        Classful Transport routes are readvertised over EBGP single hop
        sessions with "nexthop self" rewrite over inter-AS links.</t>

        <t>The Classful Transport SAFI is similar in vein to BGP LU, in that
        it carries transport prefixes. The only difference is that it also
        carries in Route Target, an indication of which Transport Class the
        transport prefix belongs to and uses RD to disambiguate multiple
        instances of the same transport prefix in a BGP Update.</t>
      </section>

      <section title="Usage of Route Distinguisher and Label Allocation Modes">
        <t>RDs aid in troubleshooting provider networks that deploy BGP CT, by
        uniquely identifying the originator of a route across an
        administrative domain that may either span multiple domains within a
        provider network or span closely coordinated provider networks.</t>

        <t>The use of RDs also provides an option for signaling forwarding
        diversity within the same Transport Class. An SN can advertise an SEP
        with the same Transport Class in multiple BGP CT routes with unique
        RDs.</t>

        <t>For e.g., unique "RDx:EP1" prefixes can be advertised by an SN for
        an EP1 to different upstream BNs with unique forwarding specific
        encapsulation (e.g., Label), in order to collect traffic statistics at
        the SN for each BN. In absence of RD, duplicated Transport Class/Color
        values will be needed in the transport network to achieve such use
        cases.</t>

        <t>The allocation of RDs is done at the point of origin of the BGP CT
        route. This can either be an Egress SN or a BN. The default RD
        allocation mode is to use a unique RD per originating node for an EP.
        This mode allows for the ingress to uniquely identify each originated
        path. Alternatively, the same RD may be provisioned for multiple
        originators of the same EP. This mode can be used when the ingress
        does not require full visibility of all nodes originating an EP.</t>

        <t>A label is allocated for a BGP CT route when it is advertised with
        nexthop self by a SN or a BN. An implementation may use different
        label allocation modes with BGP CT. The recommended label allocation
        mode is per-prefix as it provides better traffic convergence
        properties than per-nexthop label allocation mode. Furthermore, BGP CT
        offers two flavors for per-prefix label allocation. The first flavor
        assigns a label for each unique "RD, EP". The second flavor assigns a
        label for each unique "Transport Class, EP" while ignoring the RD.</t>

        <t>In a BGP CT network, the number of routes at an Ingress PE is a
        function of unique EPs multiplied by BNs in the ingress domain that do
        nexthop self. BGP CT provides flexible RD and Label allocation modes
        to address operational requirements in a multi-domain network. The
        impacts on the control plane and forwarding behavior for the above
        modes are detailed with an example in <xref
        target="CTRouteVis">Managing Transport Route Visibility</xref></t>
      </section>
    </section>

    <section title="Protocol Procedures">
      <t>This section summarizes the procedures followed by various nodes
      speaking Classful Transport family.</t>

      <section title="Preparing the network to deploy Classful Transport planes">
        <t><list>
            <t>It is responsibility of the operators to decide the Transport
            Classes to enable and use in their network. They are also expected
            to allocate a Transport Class Route Target to identify each
            Transport Class.</t>

            <t>Operators configure the Transport Classes on the SNs and BNs in
            the network with Transport Class Route Targets and unique
            Route-Distinguishers.</t>

            <t>Implementations MAY provide automatic generation and assignment
            of RD, RT values; they MAY also provide a way to manually override
            the automatic mechanism in order to deal with any conflicts that
            may arise with existing RD, RT values in different network domains
            participating in the deployment.</t>
          </list></t>
      </section>

      <section title="Originating Classful Transport Routes">
        <t><list>
            <t>BGP CT routes are sent only to BGP peers that have negotiated
            the Multiprotocol Extensions capability described in Section 8 of
            [RFC4760] to be able to send and receive BGP CT routes.</t>

            <t>At the ingress node of the tunnel's home domain, the tunneling
            protocols install tunnel ingress routes in the TRDB associated
            with the Transport Class to which the tunnel belongs.</t>

            <t>The egress node of the tunnel i.e. the tunnel endpoint
            originates the BGP Classful Transport route with NLRI containing
            RD:TunnelEndpoint, Transport Class RT and PNH TunnelEndpoint,
            which will be resolved over the tunnel route in TRDB at the
            ingress node. When the tunnel is up, the Classful Transport BGP
            route will become usable and get re-advertised by the ingress node
            to BGP peers in neighboring domains.</t>

            <t>Alternatively, the ingress node may advertise this tunnel
            destination into BGP as a Classful Transport family route with
            NLRI RD:TunnelEndpoint, attaching a Transport Class Route Target
            that identifies the Transport Class. This BGP CT route is
            advertised to EBGP peers and IBGP peers in neighboring domains.
            This route SHOULD NOT be advertised to the IBGP core that contains
            the tunnel, using policy configuration.</t>

            <t>Unique RD SHOULD be used by the originator of a Classful
            Transport route to disambiguate the multiple BGP advertisements
            for a transport endpoint.</t>
          </list></t>
      </section>

      <section title="Processing Classful Transport Routes by Ingress Nodes">
        <list>
          <t>Upon receipt of a BGP Classful Transport route with a PNH that is
          not directly connected (e.g. an IBGP-route), a Mapping Community on
          the route (the Transport Class RT) is used to decide to which
          resolution scheme this route is to be mapped. The resolution scheme
          for a Transport Class RT with Transport Class ID "C1" contains TRDB
          for Transport Class with same ID. In cases where Transport Class
          "C1" tunnels are not available in a domain, the administrator MAY
          customize the resolution scheme to map to a different set of
          transport classes available in that domain.</t>

          <t>The routes in the associated TRDBs are used to resolve the
          received PNH. The order of TRDBs in a resolution scheme is followed
          when resolving the received PNH, such that a route in backup TRDB is
          used only when a matching route was not found in the primary TRDBs
          preceding it. This achieves the fallback desired by the resolution
          scheme.</t>

          <t>If the resolution process does not find a matching route in any
          of the associated TRDBs, the received BGP CT route MUST be
          considered unusable for forwarding purpose and be withdrawn.</t>

          <t>The received BGP CT route MUST be added to the TRDB corresponding
          to the Transport Class "C1". So that service routes can resolve over
          this BGP CT ingress route. RD is stripped by the ingress node from
          the BGP CT NLRI prefix when a BGP CT route is added to a TRDB.</t>
        </list>
      </section>

      <section title="Readvertising Classful Transport Route by Border Nodes with Next Hop Self">
        <list>
          <t>BNs allocate an MPLS label to advertise upstream in Classful
          Transport NLRI. A BN also installs an MPLS route for that label that
          swaps the incoming label with a label received from the downstream
          BGP speaker or pops the incoming label. It then pushes received
          traffic to the transport tunnel or direct interface that the
          Classful Transport route's PNH resolved over.</t>

          <t>The label SHOULD be allocated with "per-prefix" label allocation
          semantics. The IP prefix in the TRDB context (Transport-Class,
          IP-prefix) is used as the key to do per-prefix label allocation.
          This helps in avoiding BGP CT route churn throughout the CT network
          when an instability (e.g. link failure) is experienced in a domain.
          The failure is not propagated further than the BN closest to the
          failure.</t>

          <t>The value of the advertised MPLS label is locally significant,
          and is dynamic by default. A BN may provide an option to allocate a
          value from a statically carved out range. This can be achieved using
          locally configured export policy, or via mechanisms such as the ones
          described in <xref target="RFC8669">BGP Prefix-SID</xref>.</t>
        </list>
      </section>

      <section title="Border Nodes Receiving Classful Transport Routes on EBGP">
        <list>
          <t>If a route is received with PNH that is known to be directly
          connected (e.g. EBGP single-hop neighbor address), the directly
          connected interface is checked for MPLS forwarding capability. No
          other next hop resolution process is performed, as the inter-AS link
          can be used for any Transport Class.</t>

          <t>If the inter-AS links need to honor Transport Class, then the BN
          MUST follow procedures of an Ingress node described above and
          perform next hop resolution process. The route to directly connected
          PNH SHOULD be installed in the TRDB belonging to the associated
          Transport Class.</t>
        </list>
      </section>

      <section title="Avoiding Path Hiding Through Route Reflectors">
        <list>
          <t>When multiple BNs exist such that they advertise a "RD:EP" prefix
          to Route Reflectors (RRs), the RRs may hide all but one of the BNs,
          unless <xref target="RFC7911">ADDPATH</xref> is used for the
          Classful Transport family. This is similar to L3VPN Option B
          scenarios. Hence, ADDPATH SHOULD be used for Classful Transport
          family, to avoid path-hiding through RRs.</t>
        </list>
      </section>

      <section title="Avoiding Loops Between Route Reflectors in Forwarding Path">
        <list>
          <t>A pair of redundant ABRs, each acting as an RR with next hop
          self, may choose each other as best path instead of the upstream
          ASBR, causing a traffic forwarding loop. This happens because of
          following the path selection rule specified in <xref
          target="RFC4456">Section 9 of BGP RR</xref> that tie-breaks on
          ORIGINATOR_ID before CLUSTER_LIST. RFC4456 considers pure RR which
          is not in forwarding path. When a RR is in forwarding path and
          reflects routes with next hop self, as is the case for ABR BNs in a
          BGP transport network, this rule may cause loops.</t>

          <t>Implementations SHOULD provide a way to alter the tie-breaking
          rule specified in <xref target="RFC4456">Section 9 of BGP RR</xref>
          so as to tie-break on CLUSTER_LIST step before ORIGINATOR_ID step,
          when performing path selection for BGP CT routes.</t>

          <t>This document suggests the following modification to the BGP
          Decision Process Tie Breaking rules (Section. 9.1.2.2 of <xref
          target="RFC4271" />) that can be applied to path selection of BGP CT
          family routes:</t>

          <t>The following rule SHOULD be inserted between Steps e) and f): a
          BGP Speaker SHOULD prefer a route with the shorter CLUSTER_LIST
          length. The CLUSTER_LIST length is zero if a route does not carry
          the CLUSTER_LIST attribute.</t>

          <t>Taking into account some other deployment considerations can also
          help in avoiding this problem, e.g.,: <list>
              <t>IGP metric should be assigned such that "ABR to redundant
              ABR" cost is inferior than "ABR to upstream ASBR" cost.</t>

              <t>Tunnels belonging to non-best effort Transport Classes SHOULD
              NOT be provisioned between ABRs. This will ensure that the route
              received from an ABR with nexthop self will not be usable at a
              redundant ABR.</t>
            </list> This softens the possibility of such loops altogether.</t>
        </list>
      </section>

      <section title="Ingress Nodes Receiving Service Routes with a Mapping Community">
        <list>
          <t>Upon receipt of a BGP service route with a PNH that is not
          directly connected (e.g. an IBGP-route), a Mapping Community on the
          route (e.g, Color Extended Community) is used to decide to which
          resolution scheme this route is to be mapped. The resolution scheme
          for a Color Extended Community with Color "C1" contains TRDB for
          Transport Class with same ID, followed by Best-Effort TRDB. The
          administrator MAY customize the resolution scheme to map to a
          different ordered list of TRDBs.</t>

          <t>The routes in the associated TRDBs are used to resolve the
          received PNH. The order of TRDBs in a resolution scheme is followed
          when resolving the received PNH, such that a route in backup TRDB is
          used only when a matching route was not found in the primary TRDBs
          preceding it. This achieves the fallback desired by the resolution
          scheme.</t>

          <t>If the resolution process does not find a Tunnel Ingress Route in
          any of the Transport Route Databases, the service route MUST be
          considered unusable for forwarding purpose and be withdrawn.</t>
        </list>
      </section>

      <section title="Coordination Between Domains Using Different Community Namespaces">
        <list>
          <t>Cooperating Inter-AS Option-C domains may sometimes not agree on
          RT, RD, Mapping community or Transport Route Target values because
          of differences in community namespaces (e.g. during network mergers
          or renumbering for expansion). Such deployments may deploy
          mechanisms to map and rewrite the Route Target values on domain
          boundaries, using per ASBR import policies. This is no different
          than any other BGP VPN family. Mechanisms used in inter-AS VPN
          deployments may be leveraged with the Classful Transport family
          also.</t>

          <t>The resolution schemes SHOULD allow association with multiple
          Mapping Communities. This helps with renumbering, network mergers or
          transitions.</t>

          <t>The Transport Class Route Target Extended Community is useful to
          avoid collision with regular Route Target namespace used by service
          routes.</t>
        </list>
      </section>

      <section title="Best Effort Transport Class">
        <list>
          <t>It is possible to represent 'Best effort' SLA also as a Transport
          Class. Today, BGP LU (SAFI 4) is used to extend the best effort
          intra domain tunnels to other domains.</t>

          <t>Alternatively, BGP CT (SAFI 76) may be used to carry the best
          effort tunnels also. This document reserves the Transport Class ID
          value 0 to represent "Best Effort Transport Class ID". However,
          implementations SHOULD provide configuration to use a different
          value for this purpose.</t>

          <t>The 'Best Effort Transport Class ID' value is used in the
          'Transport Class ID' field of Transport Route Target Extended
          Community that is attached to the BGP CT route that advertises a
          best effort tunnel endpoint. The RT thus formed is called the "Best
          Effort Transport Class Route Target".</t>

          <t>When a BN or SN receives a BGP CT route with Best Effort
          Transport Class Route Target as the mapping community, the Best
          effort resolution scheme is used for resolving the BGP next hop, and
          the resultant route is installed in the best effort transport route
          database. If no best effort tunnel was found to resolve the BGP
          nexthop, the BGP CT route MUST be considered unusable, and not be
          propagated further.</t>

          <t>When a BGP speaker receives an overlay route without any explicit
          Mapping Community, and absent local policy, the best effort
          resolution scheme is used for resolving the BGP next hop on the
          route. This behavior is backward compatible to behavior of an
          implementation that does not follow procedures described in this
          document.</t>

          <t>Implementations MAY provide configuration to selectively install
          BGP CT routes to the Forwarding Information Base (FIB), to provide
          reachability for control plane peering towards endpoints in other
          domains.</t>
        </list>
      </section>

      <section title="Interaction with BGP Attributes Specifying Next Hop Address and Color">
        <t>The Tunnel Encapsulation Attribute, described in <xref
        target="RFC9012"></xref> can be used to request a specific type of
        tunnel encapsulation. This attribute may apply to BGP service routes
        or transport routes, including BGP Classful Transport family
        routes.</t>

        <t>The mechanisms described in <xref target="MULTI-NH-ATTR">BGP
        MultiNexthop Attribute</xref> allow a BGP route to carry multiple next
        hop addresses. It also allows specifying 'Transport Class ID' as a
        qualifier for each next hop address.</t>

        <t>It should be noted that in such cases "Transport Class/Color" can
        exist in multiple places on the same route, and a precedence order
        needs to be established to determine which Transport Class the route's
        next hop should resolve over. This document suggests the following
        order of precedence, more preferred first: <list>
            <t>Transport Class ID SubTLV, in MultiNexthop Attribute.</t>

            <t>Color SubTLV, in Tunnel Encapsulation Attribute.</t>

            <t>Transport Target Extended community, on BGP CT route.</t>

            <t>Color Extended community, on BGP service route.</t>
          </list> The above precedence order follows more specific scoping of
        Color to less specific scoping.</t>

        <t>Transport Class ID specified for Nexthop-Leg subTLV in a
        MultiNextHop attribute is more specific indication of Color than Color
        subTLV in a TEA, which in turn is more specific than Mapping Community
        (Transport Target) on a BGP CT transport route, which is in turn more
        specific than a Service route scoped Mapping Community (Color Extended
        community).</t>
      </section>

      <section title="Applicability to Flowspec Redirect to IP">
        <t>Flowspec routes using Redirect to IP nexthop is described in <xref
        target="FLOWSPEC-REDIR-IP"></xref></t>

        <t>Such Flowspec BGP routes with Redirect to IP nexthop MAY be
        attached with a Mapping Community (e.g. Color:0:100), which allows
        redirecting the flow traffic over a tunnel to the IP nexthop
        satisfying the desired SLA (e.g. Transport Class color 100).</t>

        <t>Flowspec BGP family acts as just another service that can make use
        of BGP CT architecture to achieve Flow based forwarding with SLAs.</t>
      </section>
    </section>

    <section title="Scaling Considerations">
      <section title="Avoiding Unintended Spread of BGP CT Routes Across Domains">
        <list>
          <t><xref target="RFC8212" /> suggests BGP speakers require explicit
          configuration of both BGP Import and Export Policies in order to
          receive or send routes over EBGP sessions.</t>

          <t>It is recommended to follow this for BGP CT routes. It will
          prohibit unintended advertisement of transport routes throughout the
          BGP CT transport domain, which may span across multiple AS domains.
          This will conserve usage of MPLS label and nexthop resources in the
          network. An ASBR of a domain can be provisioned to allow routes with
          only the Transport Route Targets that are required by SNs in the
          domain.</t>
        </list>
      </section>

      <section title="Constrained Distribution of PNHs to SNs (On-Demand Next Hop)">
        <list>
          <t>This section describes how the number of Protocol Nexthops
          advertised to a SN or BN can be constrained using BGP Classful
          Transport and <xref target="RFC4684">Route Target Constraints
          (RTC)</xref>.</t>

          <t>An egress SN MAY advertise BGP CT route for RD:eSN with two Route
          Targets: transport-target:0:&lt;TC&gt; and a RT carrying
          &lt;eSN&gt;:&lt;TC&gt;. Where TC is the Transport Class identifier,
          and eSN is the IP-address used by SN as BGP nexthop in its service
          route advertisements.</t>

          <t>Note that such use of the IP address specific route target
          &lt;eSN&gt;:&lt;TC&gt; is optional in a BGP CT network. It is
          required only if there is a requirement to prune the propagation of
          the transport route for an egress node eSN to only the set of
          ingress nodes that need it. When only RT of
          transport-target:0:&lt;TC&gt; is used, the pruning happens in
          granularity of Transport Class ID (Color), and not BGP nexthop; BGP
          CT routes will not be advertised into domains with PEs that don't
          import its transport class.</t>

          <t>The transport-target:0:&lt;TC&gt; is the new type of route target
          (Transport Class RT) defined in this document. It is carried in BGP
          extended community attribute (BGP attribute code 16).</t>

          <t>The RT carrying &lt;eSN&gt;:&lt;TC&gt; MAY be an IP-address
          specific regular RT (BGP attribute code 16), IPv6-address specific
          RT (BGP attribute code 25), or a Wide-communities based RT (BGP
          attribute code 34) as described in <xref target="RTC-Ext">Route
          Target Constrain Extension</xref>. This document recommends using
          Wide-communities based RT for the same.</t>

          <t>An ingress SN MAY import BGP CT routes with Route Target carrying
          &lt;eSN&gt;:&lt;TC&gt;. The ingress SN may learn the eSN values
          either by configuration, or it may discover them from the BGP next
          hop field in the BGP VPN service routes received from eSN. A BGP
          ingress SN receiving a BGP service route with nexthop of eSN SHOULD
          generate a RTC/Extended-RTC route for Route Target prefix &lt;Origin
          ASN&gt;:&lt;eSN&gt;/[80|176] in order to learn BGP CT transport
          routes to reach eSN. This allows constrained distribution of the
          transport routes to the PNHs actually required by iSN.</t>

          <t>When the path of route propagation of BGP CT routes is same as
          the RTC routes, a BN would learn the RTC routes advertised by
          ingress SNs and propagate further. This will allow constraining
          distribution of BGP CT routes for a PNH to only the necessary BNs in
          the network, closer to the egress SN.</t>

          <t>This mechanism provides "On Demand Nexthop" of BGP CT routes,
          which help with the scaling of MPLS forwarding state at SN and
          BN.</t>

          <t>However, the amount of state carried in RTC family may become
          proportional to the number of PNHs in the network. To strike a
          balance, the RTC route advertisements for &lt;Origin
          ASN&gt;:&lt;eSN&gt;/[80|176] MAY be confined to the BNs in home
          region of ingress-SN, or the BNs of a super core.</t>

          <t>Such a BN in the core of the network SHOULD import BGP CT routes
          with Transport-Target:0:&lt;TC&gt; and generate a RTC route for
          &lt;Origin ASN&gt;:0:&lt;TC&gt;/96, while not propagating the more
          specific RTC requests for specific PNHs. This will let the BN learn
          transport routes to all eSN nodes but confine their propagation to
          ingress-SNs.</t>
        </list>
      </section>

      <section title="Limiting The Visibility Scope of PE Loopback as PNHs">
        <list>
          <t>It may be even more desirable to limit the number of PNHs that
          are globally visible in the network. This is possible using
          mechanism described in <xref target="Appendix D" /></t>

          <t>Such that advertisement of PE loopback addresses as next-hop in
          BGP service routes is confined to the region they belong to. An
          anycast IP-address called "Context Protocol Nexthop Address" (CPNH,
          <xref target="CPNH" />) abstracts the SNs in a region from other
          regions in the network, swapping the SN scoped service label with a
          CPNH scoped private namespace label.</t>

          <t>This provides much greater advantage in terms of scaling and
          convergence. Changes to implement this feature are required only on
          the local region's BNs and RRs.</t>
        </list>
      </section>
    </section>

    <section title="OAM Considerations">
      <t>MPLS OAM procedures specified in <xref target="RFC8029"></xref> also
      apply to BGP Classful Transport.</t>

      <t>The 'Target FEC Stack' sub-TLV for IPv4 Classful Transport has a
      Sub-Type of 31744, and a length of 13. The Value field consists of the
      RD advertised with the Classful Transport prefix, the IPv4 prefix (with
      trailing 0 bits to make 32 bits in all) and a prefix length encoded as
      shown in Fig 3:</t>

      <figure anchor="FECv4" suppress-title="true"
              title="Classful Transport IPv4 FEC">
        <artwork align="left" xml:space="preserve"><![CDATA[
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Route Distinguisher                      |
      |                          (8 octets)                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv4 prefix                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |                 Must Be Zero                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

	            Fig 3: OAM Classful Transport IPv4 FEC]]></artwork>
      </figure>

      <t>The 'Target FEC Stack' sub-TLV for IPv6 Classful Transport has a
      Sub-Type of 31745, and a length of 25. The Value field consists of the
      RD advertised with the Classful Transport prefix, the IPv6 prefix (with
      trailing 0 bits to make 128 bits in all) and a prefix length encoded as
      shown in Fig 4:</t>

      <figure anchor="FECv6" suppress-title="true"
              title="Classful Transport IPv6 FEC">
        <artwork align="left" xml:space="preserve"><![CDATA[
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Route Distinguisher                      |
      |                          (8 octets)                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv6 prefix                           |
      |                                                               |
      |                                                               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |                 Must Be Zero                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

	           Fig 4: OAM Classful Transport IPv6 FEC]]></artwork>
      </figure>

      <t>These prefix layouts are inherited from Sections 3.2.5, 3.2.6 in
      <xref target="RFC8029"></xref></t>
    </section>

    <section title="Applicability to Network Slicing">
      <t>In Network Slicing, the Transport Slice Controller (TSC) is
      responsible for customizing and setting up the underlying transport
      (e.g. RSVP-TE, SRTE tunnels with desired characteristics) and resources
      (e.g., polices/shapers) in a transport network to create an IETF Network
      Slice.</t>

      <t>The Transport Class construct described in this document can be used
      to realize the "IETF Network Slice" defined in <xref
      target="TEAS-NS"></xref></t>

      <t>The TSC can use the Transport Class Identifier (Color value) to
      provision a transport tunnel in a specific IETF Network Slice.</t>

      <t>Further, the Network Slice Controller can use the Mapping Community
      on the service route to map traffic to the desired IETF Network
      Slice.</t>
    </section>

    <section anchor="SRv6-Support" title="SRv6 Support">
      <t>This section describes how BGP CT family (SAFI 76) may be used to set
      up inter domain tunnels of a certain Transport Class, when using Segment
      Routing over IPv6 (SRv6) data plane on the inter AS links or as an intra
      AS tunneling mechanism.</t>

      <t><xref target="RFC8986"></xref> specifies the SRv6 Endpoint behaviors
      (End USD, End.BM, End.B6.Encaps). <xref
      target="SRV6-INTER-DOMAIN"></xref> specifies the SRv6 Endpoint behaviors
      (END.REPLACE, END.REPLACEB6 and END.DB6). These are leveraged for BGP CT
      routes with SRv6 data plane.</t>

      <t>The BGP Classful Transport route update for SRv6 MUST include an
      attribute containing SRv6 SID information. This may be either the BGP
      Prefix-SID attribute as specified in <xref target="RFC9252"></xref> or
      the BGP MultiNexthop attribute as specified in <xref
      target="MULTI-NH-ATTR">BGP MultiNexthop Attribute</xref> section
      5.4.3.3. If the Prefix-SID attribute is used, it MUST NOT include SRv6
      SID structure for Transposition described in <xref
      target="RFC9252"></xref>.</t>

      <t>It should be noted that prefixes carried in BGP CT family are
      transport layer end-points, e.g. PE loopback addresses. Thus, the SRv6
      SID carried in a BGP CT route is also a transport layer identifier. For
      an illustration of BGP CT deployment in SRv6 neworks, refer to <xref
      target="Appendix E"></xref> .</t>
    </section>

    <section anchor="CTProc"
             title="Illustration of BGP CT Procedures in Inter AS Option C">
      <section title="Reference Topology">
        <figure anchor="RDLabelVisibility" suppress-title="true"
                title="Multi-Domain BGP CT Network">
          <artwork align="left" xml:space="preserve"><![CDATA[

                [RR26]      [RR27]                       [RR16]
                 |            |                             |
                 |            |                             |
                 |+-[ABR23]--+|+--[ASBR21]---[ASBR13]-+|+--[PE11]--+
                 ||          |||          `  /        |||          |
[CE41]--[PE25]--[P28]       [P29]          `/        [P15]     [CE31]
                 |           | |           /`         | |          |
                 |           | |          /  `        | |          |
                 |           | |         /    `       | |          |
                 +--[ABR24]--+ +--[ASBR22]---[ASBR14]-+ +--[PE12]--+


       |                |                  |                    |
       +                +                  +                    +
    CE |     region-1   |   region-2       |                    |CE
   AS4              ...AS2...                       AS1          AS3

41.41.41.41  ------------ Traffic Direction ---------->   31.31.31.31


         Fig 5: Reference Topology: Multi domain BGP CT Network]]></artwork>
        </figure>

        <t>This example shows a provider network that consists of two ASes,
        AS1 and AS2. They are serving customers AS3, AS4 respectively. Traffic
        direction being described is CE41 to CE31. CE31 may request a specific
        SLA (e.g. mapped to Gold for this example), when traversing these
        provider networks.</t>

        <t>AS2 is further divided into two regions. So, there are three tunnel
        domains in provider's space. AS1 uses <xref target="RFC9350">ISIS
        Flex-Algo</xref> intra-domain tunnels, whereas AS2 uses RSVP-TE
        intra-domain tunnels.</t>

        <t>The network exposes two Transport Classes: "Gold" with Transport
        Class id 100, "Bronze" with Transport Class id 200. These Transport
        Classes are provisioned at the PEs and the Border nodes (ABRs, ASBRs)
        in the network.</t>

        <t>Following tunnels exist for Gold Transport Class.<list>
            <t>PE25_to_ABR23_gold - RSVP-TE tunnel</t>

            <t>PE25_to_ABR24_gold - RSVP-TE tunnel</t>

            <t>ABR23_to_ASBR22_gold - RSVP-TE tunnel</t>

            <t>ASBR13_to_PE11_gold - SRTE tunnel</t>

            <t>ASBR14_to_PE11_gold - SRTE tunnel</t>
          </list></t>

        <t>Following tunnels exist for Bronze Transport Class.<list>
            <t>PE25_to_ABR23_bronze - RSVP-TE tunnel</t>

            <t>ABR23_to_ASBR21_bronze - RSVP-TE tunnel</t>

            <t>ABR23_to_ASBR22_bronze - RSVP-TE tunnel</t>

            <t>ABR24_to_ASBR21_bronze - RSVP-TE tunnel</t>

            <t>ASBR13_to_PE12_bronze - ISIS FlexAlgo tunnel</t>

            <t>ASBR14_to_PE11_bronze - ISIS FlexAlgo tunnel</t>
          </list></t>

        <t>These tunnels are either provisioned or auto-discovered to belong
        to Transport Classes 100 or 200.</t>
      </section>

      <section title="Service Layer Route Exchange">
        <t>Service nodes PE11, PE12 negotiate service families (SAFIs 1, 128)
        on the BGP session with RR16. Service helpers RR16 and RR26 exchange
        these service routes with nexthop unchanged over a multihop EBGP
        session between the two AS. PE25 negotiates service families (AFI: 1
        and SAFIs 1, 128) with RR26.</t>

        <t>The PEs see each other as nexthop in the BGP Update for the service
        family routes. Addpath send, receive is enabled on both directions on
        the EBGP multihop session between RR16 and RR26 for SAFIs 1, 128.
        Addpath send is negotiated in the RR to PE direction in each AS. This
        is to avoid path hiding of service routes at RR. E.g. SAFI 1 routes
        advertised by both PE11 and PE12. Or, SAFI 128 routes originated by
        both PE11 and PE12 using same RD.</t>

        <t>Forwarding happens using service routes installed at service nodes
        PE25, PE11, PE12 only. Service routes received from CEs are not
        present in any other nodes' FIB in the network.</t>

        <t>As an example, CE31 advertises a route for prefix 31.31.31.31 with
        nexthop as self to PE11, PE12. CE31 can attach a Mapping Community
        Color:0:100 on this route, to indicate its request for Gold SLA. Or,
        PE11 can attach the same using locally configured policies.</t>

        <t>Consider, CE31 is getting VPN service from PE11. The
        RD1:31.31.31.31 route is readvertised in SAFI 128 by PE11 with nexthop
        self (1.1.1.1) and label V-L1, to RR16 with the Mapping Community
        Color:0:100 attached. RR16 advertises this route with Addpath-ID to
        RR26 which readvertises to PE25 with nexthop unchanged. Now, PE25 can
        resolve the PNH 1.1.1.1 using transport routes received in BGP CT or
        BGP LU.</t>

        <t>Using Addpath, service routes advertised by PE11 and PE12 for SAFIs
        1, 128 reach PE25 via RR16, RR26 with the nexthop unchanged, as PE11
        or PE12.</t>

        <t>The IP FIB at PE25 VRF will have a route for 31.31.31.31 with a
        nexthop when resolved, that points to a Gold tunnel in ingress
        domain.</t>
      </section>

      <section title="Transport Layer Route Propagation">
        <t>Egress nodes PE11, PE12 negotiate BGP CT family with transport
        ASBRs ASBR13, ASBR14. These egress nodes originate BGP CT routes for
        tunnel endpoint addresses, that are advertised as nexthop in BGP
        service routes. In this example, both PEs participate in transport
        classes Gold and Bronze. The protocol procedures are explained using
        Gold SLA transport plane and the Bronze SLA transport plane is used to
        highlight the path hiding aspects.</t>

        <t>PE11 is provisioned with transport class 100, RD value 1.1.1.1:10
        and a transport-target:0:100 for Gold tunnels. And a Transport class
        200 with RD value 1.1.1.1:20, and transport route target 0:200 for
        Bronze tunnels. Similarly, PE12 is provisioned with transport class
        100, RD value 1.1.1.2:10 and a transport-target:0:100 for Gold
        tunnels. And transport class 200, RD value 1.1.1.2:20 with
        transport-target:0:200 for Bronze tunnels. Note that in this example,
        the BGP CT routes carry only the transport class route target, and no
        IP address format route target.</t>

        <t>The RD value originated by an egress node is not modified by any
        BGP speakers when the route is readvertised to the ingress node. Thus,
        the RD can be used to identify the originator (unique RD provisioned)
        or set of originators (RD reused on multiple nodes).</t>

        <t>Similarly, these transport classes are also configured on ASBRs,
        ABRs and PEs with same Transport Route Target and unique RDs.</t>

        <t>ASBR13 and ASBR14 negotiate BGP CT family with transport ASBRs
        ASBR21, ASBR22 in neighboring AS. They negotiate BGP CT family with
        RR27 in region 2, which reflects BGP CT routes to ABR23, ABR24. ABR23,
        ABR24 negotiate BGP CT family with Ingress node PE25 in region 1. BGP
        LU family is also negotiated on these sessions alongside BGP CT
        family. BGP LU carries "best effort" transport class routes, BGP CT
        carries gold, bronze transport class routes.</t>

        <t>PE11 is provisioned to originate BGP CT route with Gold SLA to
        endpoint PE11. This route is sent with NLRI RD prefix
        1.1.1.1:10:1.1.1.1, Label B-L0, nexthop 1.1.1.1 and a route target
        extended community transport-target:0:100. Label B-L0 can either be
        Implicit Null (Label 3) or an Ultimate Hop Pop (UHP) label.</t>

        <t>This route is received by ASBR13 and it resolves over the tunnel
        ASBR13_to_PE11_gold. The route is then readvertised by ASBR13 in BGP
        CT family to ASBRs ASBR21, ASBR22 according to export policy. This
        route is sent with same NLRI RD prefix 1.1.1.1:10:1.1.1.1, Label B-L1,
        nexthop self, and transport-target:0:100. MPLS swap route is installed
        at ASBR13 for B-L1 with a nexthop pointing to ASBR13_to_PE11_gold
        tunnel.</t>

        <t>Similarly, ASBR14 also receives BGP CT route for 1.1.1.1:10:1.1.1.1
        from PE11 and it resolves over the tunnel ASBR14_to_PE11_gold. The
        route is then readvertised by ASBR14 in BGP CT family to ASBRs ASBR21,
        ASBR22 according to export policy. This route is sent with same NLRI
        RD prefix 1.1.1.1:10:1.1.1.1, Label B-L2, nexthop self, and
        transport-target:0:100. MPLS swap route is installed at ASBR14 for
        B-L1 with a nexthop pointing to ASBR14_to_PE11_gold tunnel.</t>

        <t>In the Bronze plane, BGP CT route with Bronze SLA to endpoint PE11
        is originated by PE11 with a NLRI containing RD prefix
        1.1.1.1:20:1.1.1.1, and appropriate label. The RD allows both Gold and
        Bronze advertisements traverse path selection pinchpoints without any
        path hiding at RRs or ASBRs. And route target extended community
        transport-target:0:200 lets the route resolve over Bronze tunnels in
        the network, similar to the process being described for Gold SLA
        path.</t>

        <t>Moving back to the Gold plane, ASBR21 receives the Gold SLA BGP CT
        routes for NLRI RD prefix 1.1.1.1:10:1.1.1.1 over the single hop EBGP
        sessions from ASBR13, ASBR14, and can compute ECMP/FRR towards them.
        ASBR21 readvertises BGP CT route for 1.1.1.1:10:1.1.1.1 with nexthop
        self (loopback address 2.2.2.1) to RR27, advertising a new label B-L3.
        MPLS swap route is installed for label B-L3 at ASBR21 to swap to
        received label B-L1, B-L2 and forward to ASBR13, ASBR14 respectively.
        RR27 readvertises this BGP CT route to ABR23, ABR24 with label and
        nexthop unchanged.</t>

        <t>Similarly, ASBR22 receives BGP CT route 1.1.1.1:10:1.1.1.1 over the
        single hop EBGP sessions from ASBR13, ASBR14, and readvertises with
        nexthop self (loopback address 2.2.2.2) to RR27, advertising a new
        label B-L4. MPLS swap route is installed for label B-L4 at ASBR22 to
        swap to received label B-L1, B-L2 and forward to ASBR13, ASBR14
        respectively. RR27 readvertises this BGP CT route also to ABR23, ABR24
        with label and nexthop unchanged.</t>

        <t>Addpath is enabled for BGP CT family on the sessions between RR27
        and ASBRs, ABRs such that routes for 1.1.1.1:10:1.1.1.1 with the
        nexthops ASBR21 and ASBR22 are reflected to ABR23, ABR24 without any
        path hiding. Thus giving ABR23 visibility of both available nexthops
        for Gold SLA.</t>

        <t>ABR23 receives the route with nexthop 2.2.2.1, label B-L3 from
        RR27. The route target "transport-target:0:100" on this route acts as
        Mapping Community, and instructs ABR23 to strictly resolve the nexthop
        using transport class 100 routes only. ABR23 is unable to find a route
        for 2.2.2.1 with transport class 100. Thus, it considers this route
        unusable and does not propagate it further. This prunes ASBR21 from
        Gold SLA tunneled path.</t>

        <t>ABR23 also receives the route with nexthop 2.2.2.2, label B-L4 from
        RR27. The route target "transport-target:0:100" on this route acts as
        Mapping Community, and instructs ABR23 to strictly resolve the nexthop
        using transport class 100 routes only. ABR23 successfully resolves the
        nexthop to point to ABR23_to_ASBR22_gold tunnel. ABR23 readvertises
        this BGP CT route with nexthop self (loopback address 2.2.2.3) and a
        new label B-L5 to PE25. Swap route for B-L5 is installed by ABR23 to
        swap to label B-L4, and forward into ABR23_to_ASBR22_gold tunnel.</t>

        <t>PE25 receives the BGP CT route for prefix 1.1.1.1:10:1.1.1.1 with
        label B-L5, nexthop 2.2.2.3 and transport-target:0:100 from RR26. And
        it similarly resolves the nexthop 2.2.2.3 over transport class 100,
        pushing labels associated with PE25_to_ABR23_gold tunnel.</t>

        <t>In this manner, the Gold transport LSP "ASBR13_to_PE11_gold" in
        egress-domain is extended by BGP CT until the ingress-node PE25 in
        ingress domain, to create an end-to-end Gold SLA path. MPLS swap
        routes are installed at ASBR13, ASBR22 and ABR23, when propagating the
        PE11 BGP CT Gold transport class route 1.1.1.1:10:1.1.1.1 with nexthop
        self towards PE25.</t>

        <t>The BGP CT LSP thus formed, originates in PE25, and terminates in
        ASBR13 (assuming PE11 advertised Implicit Null), traversing over the
        Gold underlay LSPs in each domain. ASBR13 uses UHP to stitch the BGP
        CT LSP into the "ASBR13_to_PE11_gold" LSP to traverse the last domain,
        thus satisfying Gold SLA end-to-end.</t>

        <t>When PE25 receives service routes from RR26 with nexthop 1.1.1.1
        and mapping community Color:0:100, it resolves over this BGP CT route
        1.1.1.1:10:1.1.1.1. Thus pushing label B-L5, and pushing as top label
        the labels associated with PE25_to_ABR23_gold tunnel.</t>
      </section>

      <section title="Data Plane View">
        <section title="Steady State">
          <t>This section describes how the data plane looks like in steady
          state.</t>

          <t>CE41 transmits an IP packet with destination as 31.31.31.31. On
          receiving this packet, PE25 performs a lookup in the IP FIB
          associated with the CE41 interface. This lookup yields the service
          route that pushes the VPN service label V-L1, BGP CT label B-L5, and
          labels for PE25_to_ABR23_gold tunnel. Thus, PE25 encapsulates the IP
          packet in MPLS packet with label V-L1(innermost), B-L5, and top
          label as PE25_to_ABR23_gold tunnel. This MPLS packet is thus
          transmitted to ABR23 using Gold SLA.</t>

          <t>ABR23 decapsulates the packet received on PE25_to_ABR23_gold
          tunnel as required, and finds the MPLS packet with label B-L5. It
          performs lookup for label B-L5 in the global MPLS FIB. This yields
          the route that swaps label B-L5 with label B-L4, and pushes the top
          label provided by ABR23_to_ASBR22_gold tunnel. Thus, ABR23 transmits
          the MPLS packet with label B-L4 to ASBR22, on a tunnel that
          satisfies Gold SLA.</t>

          <t>ASBR22 similarly performs a lookup for label B-L4 in global MPLS
          FIB, finds the route that swaps label B-L4 with label B-L2, and
          forwards to ASBR13 over the directly connected MPLS enabled
          interface. This interface is a common resource not dedicated to any
          specific transport class, in this example.</t>

          <t>ASBR13 receives the MPLS packet with label B-L2, and performs a
          lookup in MPLS FIB, finds the route that pops label B-L2, and pushes
          labels associated with ASBR13_to_PE11_gold tunnel. This transmits
          the MPLS packet with VPN label V-L1 to PE11 using a tunnel that
          preserves Gold SLA in AS 1.</t>

          <t>PE11 receives the MPLS packet with V-L1, and performs VPN
          forwarding. Thus transmitting the original IP payload from CE41 to
          CE31. The payload has traversed path satisfying Gold SLA
          end-to-end.</t>
        </section>

        <section title="Local Repair of Primary Path">
          <t>This section describes how the data plane at ASBR22 reacts when
          the link between ASBR22 and ASBR13 experiences a failure, and an
          alternate path exists.</t>

          <t>Assuming ASBR22_to_ASBR13 link goes down, such that traffic with
          Gold SLA going to PE11 needs repair. ASBR22 has an alternate BGP CT
          route for 1.1.1.1:10:1.1.1.1 from ASBR14. This has been
          preprogrammed in forwarding by ASBR22 as FRR backup nexthop for
          label B-L4. This allows the Gold SLA traffic to be locally repaired
          at ASBR22 without the failure event propagated in the BGP CT
          network. In this case, ingress node PE25 will not know there was a
          failure, and traffic restoration will be independent of prefix scale
          (PIC).</t>
        </section>

        <section title="Absorbing Failure of Primary Path: Fallback to Best Effort Tunnels ">
          <t>This section describes how the data plane reacts when gold path
          experiences a failure, but no alternate path exists.</t>

          <t>Assuming tunnel ABR23_to_ASBR22_gold goes down, such that now
          end-to-end Gold path does not exist in the network. This makes the
          BGP CT route for RD prefix 1.1.1.1:10:1.1.1.1 unusable at ABR23.
          This makes ABR23 send a BGP withdrawal for 1.1.1.1:10:1.1.1.1 to
          PE25.</t>

          <t>Withdrawal for 1.1.1.1:10:1.1.1.1 allows PE25 to react to the
          loss of gold path to 1.1.1.1. Assuming PE25 is provisioned to use
          best-effort transport class as the backup path, this withdrawal of
          BGP CT route allows PE25 to adjust the nexthop of the VPN
          Service-route to push the labels provided by the BGP LU route. That
          repairs the traffic to go via best effort path. PE25 can also be
          provisioned to use Bronze transport class as the backup path. The
          repair will happen in similar manner in that case as-well.</t>

          <t>Traffic repair to absorb the failure happens at ingress node
          PE25, in a service prefix scale independent manner. This is called
          PIC (Prefix scale Independent Convergence). The repair time will be
          proportional to time taken for withdrawing the BGP CT route.</t>

          <t>The above examples demonstrate the various levels of failsafe
          mechanisms available to protect traffic in a BGP CT network.</t>
        </section>
      </section>
    </section>

    <section title="Deployment Considerations.">
      <section title="Managing Intent at Service and Transport layers.">
        <t><xref target="CTProc">Illustration of BGP CT Procedures </xref>
        shows multiple domains that agree on a color name space (Agreeing
        Color Domains) and contain tunnels with equivalent set of colors
        (Homogenous Color Domains).</t>

        <t>However in the real world, this may not always be guaranteed. Two
        domains may independently manage their color namespaces, these are
        known as Non-Agreeing Color Domains. Two domains may have tunnels with
        unequal set of colors, these are known as Heterogeneous Color
        Domains.</t>

        <t>This section describes how BGP CT is deployed in such scenarios to
        preserve end to end Intent. Example described in this section use
        Inter AS option C domains. But similar mechanisms will work for Inter
        AS Option A and Inter AS Option B scenarios as-well.</t>

        <section title="Service Layer Color Management ">
          <t>At the service layer, it is recommended that a global color
          namespace be maintained across multiple co-operating domains. BGP CT
          allows indirection using resolution schemes to be able to maintain a
          global namespace in the service layer. This is possible even if each
          domain independently maintains its own local transport color
          namespace.</t>

          <t>As explained in <xref target="Nexthop_Resoln_Schm">Nexthop
          Resolution Scheme</xref> , mapping community carried on service
          route maps to a resolution scheme. The mapping community values for
          the service route can be abstract and does not require to match the
          transport color namespace. This abstract mapping community value
          representing a global service layer intent is mapped to a local
          transport layer intent available in each domain.</t>

          <t>In this manner, it is recommended to keep color namespace
          management at the service layer and the transport layer decoupled
          from each other. In the following sections the service layer agrees
          on a single global namespace.</t>
        </section>

        <section title="Non-Agreeing Color Transport Domains">
          <t>Non-agreeing color domains require a mapping community rewrite on
          each domain boundary. This rewrite helps to map one domain's
          namespace to another.</t>

          <t>The below example illustrates how traffic is stitched and SLA is
          preserved when domains don't use the same namespace at the transport
          layer. Each domain specifies the same SLA using different color
          values.</t>

          <figure anchor="BGPCT_NON_AGREEING_COLOR_DOMAIN"
                  suppress-title="true"
                  title="Transport Layer with Non-agreeing Color Domains ">
            <artwork align="left" xml:space="preserve"><![CDATA[

          Gold(100)              Gold(300)               Gold(500)


     [PE11]----[ASBR11]---[ASBR21------[ASBR22]---[ASBR31-------[PE31]
            AS1                     AS2                    AS3


          Bronze(200)          Bronze(400)             Bronze(600)

            ----------- Packet Forwarding Direction -------->

      Fig 6: Transport Layer with Non-agreeing Color Domains
            ]]></artwork>
          </figure>

          <t>In the topology in Fig 6, we have three Autonomous Systems. All
          the nodes in the topology supports BGP CT.</t>

          <t>In AS1 Gold SLA is represented by color 100 and Bronze by
          200.</t>

          <t>In AS2 Gold SLA is represented by color 300 and Bronze by
          400.</t>

          <t>In AS3 Gold SLA is represented by color 500 and Bronze by
          600.</t>

          <t>Though the color values are different, they map to tunnels with
          sufficiently similar TE characteristics in each domain.</t>

          <t>The service route carries an abstract mapping community that maps
          to the required SLA. For example, Service routes that need to
          resolve over gold transport tunnels, carries a mapping community
          color:0:100500. In AS3 it maps to a resolution scheme containing
          TRDB with color 500 whereas in AS2 it maps to a TRDB with color 300
          and in AS1 it maps to a TRDB with color 100. Co-ordination is needed
          to provision the resolution schemes in each domain as explained
          above.</t>

          <t>At the AS boundary, the transport-class route-target is rewritten
          for the BGP CT routes. In the above topology, At ASBR31 the
          transport-target:0:500 for gold tunnels is rewritten to
          transport-target:0:300 and then advertised to ASBR22. Similarly, the
          transport-target:0:300 for gold tunnels are re-written to
          transport-target:0:100 at ASBR21 before advertising to ASBR11. At
          PE11, the transport route received with transport-target:0:100 will
          be added to the color 100 TRDB. The service route received with
          mapping community color:0:100500 at PE1 maps to the gold TRDB and
          resolves over this transport route.</t>

          <t>Inter-domain traffic forwarding in the above topology works as
          explained in <xref target="CTProc"></xref>.</t>

          <t>Transport-target re-write requires co-ordination of color values
          between domains in the transport layer. This method avoids the need
          to re-write service route mapping community, keeping the service
          layer homogenous and simple to manage. Coordinating Transport Class
          RT between adjacent domains is easier than coordinating service
          layer colors deployed in various non-adjacent domains.</t>
        </section>

        <section title="Heterogeneous Agreeing Color Transport Domains">
          <t>In a heterogeneous domains scenario, it might not be possible to
          map a service layer intent to the matching transport color, as the
          color might not be locally available in a domain.</t>

          <t>The below example illustrates how traffic is stitched, when a
          transit AS contains more shades for an SLA paths compared to Ingress
          and Egress domains. This example shows how service routes can
          traverse through finer shades when available and take coarse shades
          otherwise.</t>

          <figure anchor="BGPCT_HETERGENOUS_COLOR_DOMAIN"
                  suppress-title="true"
                  title="Tranport Layer with Heterogenous Color Domains ">
            <artwork align="left" xml:space="preserve"><![CDATA[
           <---------- Service Routes SAFI 128 ------------------------

                                     Gold1(101)
                                     Gold2(102)
          Gold(100)                                             Gold(100)

    [PE11]------[ASBR11]----[ASBR21--------[ASBR22]----[ASBR31--------[PE31]
       AS1-Metro-Ingress            AS2-Core              AS3-Metro-Egress


                ----------- Packet Forwarding Direction -------->


        Fig 7: Tranport Layer with Heterogenous Color Domains
            ]]></artwork>
          </figure>

          <t>In the topology in Fig 7, we have three Autonomous Systems. All
          the nodes in the topology support BGP CT.</t>

          <t>In AS1 Gold SLA is represented by color 100.</t>

          <t>In AS2 Gold has finer shades: Gold1 by color 101 and Gold2 by
          color 102.</t>

          <t>In AS3 Gold SLA is represented by color 100.</t>

          <t>This problem can be solved by two approaches, described
          below.</t>

          <section title="Duplicate Tunnels Approach">
            <t>In this approach, duplicate tunnels that satisfy Gold SLA are
            configured in domains AS1 and AS3, but they are given fine grained
            colors 101, 102.</t>

            <t>These tunnels will be installed in TRDBs corresponding to
            transport classes of color 101, 102.</t>

            <t>Service routes received with mapping community (eg:
            transport-target or color community) can resolve over these
            tunnels in the TRDB with matching color by using resolution
            schemes.</t>

            <t>This approach consumes more resources in the transport and
            forwarding layer, because of the duplicate tunnels.</t>
          </section>

          <section title="Customized Resolution Schemes Approach">
            <t>In this approach, resolution schemes in domains AS1 and AS3 are
            customized to map the received mapping community (e.g.,
            transport-target or color community) over available Gold SLA
            tunnels. This conserves resource usage with no additional state in
            transport and forwarding plane.</t>

            <t>Service routes advertised by PE31 that need to resolve over
            Gold1 transport tunnels carry a mapping community color:0:101. In
            AS3 and AS1, where Gold1 is not available, it is mapped to color
            100 TRDB using a customized resolution scheme. In AS2, Gold1 is
            available and it maps to color 101 TRDB.</t>

            <t>To facilitate this mapping, every SN/BN in all AS provision
            required transport classes viz. 100, 101 and 102. SN and BN in AS1
            and AS3 are provisioned with customized resolution schemes that
            resolve routes with transport-target:0:101 or
            transport-target:0:102 strictly over color 100 TRDB.</t>

            <t>PE31 is provisioned to originate BGP CT route with color 101
            for endpoint PE31. This route is sent with NLRI RD prefix RD1:PE31
            and route target extended community transport-target:0:101.</t>

            <t>At ASBR31, the route target "transport-target:0:101" on this
            BGP CT route instructs to add the route to color 101 TRDB. ASBR31
            is provisioned with customized resolution scheme that resolves the
            routes carrying mapping community transport-target:0:101 to
            resolve using color 100 TRDB. This route is then re-advertised
            from color 101 TRDB to ASBR22 with route-target:0:101.</t>

            <t>At ASBR22, the BGP CT routes received with
            transport-target:0:101 will be added to color 101 TRDB and
            strictly resolve over tunnel routes in the same TRDB. This route
            is re-advertised to ASBR21 with transport-target:0:101.</t>

            <t>Similarly, at ASBR21, the BGP CT routes received with
            transport-target:0:101 will be added to color 101 TRDB and
            strictly resolve over tunnel routes in the same TRDB. This route
            is re-advertised to ASBR11 with transport-target:0:101.</t>

            <t>At ASBR11, the route target "transport-target:0:101" on this
            BGP CT route instructs to add the route to color 101 TRDB. ASBR11
            is provisioned with a customized resolution scheme that resolves
            the routes carrying transport-target:0:101 to use color 100 TRDB.
            This route is then re-advertised from color 101 TRDB to PE11 with
            route-target:0:101.</t>

            <t>At PE11, the route target "transport-target:0:101" on this BGP
            CT route instructs to add the route to color 101 TRDB. PE11 is
            provisioned with a customized resolution scheme that resolves the
            routes carrying transport-target:0:101 to use color 100 TRDB.</t>

            <t>When PE11 receives the service route with the mapping community
            color:0:101 it directly resolves over the BGP CT route in color
            101 TRDB, which in turn resolves over tunnel routes in color 100
            TRDB.</t>

            <t>In doing so, PE11 can forward traffic via tunnels with color
            101, color 102 in the core domain, and color 100 in the metro
            domains.</t>
          </section>
        </section>
      </section>

      <section title="Migration Scenarios.">
        <section title="BGP CT Islands Connected via BGP LU Domain">
          <t>This section explains how end-to-end SLA can be achieved while
          transiting a domain that does not support BGP CT (SAFI 76). BGP LU
          (SAFI 4) is used in such domains to connect the BGP CT islands.</t>

          <figure anchor="BGPCTIsles" suppress-title="true"
                  title="BGP CT in AS1 and AS3 connected by BGP LU in AS2">
            <artwork align="left" xml:space="preserve"><![CDATA[
              +----------EBGP Multihop CT-------------+
              |                                       |
        AS3   |                   AS2                 |   AS1
  [PE31-----ASBR31]--------[ASBR22---ASBR21]-------[ASBR11---PE11]

                 <-EBGP LU->              <-EBGP LU->
   <---IBGP CT--->          <---IBGP LU--->        <---IBGP CT--->

            ---------Packet Forwarding Direction--------->

   Fig 8: BGP CT in AS1 and AS3 connected by BGP LU in AS2
]]></artwork>
          </figure>

          <t>In the above topology, there are three AS domains. AS1 and AS3
          supports BGP CT, while AS2 does not support BGP CT.</t>

          <t>Nodes in AS1, AS2, and AS3 negotiate BGP LU family on IBGP
          sessions within the domain. Nodes in AS1 and AS3 negotiate BGP CT
          family on IBGP sessions within the domain. ASBR11 and ASBR21 as well
          as ASBR22 and ASBR31 negotiate BGP LU family on the EBGP session
          over directly connected interdomain links. ASBR11 and ASBR31 have
          reachability to each other&rsquo;s loopbacks through BGP LU. ASBR11
          and ASBR31 negotiate BGP CT family over a multihop EBGP session
          formed using BGP LU reachability.</t>

          <t>The following tunnels exist for Gold Transport Class<list>
              <t>PE11_to_ASBR11_gold - RSVP-TE tunnel</t>

              <t>ASBR11_to_PE11_gold - RSVP-TE tunnel</t>

              <t>PE31_to_ASBR31_gold - SRTE tunnel</t>

              <t>ASBR31_to_PE31_gold - SRTE tunnel</t>
            </list></t>

          <t>Following tunnels exist for Bronze Transport Class<list>
              <t>PE11_to_ASBR11_bronze - RSVP-TE tunnel</t>

              <t>ASBR11_to_PE11_bronze - RSVP-TE tunnel</t>

              <t>PE31_to_ASBR31_bronze - SRTE tunnel</t>

              <t>ASBR31_to_PE31_bronze - SRTE tunnel</t>
            </list></t>

          <t>These tunnels are provisioned to belong to Transport Classes gold
          and bronze, and are advertised between ASBR31 and ASBR11 with
          Nexthop self.</t>

          <t>In AS2, that does not support BGP CT, a separate loopback may be
          used on ASBR22 and ASBR21 to represent gold and bronze SLAs viz
          ASBR22_lpbk_gold, ASBR22_lpbk_bronze, ASBR21_lpbk_gold and
          ASBR21_lpbk_bronze.</t>

          <t>Further, the following tunnels exist in AS2 to satisfy the
          different SLAs, using per SLA loopback endpoints:<list>
              <t>ASBR21_to_ASBR22_lpbk_gold - RSVP-TE tunnel</t>

              <t>ASBR22_to_ASBR21_lpbk_gold - RSVP-TE tunnel</t>

              <t>ASBR21_to_ASBR22_lpbk_bronze - RSVP-TE tunnel</t>

              <t>ASBR22_to_ASBR21_lpbk_bronze - RSVP-TE tunnel</t>
            </list></t>

          <t>RD:PE11 BGP CT route is originated from PE11 towards ASBR11 with
          transport-target gold. ASBR11 readvertises this route with nexthop
          set to ASBR11_lpbk_gold on the EBGP multihop session towards ASBR31.
          ASBR11 originates BGP LU route for endpoint ASBR11_lpbk_gold on EBGP
          session to ASBR21 with a 'gold SLA' community, and BGP LU route for
          ASBR11_lpbk_bronze with a 'bronze SLA' community. The SLA community
          is used by ASBR31 to publish the BGP LU routes in the corresponding
          BGP CT TRDBs.</t>

          <t>ASBR21 readvertises the BGP LU route for endpoint
          ASBR11_lpbk_gold to ASBR22 with nexthop set by local policy config
          to the unique loopback ASBR21_lpbk_gold by matching the 'gold SLA'
          community received as part BGP LU advertisement from ASBR11. ASBR22
          receives this route and resolves the nexthop over the
          ASBR22_to_ASBR21_lpbk_gold RSVP-TE tunnel. On successful resolution,
          ASBR22 readvertises this BGP LU route to ASBR31 with nexthop self
          and a new label.</t>

          <t>ASBR31 adds the ASBR11_lpbk_gold route received via EBGP LU from
          ASBR22 to gold TRDB based on the received 'gold SLA' community.
          ASBR31 uses this gold TRDB route to resolve the nexthop
          ASBR11_lpbk_gold received on BGP CT route with transport-target
          gold, for the prefix RD:PE11 received over the EBGP multihop CT
          session, thus preserving the end-to-end SLA. Now ASBR31 readvertises
          the BGP CT route for RD:PE11 with nexthop as self thus stitching
          with the BGP LU LSP in AS2. Intradomain traffic forwarding in AS1
          and AS3 follows the procedures as explained in <xref
          target="CTProc">Illustration of CT Procedures</xref></t>

          <t>In cases where an SLA cannot be preserved in AS2 because SLA
          specific tunnels and loopbacks dont exist in AS2, traffic can be
          carried over available SLAs (eg: best-effort SLA) by rewriting the
          nexthop to ASBR21 loopback assigned to the available SLA. This eases
          migration in case of heterogeneous color domains as-well.</t>
        </section>

        <section title="BGP CT - Interop between MPLS and Other Forwarding Technologies ">
          <t>This section describes how nodes supporting dissimilar
          encapsulation technologies can interoperate with each other when
          using BGP CT family.</t>

          <section title="Interop Between MPLS and SRv6 Nodes.">
            <t>BGP speakers may carry MPLS label and SRv6 SID in BGP CT SAFI
            76 routes using protocol encoding as described in <xref
            target="CTMultiEncap">Carrying Multiple Encapsulation
            information</xref></t>

            <t>MPLS Labels are carried using RFC 8277 encoding, and SRv6 SID
            is carried using Prefix SID attribute as specified in <xref
            target="RFC9252"></xref>.</t>

            <figure anchor="BGPCT_MPLS_SRV6" suppress-title="true"
                    title="BGP CT Interop between MPLS and SRv6 nodes">
              <artwork align="left" xml:space="preserve"><![CDATA[

                      RR1--+
                             \  +-------R2  [MPLS + SRv6]
                              \ |
                      R1--------P-------R3  [MPLS only]
                [MPLS + SRv6]   |
                                +-------R4  [SRv6 only]

                  <---- Bidirectional Traffic ---->

       Fig 9: BGP CT Interop between MPLS and SRv6 nodes]]></artwork>
            </figure>

            <t>This example shows a provider network with a mix of devices
            with different forwarding capabilities. R1 and R2 support
            forwarding both MPLS and SRv6 packets. R3 supports forwarding MPLS
            packets only. R4 supports forwarding SRv6 packets only. All these
            nodes have BGP session with Route Reflector RR1 which reflects
            routes between these nodes with nexthop unchanged. BGP CT family
            is negotiated on these sessions.</t>

            <t>R1 and R2 send and receive both MPLS label and SRv6 SID in the
            BGP CT control plane routes. This allows them to be ingress and
            egress for both MPLS and SRv6 data planes. MPLS label is carried
            using RFC 8277 encoding, and SRv6 SID is carried using Prefix SID
            attribute as specified in <xref target="RFC9252"></xref>, without
            Transposition Scheme. The Transposition Length is set to 0 and
            Transposition Offset is set to 0 to indicate nothing is transposed
            and that the entire SRv6 SID value is encoded in the SID
            Information Sub-TLV. In this way, either MPLS or SRv6 forwarding
            can be used between R1 and R2.</t>

            <t>R1 and R3 send and receive MPLS label in the BGP CT control
            plane routes using RFC 8277 encoding. This allows them to be
            ingress and egress for MPLS data plane. R1 will carry SRv6 SID in
            Prefix-SID attribute, which will not be used by R3. In order to
            interoperate with MPLS only device R3, R1 MUST NOT use SRv6
            Transposition scheme described in <xref target="RFC9252"></xref>.
            The Transposition Length is set to 0 and Transposition Offset is
            set to 0 to indicate nothing is transposed and that the entire
            SRv6 SID value is encoded in the SID Information Sub-TLV. MPLS
            forwarding will be used between R1 and R3.</t>

            <t>R1 and R4 send and receive SRv6 SID in the BGP CT control plane
            routes using BGP Prefix-SID attribute, without Transposition
            Scheme. This allows them to be ingress and egress for SRv6 data
            plane. R4 will carry the special MPLS Label with value 3
            (Implicit-NULL) in RFC 8277 encoding, which tells R1 not to push
            any MPLS label towards R4. The MPLS Label advertised by R1 in RFC
            8277 NLRI will not be used by R4. SRv6 forwarding will be used
            between R1 and R4.</t>

            <t>Note in this example that R3 and R4 cannot communicate directly
            with each other, because they don't support a common forwarding
            technology. The BGP CT routes received at R3, R4 from each other
            will remain unusable, due to incompatible forwarding
            technology.</t>
          </section>

          <section title="Interop Between Nodes Supporting MPLS and UDP Tunneling">
            <t>This section describes how nodes supporting MPLS forwarding can
            interoperate with other nodes supporting UDP (or IP) tunneling,
            when using BGP CT family.</t>

            <t>MPLS Labels are carried using RFC 8277 encoding, and UDP (or
            IP) tunneling information is carried using TEA attribute or the
            Encapsulation Extended Community as specified in <xref
            target="RFC9012"></xref>.</t>

            <figure anchor="BGPCT_MPLS_UDP" suppress-title="true"
                    title="BGP CT Interop between MPLS and UDP tunneling nodes.">
              <artwork align="left" xml:space="preserve"><![CDATA[

                      RR1--+
                             \  +-------R2  [MPLS + UDP]
                              \ |
                      R1--------P-------R3  [MPLS only]
                [MPLS + UDP]    |
                                +-------R4  [UDP only]

                  <---- Bidirectional Traffic ---->

       Fig 10: BGP CT Interop between MPLS and UDP tunneling nodes.]]></artwork>
            </figure>

            <t>In this example, R1 and R2 support forwarding both MPLS and UDP
            tunneled packets. R3 supports forwarding MPLS packets only. R4
            supports forwarding UDP tunneled packets only. All these nodes
            have BGP session with Route Reflector RR1 which reflects routes
            between these nodes with nexthop unchanged. BGP CT family is
            negotiated on these sessions.</t>

            <t>R1 and R2 send and receive both MPLS label and UDP tunneling
            info in the BGP CT control plane routes. This allows them to be
            ingress and egress for both MPLS and UDP tunneling data planes.
            MPLS label is carried using RFC 8277 encoding. As specified in
            <xref target="RFC9012"></xref>, UDP tunneling information is
            carried using TEA attribute (code 23) or the "barebones" Tunnel
            TLV carried in Encapsulation Extended Community. Either MPLS or
            UDP tunneled forwarding can be used between R1 and R2.</t>

            <t>R1 and R3 send and receive MPLS label in the BGP CT control
            plane routes using RFC 8277 encoding. This allows them to be
            ingress and egress for MPLS data plane. R1 will carry UDP
            tunneling info in TEA attribute, which will not be used by R3.
            MPLS forwarding will be used between R1 and R3.</t>

            <t>R1 and R4 send and receive UDP tunneling info in the BGP CT
            control plane routes using BGP TEA attribute. This allows them to
            be ingress and egress for UDP tunneled data plane. R4 will carry
            special MPLS Label with value 3 (Implicit-NULL) in RFC 8277
            encoding, which tells R1 not to push any MPLS label towards R4.
            The MPLS Label advertised by R1 will not be used by R4. UDP
            tunneled forwarding will be used between R1 and R4.</t>

            <t>Note in this example that R3 and R4 cannot communicate directly
            with each other, because they don't support a common forwarding
            technology. The BGP CT routes received at R3, R4 from each other
            will remain unusable, due to incompatible forwarding
            technology.</t>
          </section>
        </section>
      </section>

      <section anchor="CTRouteVis" title="Managing Transport Route Visibility">
        <t>This section details the usage of BGP CT RD and label allocation
        modes to calibrate the level of path visibility and the amount of
        route churn in a multi-domain network.</t>

        <t>Consider a multi-domain BGP CT network as illustrated in the figure
        below.</t>

        <figure anchor="MultiDomainNetwork" suppress-title="true"
                title="Multi-Domain Network">
          <artwork align="left" xml:space="preserve"><![CDATA[
       |-----AS3-----|  |-------AS1------|

                +--------ASBR11     +--PE11 (EP1)
                |              \   /
         +----ASBR31            (P)----PE12 (EP2)
         |      |              / | \
         |      +--------ASBR12  |  +--PE13 (EP3)
         |                       |
         |                       +-----PE14 (EP4)
  PE31--(P)
         |
         |
         |      +--------ASBR21     +--PE21 (EP5)
         |      |              \   /
         +----ASBR32            (P)----PE22 (EP6)
                |              / | \
                +--------ASBR22  |  +--PE22 (EP7)
                                 |
                                 +-----PE24 (EP8)

       |-----AS3-----|  |-------AS2------|


 Fig 11: Managing Transport Route Visibility in Multi domain Network
]]></artwork>
        </figure>

        <t>The following table details the BGP CT route and path visibility at
        PE31-- for each TC.</t>

        <figure anchor="RDLabelVis" suppress-title="true"
                title="Route and Path Visibility at Ingress Node">
          <artwork align="left" xml:space="preserve"><![CDATA[
      +--------+------+-------+-------+---------+---------+
      |EP-type |Origin|RD-Mode|PP-Mode|CT Routes|CT Labels|
      +--------+------+-------+-------+---------+---------+
      |Unicast |SN    |Unique |TC,EP  |    16   |    8    |
      |Unicast |SN    |Unique |RD,EP  |    16   |   16    |
      |Unicast |BN    |Unique |TC,EP  |    16   |    8    |
      |Unicast |BN    |Unique |RD,EP  |    16   |   16    |
      |--------|------|-------|-------|---------|---------|
      |Anycast |SN    |Unique |TC,EP  |    16   |    2    |
      |Anycast |SN    |Unique |RD,EP  |    16   |   16    |
      |Anycast |SN    |Same   |TC,EP  |     2   |    2    |
      |Anycast |SN    |Same   |RD,EP  |     2   |    2    |
      |Anycast |BN    |Unique |TC,EP  |     4   |    2    |
      |Anycast |BN    |Unique |RD,EP  |     4   |    4    |
      |Anycast |BN    |Same   |TC,EP  |     2   |    2    |
      |Anycast |BN    |Same   |RD,IP  |     2   |    2    |
      +--------+------+-------+-------+---------+---------+

  Fig 12: Truth table, Route and Path Visibility at Ingress Node
]]></artwork>
        </figure>

        <t>In the above example, both route churn and TE granularity are
        directly proportional to the number of CT labels received.</t>

        <t>Deploying unique RDs is strongly RECOMMENDED because it helps in
        troubleshooting by uniquely identifying the originator of a route and
        avoids path-hiding.</t>

        <t>The above table demonstrates that BGP CT allows an operator to
        control how much path visibility and forwarding diversity is desired
        in the network, for Unicast and Anycast endpoints.</t>
      </section>
    </section>

    <section anchor="IANA" title="IANA Considerations">
      <t>This document makes the following requests of IANA.</t>

      <section title="New BGP SAFI">
        <t>IANA is requested to assign a new BGP SAFI code for "Classful
        Transport". Value 76.</t>

        <figure>
          <artwork><![CDATA[
Registry Group: Subsequent Address Family Identifiers (SAFI) Parameters

Registry Name: SAFI Values

       Value              Description
      -------------+--------------------------
        76            Classful-Transport SAFI
]]></artwork>
        </figure>

        <t>This will be used to create new AFI,SAFI pairs for IPv4, IPv6
        Classful Transport families. viz:</t>

        <t><list style="symbols">
            <t>"Inet, Classful Transport". AFI/SAFI = "1/76" for carrying IPv4
            Classful Transport prefixes.</t>

            <t>"Inet6, Classful Transport". AFI/SAFI = "2/76" for carrying
            IPv6 Classful Transport prefixes.</t>
          </list></t>
      </section>

      <section title="New Format for BGP Extended Community">
        <t>IANA is requested to assign a new Format type (Type high = 0xa) of
        Extended Community <xref target="RFC4360">EXT-COMM</xref> called
        "Transport Class" from the following registries:<list>
            <t>the "BGP Transitive Extended Community Types" registry, and</t>

            <t>the "BGP Non-Transitive Extended Community Types" registry.</t>
          </list></t>

        <t>Please assign the same low-order six bits for both allocations.</t>

        <t>This document uses this new Format with subtype 0x2 (route target),
        as a transitive extended community.</t>

        <t>The Route Target thus formed is called "Transport Class" route
        target extended community.</t>

        <t>Taking reference of <xref target="RFC7153"></xref> , following
        requests are made:</t>

        <section title="Existing Registries to be Modified">
          <section title="Registries for the &quot;Type&quot; Field">
            <section title="Transitive Types">
              <t>This registry contains values of the high-order octet (the
              "Type" field) of a Transitive Extended Community.<figure>
                  <artwork><![CDATA[Registry Group: Border Gateway Protocol (BGP) Extended Communities

Registry Name: BGP Transitive Extended Community Types

       Type Value        Name
      --------------+---------------
         0x0a          Transport Class

  (Sub-Types are defined in the
  "Transitive Transport Class Extended Community Sub-Types"
   registry) ]]></artwork>
                </figure></t>
            </section>

            <section title="Non-Transitive Types">
              <t>This registry contains values of the high-order octet (the
              "Type" field) of a Non-transitive Extended Community.<figure>
                  <artwork><![CDATA[ Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: BGP Non-Transitive Extended Community Types

      Type Value         Name
     --------------+------------------
         0x4a         Transport Class

 (Sub-Types are defined in the
  "Non-Transitive Transport Class Extended Community Sub-Types"
   registry)
 ]]></artwork>
                </figure></t>
            </section>
          </section>
        </section>

        <section title="New Registries">
          <section title="Transitive Transport Class Extended Community Sub-Types Registry">
            <t>IANA is requested to add the following subregistry under the
            &ldquo;Border Gateway Protocol (BGP) Extended
            Communities&rdquo;:</t>

            <figure>
              <artwork><![CDATA[ Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: Transitive Transport Class Extended Community Sub-Types

 Note:
    This registry contains values of the second octet (the
    "Sub-Type" field) of an extended community when the value of the
     first octet (the "Type" field) is 0x0a.

 Range                 Registration Procedures
 -----------------+----------------------------
 0x00-0xBF           First Come First Served
 0xC0-0xFF           IETF Review

 Sub-Type Value         Name
 -----------------+--------------
   0x02              Route Target
              ]]></artwork>
            </figure>
          </section>

          <section title="Non-Transitive Transport Class Extended Community Sub-Types Registry">
            <t>IANA is requested to add the following subregistry under the
            &ldquo;Border Gateway Protocol (BGP) Extended
            Communities&rdquo;:</t>

            <figure>
              <artwork><![CDATA[ Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: Non-Transitive Transport Class Extended Community Sub-Types

 Note:
    This registry contains values of the second octet (the
    "Sub-Type" field) of an extended community when the value of the
     first octet (the "Type" field) is 0x4a.

 Range                 Registration Procedures
 -----------------+----------------------------
 0x00-0xBF           First Come First Served
 0xC0-0xFF           IETF Review

 Sub-Type Value         Name
 -----------------+--------------
   0x02              Route Target

              ]]></artwork>
            </figure>
          </section>
        </section>
      </section>

      <section title="MPLS OAM Code Points">
        <t>The following two code points are sought for Target FEC Stack
        sub-TLVs:</t>

        <t><list style="symbols">
            <t>IPv4 BGP Classful Transport</t>

            <t>IPv6 BGP Classful Transport</t>
          </list><figure>
            <artwork><![CDATA[ Registry Group: Multiprotocol Label Switching (MPLS)
                 Label Switched Paths (LSPs) Ping Parameters

 Registry Name: Sub-TLVs for TLV Types 1, 16, and 21

  Sub-Type                Name
 -----------------+------------------------------
   31744              IPv4 BGP Classful Transport
   31745              IPv6 BGP Classful Transport

              ]]></artwork>
          </figure></t>
      </section>

      <section title="Best Effort Transport Class ID">
        <t>This document reserves the Transport class ID value 0 to represent
        "Best Effort Transport Class ID". This is used in the 'Transport Class
        ID' field of Transport Route Target extended community that represents
        best effort transport class. Please create a new registry for
        this.</t>

        <t><figure>
            <artwork><![CDATA[ Registry Group: BGP CT Parameters

 Registry Name: Transport Class ID

  Value                 Name
 -----------------+--------------------------------
   0                Best Effort Transport Class ID

              ]]></artwork>
          </figure></t>
      </section>
    </section>

    <section anchor="Security" title="Security Considerations">
      <t>Mechanisms described in this document carry Transport routes in a new
      BGP address family. That minimizes the possibility of these routes
      leaking outside the expected domain or mixing with service routes.</t>

      <t>When redistributing between SAFI 4 and SAFI 76 Classful Transport
      routes, there is a possibility of SAFI 4 routes mixing with SAFI 1
      service routes. To avoid such scenarios, it is RECOMMENDED that
      implementations support keeping SAFI 4 routes in a separate transport
      RIB, distinct from service RIB that contain SAFI 1 service routes.</t>

      <t>In scenarios where MPLS is enabled on link to a device in an
      untrusted domain, e.g. a PE-CE link or ASBR-ASBR inter-AS link, security
      can be provided against MPLS label spoofing by using MPLS context tables
      as described in <xref target="MplsCE">MPLS enabled CE</xref>. Such that
      only MPLS traffic with labels advertised to the BGP speaker are allowed
      to forward. However, the PE may not be able to perform any checks based
      on inner payload in the MPLS packet since it performs label swap
      forwarding. Such 'inner payload' based checks may be offloaded to a
      downstream node that forwards and processes inner payload, e.g., an IP
      router having full FIB. These security aspects should be considered when
      using MPLS enabled CE devices</t>
    </section>
  </middle>

  <back>
    <references title="Normative References">
      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8277.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4271.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4364.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4360.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4684.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.4760.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7911.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8669.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.9012.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.9252.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7153.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8029.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8664.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8986.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8212.xml"?>

      <reference anchor="RFC4456"
                 target="https://datatracker.ietf.org/doc/html/rfc4456#section-9">
        <front>
          <title>BGP Route Reflection: An Alternative to Full Mesh Internal
          BGP (IBGP)</title>

          <author fullname="Tony" initials="J" role="editor" surname="Bates"></author>

          <author fullname="Enke" initials="" role="editor" surname="Chen"></author>

          <author fullname="Ravi" initials="" role="editor" surname="Chandra"></author>

          <date day="" month="04" year="2006" />
        </front>
      </reference>

      <reference anchor="SRTE"
                 target="https://tools.ietf.org/html/draft-ietf-idr-segment-routing-te-policy-20">
        <front>
          <title>Advertising Segment Routing Policies in BGP</title>

          <author fullname="Ketan" initials="" role="editor"
                  surname="Talaulikar"></author>

          <author fullname="Previdi" initials="S" surname="Previdi"></author>

          <date day="28" month="01" year="2023" />
        </front>
      </reference>
    </references>

    <references title="Informative References">
      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.9350.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2474.xml"?>

      <?rfc include="https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.9315.xml"?>

      <reference anchor="RTC-Ext"
                 target="https://tools.ietf.org/html/draft-zzhang-idr-bgp-rt-constrains-extension-03#section-2">
        <front>
          <title abbrev="RTC-Ext">Generic Route Constraint Distribution
          Mechanism for BGP</title>

          <author fullname="Zhaohui" initials="Z" role="editor"
                  surname="Zhang"></author>

          <author fullname="Jeffrey" initials="" role="editor" surname="Haas"></author>

          <date day="26" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="Intent-Routing-Color"
                 target="https://datatracker.ietf.org/doc/html/draft-hr-spring-intentaware-routing-using-color-01#section-6.3.2">
        <front>
          <title abbrev="Intent-Routing-Color">Intent-aware Routing using
          Color</title>

          <author fullname="Shraddha" initials="" role="editor"
                  surname="Hegde"></author>

          <date day="13" month="03" year="2022" />
        </front>
      </reference>

      <reference anchor="PCEP-RSVP-COLOR"
                 target="https://datatracker.ietf.org/doc/html/draft-ietf-pce-pcep-color-00">
        <front>
          <title abbrev="PCEP RSVP COLOR">Path Computation Element
          Protocol(PCEP) Extension for RSVP Color</title>

          <author fullname="Balaji" initials="" role="editor"
                  surname="Rajagopalan"></author>

          <author fullname="Vishnu" initials="Pavan" role="editor"
                  surname="Beeram"></author>

          <date day="03" month="01" year="2023" />
        </front>
      </reference>

      <reference anchor="BGP-CT-UPDATE-PACKING-TEST"
                 target="https://raw.githubusercontent.com/ietf-wg-idr/draft-ietf-idr-bgp-ct/1a75d4d10d4df0f1fd7dcc041c2c868704b092c7/update-packing-test-results.txt">
        <front>
          <title abbrev="BGP-CT-UPDATE-PACKING-TEST">BGP CT Update packing
          Test Results</title>

          <author fullname="Kaliraj" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="25" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="MPLS-NAMESPACES"
                 target="https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-05#section-6.1">
        <front>
          <title abbrev="MPLS namespaces">BGP signalled MPLS
          namespaces</title>

          <author fullname="Kaliraj" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="07" month="08" year="2023" />
        </front>
      </reference>

      <reference anchor="BGP-LU-EPE"
                 target="https://datatracker.ietf.org/doc/html/draft-gredler-idr-bgplu-epe-15">
        <front>
          <title abbrev="BGP LU EPE">Egress Peer Engineering using
          BGP-LU</title>

          <author fullname="Hannes" initials="" role="editor"
                  surname="Gredler"></author>

          <date day="16" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="SRV6-INTER-DOMAIN"
                 target="https://datatracker.ietf.org/doc/html/draft-salih-spring-srv6-inter-domain-sids-03">
        <front>
          <title abbrev="SRV6-INTER-DOMAIN">SRv6 inter-domain mapping
          SIDs</title>

          <author fullname="Salih" initials="" role="editor" surname="K A"></author>

          <date day="23" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="Colorful-Prefix-Routing-SRv6"
                 target="https://www.ietf.org/archive/id/draft-wang-idr-cpr-01.html">
        <front>
          <title abbrev="Colorful-Prefix-Routing-SRv6">BGP Colorful Prefix
          Routing for SRv6 based Services</title>

          <author fullname="Haibo" initials="" role="editor" surname="Wang"></author>

          <date day="26" month="03" year="2023" />
        </front>
      </reference>

      <reference anchor="FLOWSPEC-REDIR-IP"
                 target="https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip-02">
        <front>
          <title abbrev="FLOWSPEC-REDIR-IP">BGP Flow-Spec Redirect to IP
          Action</title>

          <author fullname="Adam Simpson" initials="" role="editor"
                  surname="Simpson"></author>

          <date day="02" month="02" year="2015" />
        </front>
      </reference>

      <reference anchor="MULTI-NH-ATTR"
                 target="https://datatracker.ietf.org/doc/html/draft-kaliraj-idr-multinexthop-attribute-06">
        <front>
          <title abbrev="MULTI-NH-ATTR">BGP MultiNexthop Attribute</title>

          <author fullname="Kaliraj Vairavakkalai" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="17" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="MNH-TC"
                 target="https://www.ietf.org/archive/id/draft-kaliraj-idr-multinexthop-attribute-06.html#section-5.4.2.2">
        <front>
          <title abbrev="MNH-TC">BGP MultiNexthop Attribute</title>

          <author fullname="Kaliraj Vairavakkalai" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="17" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="MNH-EP"
                 target="https://www.ietf.org/archive/id/draft-kaliraj-idr-multinexthop-attribute-06.html#section-5.4.1">
        <front>
          <title abbrev="MNH-EP">BGP MultiNexthop Attribute</title>

          <author fullname="Kaliraj Vairavakkalai" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="17" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="MNH-ENCAP-DSCP"
                 target="https://www.ietf.org/archive/id/draft-kaliraj-idr-multinexthop-attribute-06.html#section-5.4.3.4">
        <front>
          <title abbrev="MNH-ENCAP-DSCP">BGP MultiNexthop Attribute</title>

          <author fullname="Kaliraj Vairavakkalai" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="17" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="MNH-ENCAP-MPLS"
                 target="https://www.ietf.org/archive/id/draft-kaliraj-idr-multinexthop-attribute-06.html#section-5.4.3.1">
        <front>
          <title abbrev="MNH-ENCAP-MPLS">BGP MultiNexthop Attribute</title>

          <author fullname="Kaliraj Vairavakkalai" initials="" role="editor"
                  surname="Vairavakkalai"></author>

          <date day="17" month="06" year="2023" />
        </front>
      </reference>

      <reference anchor="TEAS-NS"
                 target="https://www.ietf.org/archive/id/draft-ietf-teas-ietf-network-slices-21.html#section-4">
        <front>
          <title abbrev="TEAS-NS">A Framework for IETF Network Slices</title>

          <author fullname="Adrian Farrel" initials="" role="editor"
                  surname="Farrel"></author>

          <author fullname="John Drake" initials="" role="editor"
                  surname="Drake"></author>

          <date day="15" month="06" year="2023" />
        </front>
      </reference>
    </references>

    <section anchor="Appendix A" numbered="true"
             title="Extensibility considerations.">
      <section title="Signaling Intent over PE-CE Attachment Circuit">
        <t>It may be desirable to allow a CE device to indicate in the data
        packet it sends what treatment it desires (the Intent) when the packet
        is forwarded within the provider network.</t>

        <t>This section describes the mechanisms that enable such signaling.
        These procedures use existing AFIs, and service families (SAFI 1) on
        the PE-CE attachment circuit, with a new BGP attribute. It does not
        require a forklift upgrade of the PE-CE session with a new set of
        address families.</t>

        <figure anchor="Intent_PE_CE" suppress-title="true"
                title="Example Topology with PE-CE Links">
          <artwork align="left" xml:space="preserve"><![CDATA[

                                    ---Gold----->
                      [CE1]-----[PE1]---[P]----[PE2]-----[CE2]
                                    ---Bronze--->
                      11.0.0.0                         22.0.0.0
                          ----  Traffic direction ---->

                     Fig 13: Example Topology with PE CE Links
            ]]></artwork>
        </figure>

        <section title="Using DSCP in MultiNexthop Attribute">
          <t>Such an indication can be in form of DSCP code point (<xref
          target="RFC2474" />) in the IP header.</t>

          <t>In RFC2474, a Forwarding Class Selector maps to a PHB (Per-hop
          Behavior). The Transport Class construct is a PHB at transport
          layer.</t>

          <t>Let PE1 be configured to map DSCP1 to Gold Transport class, and
          DSCP2 to Bronze Transport class. Based on the DSCP code point
          received on the IP traffic from CE1, PE1 forwards the IP packet over
          a Gold or Bronze tunnel. Thus, the forwarding is not based on just
          the destination IP address, but also the DSCP code point. This is
          known as Class Based Forwarding (CBF). Today CBF is configured at
          the PE1 device roles and CE1 doesn't receive any indication in BGP
          signaling regarding what DSCP code points are being offered by the
          provider network.</t>

          <t>With a <xref target="MULTI-NH-ATTR">BGP MultiNexthop
          Attribute</xref> attached to a SAFI 1 service route, it is possible
          to extend the PE-CE BGP signalling (if used) to communicate such
          information to the CE1. In the above example, the MNH contains two
          Nexthop Legs, described by two Forwarding Instruction TLVs. Each
          Nexthop Leg contains PE1's peering self address in <xref
          target="MNH-EP">Endpoint Identifier TLV</xref> , the color Gold or
          Bronze encoded in the <xref target="MNH-TC">Transport class ID
          TLV</xref> , and associated DSCP code point indicating Gold or
          Bronze transport class encoded in the <xref
          target="MNH-ENCAP-DSCP">Payload Encapsulation Info TLV</xref> . This
          allows the CE to discover what transport classes exist in the
          provider network, and which DSCP codepoint to encode so that traffic
          is forwarded using the desired transport class in the provided
          network.</t>
        </section>

        <section anchor="MplsCE" title="MPLS-enabled CE">
          <t>If the PE-CE link is MPLS enabled, a distinct MPLS label can also
          be used to express Intent in data packets from CE. Enabling MPLS
          forwarding on PE-CE links comes with some security implications.
          This section gives details on these aspects.</t>

          <t>Consider the ingress PE1 receiving a VPN prefix RD:Pfx1 received
          with VPN label VL1, nexthop as PE2 and a mapping community
          containing TC1 as 'Transport class ID'. PE1 can allocate a MPLS
          Label PVL1 for the tuple "VPN Label, PNH Address, Transport class
          ID" and advertise to CE1.</t>

          <t>Label PVL1 may identifies a service function at any node in the
          network, e.g. a Firewall device or egress node PE2. And, for the
          same service prefix, a distinct label may be advertised to different
          CEs, such that incoming traffic from different CEs to the same
          service prefix can be diverted to a distinct devices in the network
          for further processing. This provides Ingress Peer Engineering
          control to the network.</t>

          <t>PE1 installs a MPLS FIB route for PVL1 with nexthop as "Swap VL1,
          Push TL1 towards PE2". TL1 is the BGP CT label received for the
          tuple 'PE2, TC1'. In forwarding, when MPLS packet with label PVL1 is
          received from CE1, PVL1 Swaps to label VL1 and pushes the BGP CT
          label TL1. PE1 advertises the label "PVL1" in the MULTI_NH_ATTR to
          CE1. PE1 forwards based on MPLS label without performing any IP
          lookup. This allows for PE1 to be a low IP FIB device and still
          support CBF by using MPLS Label inferred PHB. The number of MPLS
          Labels consumed at PE1 for this approach will be proportional to the
          number of Service functions and Intents that are exposed to CE1.</t>

          <t>A <xref target="MULTI-NH-ATTR">BGP MultiNexthop Attribute</xref>
          is attached to a SAFI 1 service route to convey the MPLS Label
          information to CE1. In the above example, the MNH contains two
          Nexthop Legs, described by two Forwarding Instruction TLVs. Each
          Nexthop Leg contains PE1's peering self address in <xref
          target="MNH-EP">Endpoint Identifier TLV</xref> , the color Gold or
          Bronze encoded in the <xref target="MNH-TC">Transport class ID
          TLV</xref> , and associated MPLS Label "PVL1" or "PVL2" encoded in
          the <xref target="MNH-ENCAP-MPLS">Payload Encapsulation Info
          TLV</xref> . This allows the CE to discover what transport classes
          exist in the provider network, and which MPLS Label to encode so
          that traffic is forwarded using the desired transport class.</t>

          <section title="Secure MPLS Forwarding on Inter-AS Link">
            <t>The MPLS enabled PE-CE attachment circuit is considered
            connecting to an untrusted domain. Such interfaces can be secured
            against MPLS label spoofing by a walled garden approach using
            "MPLS context tables".</t>

            <t>The PE1-CE1 interface can be confined to a specific MPLS
            context table "A" corresponding to the BGP peer. Such that only
            the routes for labels advertised to CE1 are installed in MPLS
            context table "A".</t>

            <t>This ensures that if CE1 sends MPLS packet with a label that
            was not advertised to the CE1, the packet will be dropped.</t>

            <t>Further, the routes for labels PVL1, PVL2 installed in MPLS
            context table "A" can match on 'Bottom of stack' bit being 'one',
            ensuring a MPLS packet is accepted from CE1 only if it has no more
            than one label in the label stack.</t>

            <t>However, the PE itself may not be able to perform any checks
            based on inner payload in the MPLS packet since it performs label
            swap forwarding. Such inner payload based checks may be offloaded
            to a downstream node that forwards and processes inner payload,
            e.g. a IP FIB router. These security aspects should be considered
            when using MPLS enabled CE devices.</t>
          </section>
        </section>
      </section>

      <section title="BGP CT Egress TE">
        <t>Mechanisms described in <xref target="BGP-LU-EPE" /> also applies
        to BGP CT family.</t>

        <t>The Peer/32 or Peer/128 EPE route MAY be originated in BGP CT
        family with appropriate Mapping Community (e.g.
        transport-target:0:100), thus allowing an EPE path to the peer that
        satisfies the desired SLA.</t>
      </section>
    </section>

    <section anchor="Appendix B" numbered="true"
             title="Applicability to Intra AS and different Inter AS deployments.">
      <t>As described in <xref target="RFC4364">BGP VPN</xref> Section 10, in
      an option-C network, service routes (VPN-IPv4) are neither maintained
      nor distributed by the ASBRs. Transport routes are maintained in the
      ASBRs and propagated in BGP LU (SAFI 4) or BGP CT (SAFI 76).</t>

      <t><xref target="CTProc">Illustration of CT Procedures</xref>
      illustrates how constructs of BGP CT work in an Inter AS option-C
      deployment. The BGP CT constructs: SAFI 76, Transport Class and
      Resolution Scheme are used in an option-C deployment.</t>

      <t>In Intra AS and Inter AS option-A, option-B scenarios, SAFI 76 may
      not be used, but the Transport Class and Resolution Scheme mechanisms
      are used to provide service mapping.</t>

      <t>This section illustrates how BGP CT constructs work in Intra AS and
      Inter AS option-A, B deployment scenarios.</t>

      <section title="Intra AS usecase">
        <section title="Topology">
          <figure anchor="BGPCT_INTRA_AS" suppress-title="true"
                  title="BGP CT Intra-AS.">
            <artwork align="left" xml:space="preserve"><![CDATA[
                                    [RR11]
                                     |
                                     +
              [CE21]---[PE11]-------[P1]------[PE12]------[CE31]
                     |                             |
                     +                             +
                     |                             |
               AS2               ...AS1...               AS3

             10.21.21.21 ---- Traffic Direction ----> 10.31.31.31

                    Fig 14: Topology, BGP CT Intra-AS
            ]]></artwork>
          </figure>

          <t>This example shows a provider network Autonomous system AS1. It
          serves customers AS2, AS3. Traffic direction being described is CE21
          to CE31. CE31 may request a specific SLA (e.g. Gold for this
          traffic), when traversing this provider network.</t>
        </section>

        <section title="Transport Layer">
          <t>AS1 uses RSVP-TE intra-domain tunnels between PE11 and PE12. And
          LDP tunnels for best effort traffic.</t>

          <t>The network has two Transport classes: Gold with transport class
          id 100, Bronze with transport class id 200. These transport classes
          are provisioned at the PEs. This creates the Resolution Schemes for
          these transport classes at these PEs.</t>

          <t>Following tunnels exist for Gold transport class.<list>
              <t>PE11_to_PE12_gold - RSVP-TE tunnel</t>

              <t>PE12_to_PE11_gold - RSVP-TE tunnel</t>
            </list></t>

          <t>Following tunnels exist for Bronze transport class.<list>
              <t>PE11_to_PE12_bronze - RSVP-TE tunnel</t>

              <t>PE11_to_PE12_bronze - RSVP-TE tunnel</t>
            </list></t>

          <t>These tunnels are provisioned to belong to transport class 100 or
          200.</t>
        </section>

        <section title="Service Layer route exchange">
          <t>Service nodes PE11, PE12 negotiate service families (SAFI 128) on
          the BGP session with RR11. Service helper RR11 reflects service
          routes between the two PEs with nexthop unchanged. There are no
          tunnels for transport-class 100 or 200 from RR11 to the PEs.</t>

          <t>Forwarding happens using service routes at service nodes PE11,
          PE12. Routes received from CEs are not present in any other nodes'
          FIB in the provider network.</t>

          <t>CE31 advertises a route for example prefix 10.31.31.31 with
          nexthop self to PE12. CE31 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE11 can attach the same using locally configured policies.</t>

          <t>Consider, CE31 is getting VPN service from PE12. The
          RD:10.31.31.31 route is readvertised in SAFI 128 by PE12 with
          nexthop self (10.12.12.12) and label V-L1, to RR11 with the Mapping
          Community Color:0:100 attached. This SAFI 128 route reaches PE11 via
          RR11 with the nexthop unchanged as PE12 and label V-L1. Now PE11 can
          resolve the PNH 10.12.12.12 using PE11_to_PE12_gold RSVP TE LSP.</t>

          <t>The IP FIB at PE11 VRF will have a route for 10.31.31.31 with a
          nexthop when resolved using Resolution Scheme belonging to the
          mapping community Color:0:100, points to a PE11_to_PE12_gold
          tunnel.</t>

          <t>BGP CT SAFI 76 is not used in this Intra AS deployment. But the
          Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.</t>
        </section>
      </section>

      <section title="Inter AS option-A usecase">
        <section title="Topology">
          <figure anchor="BGPCT_INTERAS_A" suppress-title="true"
                  title="BGP CT Inter-AS option A.">
            <artwork align="left" xml:space="preserve"><![CDATA[
                  [RR11]                        [RR21]
                    |                             |
                    +                             +
[CE31]---[PE11]----[P1]----[ASBR11]---[ASBR21]---[P2]---[PE21]----[CE41]
        |                           |                           |
        +                           +                           +
        |                           |                           |
  AS3               ..AS1..               ..AS2..                  AS4

10.31.31.31          ---- Traffic Direction ---->           10.41.41.41

            Fig 15: Topology, BGP CT Inter-AS Option A
]]></artwork>
          </figure>

          <t>This example shows two provider network Autonomous systems AS1,
          AS2. They serve L3VPN customers AS3, AS4 respectively. The ASBRs
          ASBR11 and ASBR21 have IP VRFs connected directly. The inter AS link
          is IP enabled with no MPLS forwarding.</t>

          <t>Traffic direction being described is CE31 to CE41. CE41 may
          request a specific SLA (e.g. Gold for this traffic), when traversing
          these provider core networks.</t>
        </section>

        <section title="Transport Layer">
          <t>AS1 uses RSVP-TE intra-domain tunnels between PE11 and ASBR11.
          And LDP tunnels for best effort traffic. AS2 uses SRTE intra-domain
          tunnels between ASBR21 and PE21, and L-ISIS for best effort
          tunnels.</t>

          <t>The networks have two Transport classes: Gold with transport
          class id 100, Bronze with transport class id 200. These transport
          classes are provisioned at the PEs and ASBRs. This creates the
          Resolution Schemes for these transport classes at these PEs and
          ASBRs.</t>

          <t>Following tunnels exist for Gold transport class.<list>
              <t>PE11_to_ASBR11_gold - RSVP-TE tunnel</t>

              <t>ASBR11_to_PE11_gold - RSVP-TE tunnel</t>

              <t>PE21_to_ASBR21_gold - SRTE tunnel</t>

              <t>ASBR21_to_PE21_gold - SRTE tunnel</t>
            </list></t>

          <t>Following tunnels exist for Bronze transport class.<list>
              <t>PE11_to_ASBR11_bronze - RSVP-TE tunnel</t>

              <t>ASBR11_to_PE11_bronze - RSVP-TE tunnel</t>

              <t>PE21_to_ASBR21_bronze - SRTE tunnel</t>

              <t>ASBR21_to_PE21_bronze - SRTE tunnel</t>
            </list></t>

          <t>These tunnels are provisioned to belong to transport class 100 or
          200.</t>
        </section>

        <section title="Service Layer route exchange">
          <t>Service nodes PE11, ASBR11 negotiate service family (SAFI 128) on
          the BGP session with RR11. Service helper RR11 reflects service
          routes between the PE11 and ASBR11 with nexthop unchanged.</t>

          <t>Similarly, in AS2 PE21, ASBR21 negotiate service family (SAFI
          128) on the BGP session with RR21, which reflects service routes
          between the PE21 and ASBR21 with nexthop unchanged.</t>

          <t>CE41 advertises a route for example prefix 10.41.41.41 with
          nexthop self to PE21 VRF. CE41 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE21 can attach the same using locally configured policies.</t>

          <t>Consider, CE41 is getting VPN service from PE21. The
          RD:10.41.41.41 route is readvertised in SAFI 128 by PE21 with
          nexthop self (10.21.21.21) and label V-L1, to RR21 with the Mapping
          Community Color:0:100 attached. This SAFI 128 route reaches ASBR21
          via RR21 with the nexthop unchanged as PE21 and label V-L1. Now
          ASBR21 can resolve the PNH 10.21.21.21 using ASBR21_to_PE21_gold
          SRTE LSP.</t>

          <t>The IP FIB at ASBR21 VRF will have a route for 10.41.41.41 with a
          nexthop resolved using Resolution Scheme associated with mapping
          community Color:0:100, pointing to ASBR21_to_PE21_gold tunnel.</t>

          <t>This route is readvertised by ASBR21 on BGP session inside VRF
          with nexthop self. EBGP session peering on interface address. ASBR21
          acts like a CE to ASBR11, and the above mentioned process repeats in
          AS1, until the route reaches PE11 and resolves over
          PE11_to_ASBR11_gold RSVP TE tunnel.</t>

          <t>Traffic traverses as IP packet on the following legs: CE31-PE11,
          ASBR11-ASBR21, PE21-CE41. And uses MPLS forwarding inside AS1, AS2
          core.</t>

          <t>BGP CT SAFI 76 is not used in this Inter AS option-A deployment.
          But the Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.</t>
        </section>
      </section>

      <section title="Inter AS option-B usecase">
        <section title="Topology">
          <figure anchor="BGPCT_INTERAS_B" suppress-title="true"
                  title="BGP CT Inter-AS option B.">
            <artwork align="left" xml:space="preserve"><![CDATA[
                  [RR13]                        [RR23]
                    |                             |
                    +                             +
[CE31]---[PE11]----[P1]----[ASBR12]---[ASBR21]---[P2]---[PE22]----[CE41]
        |                           |                           |
        +                           +                           +
        |                           |                           |
  AS3               ..AS1..               ..AS2..                  AS4

10.31.31.31          ---- Traffic Direction ---->           10.41.41.41


                Fig 16: Topology, BGP CT Inter-AS Option B
]]></artwork>
          </figure>

          <t>This example shows two provider network Autonomous systems AS1,
          AS2. They serve L3VPN customers AS3, AS4 respectively. The ASBRs
          ASBR12 and ASBR21 don't have any IP VRFs. The inter AS link is MPLS
          forwarding enabled.</t>

          <t>Traffic direction being described is CE31 to CE41. CE41 may
          request a specific SLA (e.g. Gold for this traffic), when traversing
          these provider core networks.</t>
        </section>

        <section title="Transport Layer">
          <t>AS1 uses RSVP-TE intra-domain tunnels between PE11 and ASBR21.
          And LDP tunnels for best effort traffic. AS2 uses SRTE intra-domain
          tunnels between ASBR21 and PE22, and L-ISIS for best effort
          tunnels.</t>

          <t>The networks have two Transport classes: Gold with transport
          class id 100, Bronze with transport class id 200. These transport
          classes are provisioned at the PEs and ASBRs. This creates the
          Resolution Schemes for these transport classes at these PEs and
          ASBRs.</t>

          <t>Following tunnels exist for Gold transport class.<list>
              <t>PE11_to_ASBR12_gold - RSVP-TE tunnel</t>

              <t>ASBR12_to_PE11_gold - RSVP-TE tunnel</t>

              <t>PE22_to_ASBR21_gold - SRTE tunnel</t>

              <t>ASBR21_to_PE22_gold - SRTE tunnel</t>
            </list></t>

          <t>Following tunnels exist for Bronze transport class.<list>
              <t>PE11_to_ASBR12_bronze - RSVP-TE tunnel</t>

              <t>ASBR12_to_PE11_bronze - RSVP-TE tunnel</t>

              <t>PE22_to_ASBR21_bronze - SRTE tunnel</t>

              <t>ASBR21_to_PE22_bronze - SRTE tunnel</t>
            </list></t>

          <t>These tunnels are provisioned to belong to transport class 100 or
          200.</t>
        </section>

        <section title="Service Layer route exchange">
          <t>Service nodes PE11, ASBR12 negotiate service family (SAFI 128) on
          the BGP session with RR13. Service helper RR13 reflects service
          routes between the PE11 and ASBR12 with nexthop unchanged.</t>

          <t>Similarly, in AS2 PE22, ASBR21 negotiate service family (SAFI
          128) on the BGP session with RR23, which reflects service routes
          between the PE22 and ASBR21 with nexthop unchanged.</t>

          <t>ASBR21 and ASBR12 negotiate SAFI 128 between them, and
          readvertise L3VPN routes with nexthop self, allocating new labels.
          EBGP session peering on interface address.</t>

          <t>CE41 advertises a route for example prefix 10.41.41.41 with
          nexthop self to PE22 VRF. CE41 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE22 can attach the same using locally configured policies.</t>

          <t>Consider, CE41 is getting VPN service from PE22. The
          RD:10.41.41.41 route is readvertised in SAFI 128 by PE22 with
          nexthop self (10.22.22.22) and label V-L1, to RR23 with the Mapping
          Community Color:0:100 attached. This SAFI 128 route reaches ASBR21
          via RR23 with the nexthop unchanged as PE22 and label V-L1. Now
          ASBR21 can resolve the PNH 10.22.22.22 using ASBR21_to_PE22_gold
          SRTE LSP.</t>

          <t>Next, ASBR21 readvertises the RD:10.41.41.41 route with nexthop
          self to ASBR12, with a newly allocated MPLS label, V-L2. Forwarding
          for this label is installed to Swap V-L1, and Push labels for
          ASBR21_to_PE22_gold tunnel.</t>

          <t>ASBR12 further readvertises the RD:10.41.41.41 route via RR13 to
          PE11 with nexthop self 10.12.12.12. PE1 resolves the nexthop
          10.12.12.12 over PE11_to_ASBR11_gold RSVP TE tunnel.</t>

          <t>Traffic traverses as IP packet on the following legs: CE31-PE11,
          PE21-CE41. And uses MPLS forwarding on ASBR11-ASBR21 link, and
          inside AS1, AS2 core.</t>

          <t>BGP CT SAFI 76 is not used in this Inter AS option-B deployment.
          But the Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.</t>
        </section>
      </section>
    </section>

    <section anchor="Appendix C" numbered="true"
             title="Why reuse RFC 8277 and RFC 4364?">
      <t>RFC 4364 is one of the key design patterns produced by networking
      industry. It introduced virtualization and allowed sharing of resources
      in service provider space with multiple tenant networks, providing
      isolated and secure Layer3 VPN services. This design pattern has been
      reused since to provide other service layer virtualizations like Layer2
      virtualization (VPLS, L2VPN, EVPN), ISO virtualization, ATM
      virtualization, Flowspec VPN.</t>

      <t>It is to be noted that these services have different NLRI encoding.
      L3VPN Service family that binds MPLS label to an IP prefix use RFC 8277
      encoding, and others define different NLRI encodings.</t>

      <t>BGP CT reuses RFC 4364 procedures to slice a transport network into
      multiple transport planes that different service routes can bind to,
      using color.</t>

      <t>BGP CT reuses RFC 8277 because it precisely fits the purpose. viz. In
      a MPLS network, BGP CT needs to bind MPLS label for transport endpoints
      which are IPv4 or IPv6 endpoints, and disambiguate between multiple
      instances of those endpoints in multiple transport planes. Hence, use of
      RD:IP_Prefix and carrying a Label for it as specified in RFC 8277 works
      well for this purpose.</t>

      <t>Another advantage of using the precise encoding as defined in RFC
      4364 and RFC 8277 is that it allows to interoperate with BGP speakers
      that support SAFI 128. This can be useful during transition, until all
      BGP speakers in the network support BGP CT.</t>

      <t>In future, if RFC 8277 evolves into a typed NLRI, that does not carry
      Label in the NLRI, BGP CT will be compatible with that as-well. In
      essence, BGP CT encoding is compatible with existing deployed
      technologies (RFC 4364, RFC 8277) and will adapt to any changes RFC 8277
      mechanisms undergo in future.</t>

      <t>This is a more pragmatic approach which leverages the benefits of
      time tested design patterns proposed in RFC 4364 and RFC 8277. Moreover,
      this approach greatly reduces operational training costs and protocol
      compatibility considerations, as it complements and works well with
      existing protocol machineries. This problem does not need reinventing
      the wheel with brand new NLRI and procedures.</t>

      <t>This is a more pragmatic approach, rather than abandoning time tested
      design pattern like RFC 4364 and RFC 8277, just to invent something
      completely new that is not backward compatible with existing
      deployments. Overloading RFC 8277 NLRI MPLS Label field with information
      related to non MPLS data plane leads to backward compatibility
      issues.</t>

      <section numbered="true" title="Update packing considerations">
        <t>BGP CT carries transport class as an attribute. This means routes
        that don't share the same transport class cannot be packed into same
        Update message. Update packing in BGP CT will be similar to RFC 8277
        family routes carrying attributes like communities or extended
        communities. Service families like SAFI 128 have considerably more
        scale than transport families like SAFI 4 or SAFI 76, which carry only
        loopbacks. Update packing mechanisms that scale for SAFI 128 routes
        will scale similarly for SAFI 76 routes also.</t>

        <t>The document <xref target="Intent-Routing-Color">Intent-aware
        Routing using Color </xref> section 6.3.2.1 suggests scaling numbers
        for transport network where BGP CT can be deployed. Experiments were
        conducted with this scale to find the convergence time with BGP CT for
        those scaling numbers. Scenarios involving BGP CT carrying IPv4 and
        IPv6 endpoints with MPLS label, and IPv6 endpoints with SRv6 SID were
        tested.</t>

        <t>Tests were conducted with 1.9 million BGP CT route scale (387K
        endpoints in 5 transport classes). Initial convergence time for all
        cases was less than 2 minutes, This experiment proves that carrying
        transport class information as an attribute keeps BGP convergence
        within acceptable range. Details of the experiment and test results
        are available in <xref target="BGP-CT-UPDATE-PACKING-TEST">BGP CT
        Update packing Test Results </xref>.</t>

        <t>Further, even in today's BGP LU deployments each egress node
        originates BGP LU route for it's loopback, with some attributes like
        community identifying the originating node or region, and AIGP
        attribute. These attributes may be unique per egress node, thus do not
        help with update packing in transport layer family routes.</t>
      </section>
    </section>

    <section anchor="Appendix D" numbered="true"
             title="Scaling using BGP MPLS Namespaces">
      <t>This section describes how scaling is achieved in an Inter domain
      MPLS network, where a domain is an AS or IGP area. Domain boundary is
      demarcated by a BN performing BGP nexthop self action on the transport
      route.</t>

      <t>It considers the scenario suggested in the document <xref
      target="Intent-Routing-Color">Intent-aware Routing using Color </xref>
      section 6.3.2.1. where 300K nodes exist in the network with 5 transport
      classes.</t>

      <t>This may result in 1.5M transport layer routes and MPLS transit
      routes in all Border Nodes in the network, which may overwhelm the
      nodes' MPLS forwarding resources.</t>

      <t>This section explains how mechanism described in <xref
      target="MPLS-NAMESPACES" /> is used to scale such a network. This
      approach reduces the number of PNHs that are globally visible in the
      network, thus reducing forwarding resource usage network wide. Service
      route state is kept confined closer to network edge, and any churn is
      confined within the region containing the point of failure, which
      improves convergence.</t>

      <t>In order to achieve these scaling benefits, new functionality is
      required only at a Region's Border Nodes and the Regional RRs. All other
      nodes can remain legacy nodes, and still get the scaling and convergence
      benefits of this mechanism. This is mainly advantageous to ingress and
      egress PE devices which may be low end devices not capable of pushing
      deep label stacks or supporting large number of ECMP nexthops. They can
      enjoy the scaling benefits without needing software upgrades.</t>

      <section numbered="true" title="Illustration.">
        <t>Let us consider the decomposition of this example network with 300K
        nodes to be such that there are 300 domains containing 1000 nodes
        each. The mechanism described here will reduce the forwarding resource
        usage in all Border Nodes to become a function of number of domains
        (300) instead of number of nodes (300K). Thus, drastically reducing
        MPLS transit routes from 1.5M to 1500. The Border Nodes and Regional
        RRs in a Region do the job of abstracting the 1000 PE loopbacks from
        the rest of the network. The rest of the network sees this region as 1
        BGP nexthop, and not as 1000 BGP nexthops.</t>
      </section>

      <section title="Topology">
        <figure anchor="BGP_MPLS_NS" title="BGP MPLS Namespaces.">
          <artwork align="left" xml:space="preserve"><![CDATA[

               [RR11]                           [RR31]
                 |                                |
                 |                                |
        [PE11]\  |  /[BN11]--+       +--[BN31]\   |   /[PE31]
               \ | /          \     /          \  |  /
[CE41]--[PE12]--[P11]          [BN21]           [P31]--[PE32]--[CE31]
         ..    /   \          /     \          /     \    ..
         ..   /     \[BN12]--+       +--[BN32]/       \   ..
        [PE11000]                                      [PE31000]
      |                  |                |                   |
 AS4  |     ..Domain1..  |  ..Domain2..   |    ..Domain3..    | AS3
      |                  |   (backbone)   |                   |

                  <---- Traffic Direction ----

         Fig 17: Reference Topology, BGP MPLS Namespaces
          ]]></artwork>
        </figure>

        <t>This topology shows a cross section of the network with focus on
        two domains Domain1 and Domain3 connected via a backbone domain
        Domain2. Rest of the domains are not shown for brevity. The border
        nodes have forwarding state pertaining to all domains in the network.
        The control plane and forwarding plane state in node BN21 can be
        examined to determine the MPLS scaling characteristics of the
        network.</t>

        <t>L3VPN Service routes are present only at ingress and egress PEs.
        L3VPN family (SAFI 128) is negotiated between PE11..PE11000 and
        regional route reflector RR11. RR11 has multihop EBGP peering with
        RR31 and negotiates SAFI 128. RR31 further peers with all PEs
        PE31..PE31000 in Domain3.</t>

        <t>At the Transport layer - in Domain1, PE11..PE11000 negotiate BGP
        families (SAFI 4, SAFI 76) with BN11, BN12. In Domain2, BN11 and BN12
        similarly negotiate the transport families with BN21, which in turn
        peers with BN31 and BN32. In Domain3, BN31 and BN32 peer with PEs
        PE31..PE31000. Each of these BNs change BGP nexthop to self, when re
        advertising the SAFI 4, SAFI 76 transport routes.</t>

        <t>When all nodes loopback addresses are visible throughout the
        network, it will result in 1.5M transport layer routes and MPLS
        transit routes in BN21.</t>

        <t>Following sections describe the control plane and forwarding plane
        mechanics to reduce this to 1500 routes, when MPLS Namespaces is
        deployed in this network.</t>

        <t>Traffic direction being described is CE41 to CE31. Reverse
        direction would work in similar way.</t>

        <t>Traffic direction being described is CE41 to CE31. Reverse
        direction would work in similar way.</t>
      </section>

      <section anchor="CPNH" title="Context Protocol Nexthop Address (CPNH)">
        <t>A MPLS Namespace is identified by a Context PNH address. In MPLS
        forwarding, labels are locally significant to the node advertising it.
        E.g. labels in default/global MPLS Namespace are scoped by the node's
        loopback address. The labels belonging to a MPLS Namespace are locally
        significant in scope of the Context PNH address.</t>

        <t>A UHP label called as "Context Label" is advertised for the CPNH in
        a transport protocol, which points to the MPLS Namespace forwarding
        context. When Context label is received as outer label in a MPLS
        packet, it is Popped, and lookup is performed for the MPLS label that
        appears in the MPLS Namespace identified by the CPNH.</t>

        <t>In this example, CPNH is an anycast IP address that represents set
        of PEs in a domain. E.g. CPNH1 represent all PEs in Domain1. And CPNH3
        represents all PEs in Domain3.</t>
      </section>

      <section title="Service Forwarding Helper, and Changes to Transport Layer.">
        <t>The border nodes BN11, BN12 maintain the forwarding context for
        MPLS Namespace identified by CPNH1. They advertise CPNH1 in transport
        layer routes like SAFI 4 or SAFI 76 with a UHP Context Label CL1. Any
        transport layer protocol may be used to advertise the UHP Context
        Label for the CPNH.</t>

        <t>In this way, BN11 and BN12 serve as Service Forwarding Helpers for
        CPNH1 MPLS Namespace. They attract traffic that remote devices send
        towards the BGP nexthop CPNH1, and forward the MPLS packets received
        with the MPLS labels belonging to the MPLS Namespace identified by
        CPNH1.</t>

        <t>The individual loopback addresses of the PEs need not be advertised
        outside the local region. E.g. PE11..PE11000 are not advertised beyond
        BN11, BN12. Only CPNH1 and RR11 addresses are advertised out. RR1 is
        used for the control plane peering and CPNH1 is used as a forwarding
        anchor point.</t>

        <t>Similarly, Domain3 advertises only RR31 and CPNH3 to Domain2. This
        significantly reduces the transport route scale and MPLS forwarding
        resource usage at the border nodes throughout the network.</t>
      </section>

      <section title="BGP MPLS Namespace Address family (AFI:16399, SAFI:128)">
        <t>In Domain1, the regional route reflector RR11 negotiates MPLS
        Namespace Signaling address family with the border nodes BN11, BN12.
        RR11 is an external label allocator for the MPLS Namespace identified
        by CPNH1. RR1 advertises in the MPLS Namespace address family, the
        labels it allocated in scope of CPNH1. These routes are advertised
        with a route target that identifies CPNH1. BN11 and BN12 use this
        route target to import the label route into the forwarding context
        associated with CPNH1.</t>

        <t>Similarly, in Domain3, RR31 negotiates MPLS Namespace Signaling
        address family with the border nodes BN31, BN32.</t>
      </section>

      <section title="Changes to Service Layer Route Exchange">
        <t>When RR11 re-advertises to RR31 a VPN route RD:Pfx1 received with
        label VL1 from egress PE11 in Domain1, it sets BGP nexthop to CPNH1,
        and advertises a new label PL1. This label PL1 is allocated within the
        scope of CPNH1 namespace.</t>

        <t>The label PL1 is advertised to BN1, BN2 in MPLS Namespace address
        family with a route target identifying CPNH1, and BGP nexthop PE11 and
        label VL1 that were received from the egress PE. BN1 and BN2 resolve
        the path to that BGP nexthop PE11 and use as nexthop for the PL1 route
        installed in CPNH1 forwarding context.</t>

        <t>The remote PEs in Domain3 consume the BGP updates from Domain1
        following regular procedures for SAFI 128. When resolving the BGP
        nexthop CPNH1, they will push the context label that lands the traffic
        into the correct forwarding context in one of the border nodes.</t>
      </section>

      <section title="Analysis of Forwarding Behavior">
        <t>The forwarding behavior thus achieved is similar to Inter AS
        option-b, without carrying any service routes at the border nodes.
        Further, the MPLS namespace labels are installed in all the border
        nodes, which allows for quicker traffic convergence in case of border
        node failure. The number of border nodes can be increased in a scale
        out manner, which gives a cookie cutter template to scale a network
        region.</t>

        <t>In conclusion, this mechanism provides both scaling and convergence
        benefits for the MPLS network, and allows to support huge scale
        networks.</t>
      </section>
    </section>

    <section anchor="Appendix E" numbered="true"
             title="BGP CT deployment in SRv6 networks">
      <t>This section describes BGP CT deployment in SRv6 multi-domain network
      using Inter-AS Option C architecture.</t>

      <section anchor="SID-Stacking-Approach" title="SID stacking approach">
        <t>This approach uses stacking of service SRv6 SID over transport SRv6
        SID. Transport layer SIDs of types End, End.B6.Encaps defined in <xref
        target="RFC8986" />, and type END.REPLACE* defined in <xref
        target="SRV6-INTER-DOMAIN" /> are carried in SAFI 76. Service SID is
        carried in a service family like SAFI 1 or SAFI 128.</t>

        <t>In this approach, the number of Service SIDs required at the egress
        SN is equal to service functions (e.g. Prefix, VRF or Nexthop) and the
        number of Transport SIDs are equal to the number of transport
        classes.</t>

        <figure anchor="BGPCTSRv6" suppress-title="true"
                title="BGP CT in SRv6 Only Data plane">
          <artwork align="left" xml:space="preserve"><![CDATA[
                AS1                     AS2

              ---gold--->           ----gold-->
    CE1---[PE1---P---ASBR1]-----[ASBR2---P---PE2]---CE2
              --bronze-->           --bronze-->

           -------Forwarding Direction----->

  Fig 18: Reference Topology, BGP CT in SRv6 Only Data plane
       ]]></artwork>
        </figure>

        <t>In the above topology, there are two AS domains, AS1 and AS2. These
        are pure IPv6 domains, with no MPLS enabled. Inter-AS links between
        AS1 and AS2 are also enabled with IPv6 forwarding.</t>

        <t>Intra-AS nodes in AS1 and AS2 speak IBGP CT (AFI: 2, SAFI: 76) and
        ISIS-SRv6 between them. The Inter-AS nodes ASBR1, ASBR2 speak EBGP CT
        (AFI: 2, SAFI:76) between them. Transport Classes Gold (100) and
        Bronze (200) are provisioned in all PEs and ASBRs. All BGP CT
        advertisements in this example carry a MPLS label value of 3 (Implicit
        Null) in the NLRI encoding.</t>

        <t>Reachability between PE1 and PE2 is formed using BGP CT family.
        Service families like IPv4 unicast (AFI: 1, SAFI: 1) and L3VPN (AFI:
        2, SAFI: 128) is negotiated on multihop EBGP session between PE1 and
        PE2. These service routes carry service SID to identify service
        functions at the advertising PE, and mapping community to identify the
        desired Intent.</t>

        <t>The following SRv6 locators are provisioned:<list>
            <t>PE2-SRv6 : SRv6 Locator for PE2 best effort transport class</t>

            <t>PE2-SRv6-gold-loc : SRv6 Locator for PE2 gold transport
            class</t>

            <t>PE2-SRv6-bronze-loc : SRv6 Locator for PE2 bronze transport
            class</t>

            <t>ASBR1-SRv6-loc : SRv6 Locator for ASBR1 best effort transport
            class</t>

            <t>ASBR1-SRv6-gold-loc : SRv6 Locator for ASBR1 gold transport
            class</t>

            <t>ASBR1-SRv6-bronze-loc : SRv6 Locator for ASBR1 bronze transport
            class</t>

            <t>ASBR2-SRv6-loc : SRv6 Locator for ASBR2 best effort transport
            class</t>

            <t>ASBR2-SRv6-gold-loc : SRv6 Locator for ASBR2 gold transport
            class</t>

            <t>ASBR2-SRv6-bronze-loc : SRv6 Locator for ASBR2 bronze transport
            class</t>
          </list></t>

        <t>The following transport layer SRv6 End SIDs are provisioned or
        dynamically allocated on demand:<list>
            <t>PE2-SRv6-gold : PE2 End SID from PE2-SRv6-gold-loc, for gold
            transport class.</t>

            <t>PE2-SRv6-bronze : PE2 End SID from PE2-SRv6-bronze-loc, for
            bronze transport class.</t>

            <t>ASBR2-SRv6-PE2-gold-Replace : at ASBR2 End.B6.Encaps SID for
            PE2, gold transport class.</t>

            <t>ASBR2-SRv6-PE2-bronze-Replace : at ASBR2 End.B6.Encaps SID for
            PE2, bronze transport class.</t>

            <t>ASBR1-SRv6-gold : ASBR1 End SID from ASBR1-SRv6-gold-loc, for
            gold transport class.</t>

            <t>ASBR1-SRv6-PE2-gold-Replace : at ASBR1 End.REPLACE SID for PE2,
            gold transport class.</t>

            <t>ASBR1-SRv6-bronze : ASBR1 End SID from ASBR1-SRv6-bronze-loc,
            for bronze transport class.</t>

            <t>ASBR1-SRv6-PE2-bronze-Replace : at ASBR1 End.REPLACE SID for
            PE2, bronze transport class.</t>
          </list></t>

        <t>Architecturally, the forwarding semantic of End.REPLACE SID
        operation is similar to Label SWAP operation in MPLS data plane. When
        a route received with End SID (e.g. PE2-SRv6-gold or PE2-SRv6-bronze
        transport SIDs) is readvertised with nexthop self, a IPv6 forwarding
        entry is emitted with a forwarding semantic of End.B6.Encaps
        operation, which means: Update IPv6 DA with Next Segment in SRH, and
        Encapsulate SRv6 SID corresponding to the correct transport class.
        This can be seen in IPv6 FIB of ASBR2 during "BGP CT processing at
        ASBR2" in the following illustration:</t>

        <t>The following service layer SRv6 End.DT4 SIDs are provisioned:<list>
            <t>PE2-SRv6-S1-DT4 : PE2 End.DT4 SID for service S1</t>
          </list></t>

        <t>The locators for above provisioned SRv6 SIDs will be advertised via
        ISIS between Intra-AS nodes and the established SRv6 tunnel to the
        node's loopback will be installed into the corresponding TRDB based on
        color.</t>

        <t>The SRv6 tunnel ingress routes are published in the Gold and Bronze
        TRDBs at ASBR2 as shown below:</t>

        <figure suppress-title="true" title="TRDBs at ASBR2">
          <artwork align="left" xml:space="preserve"><![CDATA[  Gold TRDB routes at ASBR2

       [ISIS SRv6] PE2-LPBK
           NH:  Encap "Gold-SRv6-Tunnel-to-PE2" tunnel

       [ISIS SRv6] PE2-SRv6-gold
           NH:  Encap "Gold-SRv6-Tunnel-to-PE2" tunnel

  Bronze TRDB routes at ASBR2

       [ISIS SRv6] PE2-LPBK
           NH: Encap "Bronze-SRv6-Tunnel-to-PE2" tunnel

       [ISIS SRv6] PE2-SRv6-bronze:
           NH: Encap "Bronze-SRv6-Tunnel-to-PE2" tunnel


  ASBR2: IPv6 FIB for SRv6

      [ISIS SRv6] PE2-SRv6-gold,
        NH: Encap "Gold-SRv6-Tunnel-to-PE2"

      [ISIS SRv6] PE2-SRv6-bronze,
        NH: Encap "Bronze-SRv6-Tunnel-to-PE2"
]]></artwork>
        </figure>

        <t>The illustrations that follow, show how the BGP CT route for gold
        transport plane is originated, import processing done and propagated
        through this network. Similar processing is followed for the bronze
        transport plane route as well.</t>

        <t>Firstly, PE2 originates BGP CT route for its transport layer
        endpoints like Loopback address with SRv6 SID information to ASBR2 as
        shown below.</t>

        <figure suppress-title="true"
                title="BGP CT advertisements from PE2 to ASBR2">
          <artwork align="left" xml:space="preserve"><![CDATA[  IBGP CT routes from PE2 to ASBR2

      RD1:PE2-LPBK,
        transport-target:0:100,
        Prefix-SID: PE2-SRv6-gold
        NH: PE2-LPBK

      RD2:PE2-LPBK,
        transport-target:0:200,
        Prefix-SID: PE2-SRv6-bronze
        NH: PE2-LPBK

  PE2: IPv6 FIB for SRv6

      [BGP CT] PE2-SRv6-S1-DT4
        NH: Decap, Perform service S1
]]></artwork>
        </figure>

        <t>When ASBR2 receives the IBGP CT advertisement for gold route from
        PE2, it performs import processing and nexthop resolution for the
        endpoint PE2-LPBK in the gold TRDB based on its
        transport-target:0:100. This would resolve over the ISIS-SRv6 route in
        gold TRDB and pick "Gold-SRv6-Tunnel-to-PE2" tunnel.</t>

        <t>On successful resolution, a IPv6 transit route for
        ASBR2-SRv6-PE2-gold-replace/128 is installed in the global IPv6 FIB
        with "Gold-SRv6-Tunnel-to-PE2" tunnel as nexthop, enabling SRv6
        forwarding for gold SLA. The BGP CT routes for RD1:PE2-LPBK is further
        advertised towards ASBR1 via EBGP CT as shown below. During this
        readvertisement, the nexthop is set to self, and SID is rewritten to
        ASBR2-SRv6-gold-Replace.</t>

        <figure suppress-title="true" title="BGP CT processing at ASBR2">
          <artwork align="left" xml:space="preserve"><![CDATA[
  EBGP CT routes from ASBR2 to ASBR1

      RD1:PE2-LPBK,
        transport-target:0:100,
        Prefix-SID: ASBR2-SRv6-PE2-gold-Replace,
        NH: ASBR2_InterAS_Link

      RD2:PE2-LPBK,
        transport-target:0:200,
        Prefix-SID: ASBR2-SRv6-PE2-bronze-Replace,
        NH: ASBR2_InterAS_Link


  ASBR2: IPv6 FIB for SRv6

      [BGP CT] ASBR2-SRv6-PE2-gold-Replace
        NH: UpdateIPv6DA(SRH.NextSegment), Encap "Gold-SRv6-Tunnel-to-PE2"

      [BGP CT] ASBR2-SRv6-PE2-bronze-Replace
        NH: UpdateIPv6DA(SRH.NextSegment), Encap "Bronze-SRv6-Tunnel-to-PE2"

]]></artwork>
        </figure>

        <t>When ASBR1 receives this EBGP CT advertisement from ASBR2, an IPv6
        route for ASBR1-SRv6-gold-Replace/128 is installed with a nexthop of
        ASBR1_InterAS_Link in the global IPv6 FIB, enabling SRv6 forwarding
        for gold SLA. The BGP CT route for RD1:PE2-LPBK is further advertised
        to PE1 via IBGP CT, with nexthop set to self, and SID rewritten to
        ASBR1-SRv6-gold-Replace.</t>

        <figure suppress-title="true" title="BGP CT processing at ASBR1">
          <artwork align="left" xml:space="preserve"><![CDATA[
  IBGP CT routes from ASBR1 to PE1

      RD1:PE2-LPBK,
        transport-target:0:100,
        Prefix-SID: ASBR1-SRv6-PE2-gold-Replace,
        NH: ASBR1-LPBK

      RD2:PE2-LPBK,
        transport-target:0:200,
        Prefix-SID: ASBR1-SRv6-PE2-bronze-Replace,
        NH: ASBR1-LPBK

  ASBR1: IPv6 FIB for SRv6

      [BGP CT] ASBR1-SRv6-PE2-gold-Replace,
        NH: ASBR2_InterAS_Link
        SID op: ReplaceSID(ASBR2-SRv6-PE2-gold-Replace)

      [BGP CT] ASBR1-SRv6-PE2-bronze-Replace,
        NH: ASBR2_InterAS_Link
        SID op: ReplaceSID(ASBR2-SRv6-PE2-bronze-Replace)
]]></artwork>
        </figure>

        <t>When PE1 receives this IBGP CT advertisement from ASBR1, it
        resolves the nexthop ASBR1-LPBK in the gold TRDB based on its
        transport-target:0:100. This would resolve over the ISIS-SRv6 route in
        gold TRDB and pick "Gold-SRv6-Tunnel-to-ASBR1".</t>

        <t>This forms the end-to-end Gold SLA path from PE1 to PE2. The gold
        BGP CT route for PE2-LPBK is installed in gold TRDB, and can be used
        for resolving service route nexthops. The Transport layer SIDs are
        replaced at each border node, which reduces the number of SID decaps
        required at the egress PE.</t>

        <figure suppress-title="true" title="BGP CT processing at PE1">
          <artwork align="left" xml:space="preserve"><![CDATA[
  Gold TRDB routes at PE1

      [BGP CT] PE2-LPBK,
        NH: ASBR1-SRv6-gold
        SID op: EncapSID(ASBR1-SRv6-PE2-gold-Replace)

  Bronze TRDB routes at PE1

      [BGP CT] PE2-LPBK,
        NH: ASBR1-SRv6-bronze
        SID op: EncapSID(ASBR1-SRv6-PE2-bronze-Replace)

  PE1: IPv6 FIB for SRv6

      [BGP CT] PE2-LPBK,
        NH: ASBR1-SRv6-gold
        SID op: EncapSID(ASBR1-SRv6-PE2-gold-Replace)

      [BGP CT] PE2-LPBK,
        NH: ASBR1-SRv6-bronze
        SID op: EncapSID(ASBR1-SRv6-PE2-bronze-Replace)

      [ISIS SRv6] ASBR1-SRv6-gold,
        NH: Encap "Gold-SRv6-Tunnel-to-ASBR1"

      [ISIS SRv6] ASBR1-SRv6-bronze,
        NH: Encap "Bronze-SRv6-Tunnel-to-ASBR1"
]]></artwork>
        </figure>

        <t>Furthermore, any service routes received with nexthop as PE2-LPBK
        and Mapping Community as Color:0:100 indicating Gold SLA will use the
        Resolution Scheme associated with its Mapping Community to resolve
        over the PE2-LPBK CT route installed in the gold TRDB, and push the
        SRv6-gold SID stack to reach PE2.</t>

        <t>Similarly, any service routes received with nexthop as PE2-LPBK and
        Mapping Community as Color:0:200 indicating Bronze SLA will use the
        Resolution Scheme associated with its Mapping Community to resolve
        over the PE2-LPBK CT route installed in the bronze TRDB, and push the
        SRv6-bronze SID stack to reach PE2. This is shown below.</t>

        <figure suppress-title="true" title="Service layer processing">
          <artwork align="left" xml:space="preserve"><![CDATA[
 BGP Service routes advertisement from PE2 to PE1:

      SVC_PFX1,
        color:0:100,
        Prefix-SID: PE2-SRv6-S1-DT4,
        NH: PE2-LPBK

      SVC_PFX2,
        color:0:200,
        Prefix-SID: PE2-SRv6-S1-DT4,
        NH: PE2-LPBK

 PE1: Service routes FIB

      [BGP INET] SVC_PFX1, color:0:100
        NH: EncapSID "PE2-SRv6-S1-DT4, ASBR1-SRv6-gold-Repace, Gold-SRv6-Tunnel-to-ASBR1(outer)"

      [BGP INET] SVC_PFX2, color:0:200
        NH: EncapSID "PE2-SRv6-S1-DT4, ASBR1-SRv6-bronze-Replace, Bronze-SRv6-Tunnel-to-ASBR1(outer)"
]]></artwork>
        </figure>

        <t>The operational, scaling and convergence aspects of this approach
        are similar to the aspects of applying BGP CT procedures to the MPLS
        data plane.</t>
      </section>

      <section title="Color-encoded Service SID (CPR) Approach">
        <t>CPR is defined in the document: <xref
        target="Colorful-Prefix-Routing-SRv6">Colorful Prefix Routing for SRv6
        based services </xref>, and uses IPv6 Unicast (AFI/SAFI = 2/1) as a
        transport family. CPR mechanism does not use BGP CT (SAFI 76) address
        family.</t>

        <t>CPR uses color encoded SRv6 service SIDs to determine the
        intent-aware transport paths for the service, without a separate
        transport SRv6 SID. It routes using "Colorful Prefix" locators in the
        transport layer, which are carried in the IPv6 Unicast BGP family.</t>

        <t>A Nexthop Resolution Scheme similar to that of BGP CT <xref
        target="Nexthop_Resoln_Schm" /> is used on IPv6 Unicast family to
        resolve &ldquo;Colorful Prefix&rdquo; locator routes that carry a
        mapping community to intent-aware paths in each domain.</t>

        <t>By virtue of the CPR SID allocation scheme, the service SIDs
        inherit the Intent of the corresponding Colorful Prefix route just by
        performing longest prefix match in forwarding plane.</t>

        <section title="Analysis of CPR Approach">
          <t>The CPR approach can be used to support intent driven routing
          while minimizing SRv6 encapsulation overhead, at the cost of careful
          SID numbering and planning. The state in the transport network is a
          function of total number of Colorful Prefixes.</t>

          <t>In the CPR approach, typically one service SID is allocated for
          each service function (e.g. VRF) which is associated with a specific
          intent. In some special scenarios, for example, when different
          service routes in the same VRF are with different intents, a unique
          service SID would need to be allocated for each intent associated
          with the VRF.</t>

          <t>However, the CPR mechanism preserves BGP PIC (Prefix scale
          Independent Convergence) for the egress SN failure scenario where
          only Colorful Prefix routes need to be withdrawn.</t>

          <t>CPR achieves strict Intent based forwarding for the service
          routes. Fallback to best effort transport class is achieved by
          numbering all SRv6 Colorful Prefix locators at the egress SN to fall
          in the same subnet as the SRv6 locator that uses best effort
          transport class. Customized intent fallback between different color
          transport classes may be achieved by allocating a CPR prefix for
          each such intent fallback policy, and advertising that CPR prefix
          with an appropriate mapping community, that maps to a customized
          resolution scheme. Alternatively, the intent fallback policy may be
          provisioned on the ingress nodes directly.</t>

          <t>Further, IPv6 Unicast family is widely deployed to carry Internet
          Service routes. Repurposing IPv6 Unicast family to carry Transport
          routes also may impact the operational complexity and security
          aspects in the network.</t>
        </section>
      </section>
    </section>

    <section anchor="Contributors" numbered="false" title="Contributors">
      <section anchor="Co-Authors" numbered="false" title="Co-Authors">
        <author fullname="Reshma Das" initials="D." surname="Das">
          <organization>Juniper Networks, Inc.</organization>

          <address>
            <postal>
              <street>1133 Innovation Way,</street>

              <city>Sunnyvale</city>

              <region>CA</region>

              <code>94089</code>

              <country>US</country>
            </postal>

            <email>dreshma@juniper.net</email>
          </address>
        </author>

        <author fullname="Israel Means" initials="I" surname="Means">
          <organization abbrev="">AT&amp;T</organization>

          <address>
            <postal>
              <street>2212 Avenida Mara,</street>

              <city>Chula Vista</city>

              <region>California</region>

              <code>91914</code>

              <country>USA</country>
            </postal>

            <email>israel.means@att.com</email>
          </address>
        </author>

        <author fullname="Csaba Mate" initials="CS" surname="Mate">
          <organization abbrev="">KIFU, Hungarian NREN</organization>

          <address>
            <postal>
              <street>35 Vaci street,</street>

              <city>Budapest</city>

              <region />

              <code>1134</code>

              <country>Hungary</country>
            </postal>

            <email>ietf@nop.hu</email>
          </address>
        </author>

        <author fullname="Deepak J Gowda" initials="J" surname="Gowda">
          <organization abbrev="">Extreme Networks</organization>

          <address>
            <postal>
              <street>55 Commerce Valley Drive West, Suite 300,</street>

              <city>Thornhill, Toronto,</city>

              <region>Ontario</region>

              <code>L3T 7V9</code>

              <country>Canada</country>
            </postal>

            <email>dgowda@extremenetworks.com</email>
          </address>
        </author>
      </section>

      <section anchor="Other Contributors" numbered="false"
               title="Other Contributors">
        <author fullname="Balaji Rajagopalan" initials="B."
                surname="Rajagopalan">
          <organization>Juniper Networks, Inc.</organization>

          <address>
            <postal>
              <street>Electra, Exora Business Park~Marathahalli - Sarjapur
              Outer Ring Road,</street>

              <city>Bangalore</city>

              <region>KA</region>

              <code>560103</code>

              <country>India</country>
            </postal>

            <email>balajir@juniper.net</email>
          </address>
        </author>

        <author fullname="Rajesh M" initials="M">
          <organization>Juniper Networks, Inc.</organization>

          <address>
            <postal>
              <street>Electra, Exora Business Park~Marathahalli - Sarjapur
              Outer Ring Road,</street>

              <city>Bangalore</city>

              <region>KA</region>

              <code>560103</code>

              <country>India</country>
            </postal>

            <email>mrajesh@juniper.net</email>
          </address>
        </author>

        <author fullname="Chaitanya Yadlapalli" initials="C"
                surname="Yadlapalli">
          <organization abbrev="">AT&amp;T</organization>

          <address>
            <postal>
              <street>200 S Laurel Ave,</street>

              <city>Middletown,</city>

              <region>NJ</region>

              <code>07748</code>

              <country>USA</country>
            </postal>

            <email>cy098d@att.com</email>
          </address>
        </author>

        <author fullname="Gyan Mishra" initials="G." surname="Mishra">
          <organization>Verizon Inc.</organization>

          <address>
            <postal>
              <street>13101 Columbia Pike</street>

              <city>Silver Spring</city>

              <region>MD</region>

              <code>20904</code>

              <country>USA</country>
            </postal>

            <email>gyan.s.mishra@verizon.com</email>
          </address>
        </author>

        <author fullname="Mazen Khaddam" initials="M" surname="Khaddam">
          <organization abbrev="">Cox Communications Inc.</organization>

          <address>
            <postal>
              <street />

              <city>Atlanta</city>

              <region>GA</region>

              <code />

              <country>USA</country>
            </postal>

            <email>mazen.khaddam@cox.com</email>
          </address>
        </author>

        <author fullname="Rafal Jan Szarecki" initials="R" surname="Szarecki">
          <organization abbrev="">Google.</organization>

          <address>
            <postal>
              <street>1160 N Mathilda Ave, Bldg 5,</street>

              <city>Sunnyvale,</city>

              <region>CA</region>

              <code>94089</code>

              <country>USA</country>
            </postal>

            <email>szarecki@google.com</email>
          </address>
        </author>

        <author fullname="Xiaohu Xu" initials="X" surname="Xu">
          <organization abbrev="">China Mobile</organization>

          <address>
            <postal>
              <street />

              <city>Beijing</city>

              <region />

              <code />

              <country>China</country>
            </postal>

            <email>xuxiaohu@cmss.chinamobile.com</email>
          </address>
        </author>
      </section>
    </section>

    <section anchor="Acknowledgements" numbered="false"
             title="Acknowledgements">
      <t>The authors thank Jeff Haas, John Scudder, Susan Hares, Dongjie
      (Jimmy), Moses Nagarajah, Jeffrey (Zhaohui) Zhang, Joel Harpern,
      Jingrong Xie, Mohamed Boucadair, Simon Leinen, Navaneetha Krishnan, Ravi
      M R, Chandrasekar Ramachandran, Shradha Hegde, Colby Barth, Vishnu Pavan
      Beeram, Sunil Malali, William J Britto, R Shilpa, Ashish Kumar (FE),
      Sunil Kumar Rawat, Abhishek Chakraborty, Richard Roberts, Krzysztof
      Szarkowicz, John E Drake, Srihari Sangli, Jim Uttaro, Luay Jalil, Keyur
      Patel, Ketan Talaulikar, Dhananjaya Rao, Swadesh Agarwal, Robert Raszuk,
      Ahmed Darwish, Aravind Srinivas Srinivasa Prabhakar, Moshiko Nayman,
      Chris Trip, Vijay Kestur, Santosh Kolenchery for all the valuable
      discussions, constructive criticisms, and review comments.</t>

      <t>The decision to not reuse SAFI 128 and create a new address-family to
      carry these transport-routes was based on suggestion made by Richard
      Roberts and Krzysztof Szarkowicz.</t>
    </section>
  </back>
</rfc>
